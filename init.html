<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Unified Emacs OS - An Statistician's Implementation</title>
<!-- 2015-05-20 Wed 14:48 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Yi Tang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css"
href="http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/foundation.min.css"></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/org-export.css"></link>
<link rel="stylesheet" type="text/css" href="http://sachachua.com/blog/wp-content/themes/sacha-v3/style.css"></link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<a name="top" id="top"></a>
</div>
<div id="content">
<h1 class="title">Unified Emacs OS - An Statistician's Implementation</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">About This Document</a></li>
<li><a href="#sec-2">Licence</a></li>
<li><a href="#sec-3">Getting Started</a>
<ul>
<li><a href="#sec-3-1">load all the packages</a></li>
</ul>
</li>
<li><a href="#sec-4">Emacs Configuration</a>
<ul>
<li><a href="#sec-4-1">install packages</a></li>
<li><a href="#sec-4-2">General</a>
<ul>
<li><a href="#sec-4-2-1">remove keybind</a></li>
<li><a href="#sec-4-2-2">Assorted Pieces</a></li>
<li><a href="#sec-4-2-3">Window Layout/Navigation</a></li>
<li><a href="#sec-4-2-4">Utilities</a></li>
<li><a href="#sec-4-2-5">System Path</a></li>
<li><a href="#sec-4-2-6">general editing</a></li>
<li><a href="#sec-4-2-7">Minibuffer history</a></li>
</ul>
</li>
<li><a href="#sec-4-3">UI - Emacs Looks Cool</a></li>
<li><a href="#sec-4-4">Completion and Selection</a>
<ul>
<li><a href="#sec-4-4-1">Helm - Fuzzy Match</a></li>
<li><a href="#sec-4-4-2">Multi-Cursor &amp; Helm-swoop  - Multiple Selection</a></li>
<li><a href="#sec-4-4-3">ace-jump</a></li>
<li><a href="#sec-4-4-4">Expand-Region - Incremental Selection</a></li>
</ul>
</li>
<li><a href="#sec-4-5">ESS - Emacs Speaks Statistics</a>
<ul>
<li><a href="#sec-4-5-1">Start-up</a></li>
<li><a href="#sec-4-5-2">Syntax highlight</a></li>
<li><a href="#sec-4-5-3">Programming Mode</a></li>
<li><a href="#sec-4-5-4">Documentation</a></li>
<li><a href="#sec-4-5-5">R Style Check - Flycheck</a></li>
</ul>
</li>
<li><a href="#sec-4-6">File Manager</a>
<ul>
<li><a href="#sec-4-6-1">Alternative to shell</a></li>
<li><a href="#sec-4-6-2">Projectile - Directory Access</a></li>
<li><a href="#sec-4-6-3">Remote (SSH)</a></li>
<li><a href="#sec-4-6-4">Git Sync</a></li>
</ul>
</li>
<li><a href="#sec-4-7">Writing in Emacs</a>
<ul>
<li><a href="#sec-4-7-1">English Language</a></li>
<li><a href="#sec-4-7-2">Random Quotes</a></li>
<li><a href="#sec-4-7-3">Abbreviation</a></li>
</ul>
</li>
<li><a href="#sec-4-8">eww</a></li>
<li><a href="#sec-4-9">Org mode</a>
<ul>
<li><a href="#sec-4-9-1">customised</a></li>
<li><a href="#sec-4-9-2">contribute libraries</a></li>
<li><a href="#sec-4-9-3">Calendar</a></li>
<li><a href="#sec-4-9-4">Babel</a></li>
<li><a href="#sec-4-9-5">Export</a></li>
<li><a href="#sec-4-9-6">PDF Export</a></li>
<li><a href="#sec-4-9-7">HTML Export</a></li>
<li><a href="#sec-4-9-8">Blogging with Jekyll</a>
<ul>
<li><a href="#sec-4-9-8-1">code highlight</a></li>
<li><a href="#sec-4-9-8-2">Path Issues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-4-10">mu4e - Email Client</a>
<ul>
<li><a href="#sec-4-10-1">Account</a></li>
<li><a href="#sec-4-10-2">Contacts</a></li>
<li><a href="#sec-4-10-3">Workflow</a></li>
<li><a href="#sec-4-10-4"><span class="todo TODO">TODO</span> Comprehensive Email</a></li>
</ul>
</li>
<li><a href="#sec-4-11">Refile</a>
<ul>
<li><a href="#sec-4-11-1">open stree map</a></li>
</ul>
</li>
<li><a href="#sec-4-12">Git-Report</a></li>
<li><a href="#sec-4-13">Office Setting</a></li>
</ul>
</li>
<li><a href="#sec-5">Babel Library</a>
<ul>
<li><a href="#sec-5-1">Update Emacs library</a></li>
<li><a href="#sec-5-2">Ledger</a></li>
<li><a href="#sec-5-3">image process</a></li>
<li><a href="#sec-5-4">org contact</a></li>
<li><a href="#sec-5-5">Blog</a></li>
</ul>
</li>
<li><a href="#sec-6">End</a></li>
<li><a href="#sec-7">Archive</a>
<ul>
<li><a href="#sec-7-1">C++</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">About This Document</h2>
<div class="outline-text-2" id="text-1">
<p>

</p>

<p>
The road to Emacs is not easy: I have tried to use Emacs for many years, and started using on daily basis from Jun 2014. The transition is difficulty, and full of tears and bloody, and every day I feel like being doomed in the dark. About Jan 2015, I start to the light.  and conquered Emacs, and it now becomes a symbol of me, and I use it do most of productive work. 
</p>

<p>
As the configuration grows bigger and bigger, a single <i>init.el</i> is not suitable for organising, testing, and expanding anymore. Previously, I have about 7 <code>.el</code> files, for example, <code>setup-org.el</code>, <code>setup-email.el</code>, and I document on each file. Inpisraed by Sachua's new posts, I think it would be an brilliant idea to org Emacs configuration code into one single org file, letting along the conviencen of orgnising and share my seetting, the precious thing I would appreciate is it provide an way I could start with a long comments, thoughts or workflow.  in this way, the code becomes less important as it should be.  
</p>

<p>
my configration file is initally seaprated by differnt purpose or mode, but as it gorwths, it bcaem inconicient in tracking, and, As for other Emacs user, my configration is keep growthing, and This documents is first combined by 5 configration files, and it keep expanding, I use liteature programming to includes all the notes, and keep a log of how I use themn
</p>

<p>
This Emacs configuration is free of bug and fully tested on Ubuntu and OS X. 
</p>



<p>
Normally you could tangle a org file to extract all the source code into one file, that you could use.  But I would like to push liteartpr programming furture in two aspects:  1) the source code takes input from this org file, I.e. table.  2) it facility Babel Library to integrate not only Emacs Lisp, but also sh and R functions that could be run in Emacs, and I found it particullary useful. 
</p>
</div>
</div>





<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Licence</h2>
<div class="outline-text-2" id="text-2">
<p>

</p>

<pre class="example">
Copyright (C)  2013  Yi Tang
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.

Code in this document is free software: you can redistribute it
and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation, either
version 3 of the License, or (at your option) any later version.

This code is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
</pre>

<p>
This document <a href="http://yitang.github.io/emacs.d/init.html">http://yitang.github.io/emacs.d/init.html</a> (either in its HTML format or in its Org format) is licensed under the GNU Free Documentation License version 1.3 or later (<a href="http://www.gnu.org/copyleft/fdl.html">http://www.gnu.org/copyleft/fdl.html</a>).
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Getting Started</h2>
<div class="outline-text-2" id="text-3">
<p>

</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">load all the packages</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-03-18 Wed 15:33]</span></span>
  question I want to answer 
</p>

<ol class="org-ol">
<li>why I need this/that package, what functionality they provide.
</li>
<li>how to improve the current work flow,
</li>
<li></li>
</ol>

<p>
About this file: 
Use this 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">org</span>)
(setq org-confirm-babel-evaluate nil)  <span class="org-comment-delimiter">;; </span><span class="org-comment">evaluate src block without confirmatio</span><span class="org-comment"><span class="org-whitespace-line">n </span></span>

<span class="org-comment-delimiter">;;;;;;; </span><span class="org-comment">[2015-01-22 Thu 21:27]</span>
(<span class="org-keyword">defvar</span> <span class="org-variable-name">endless/init.org-message-depth</span> 5
  <span class="org-doc">"What depth of init.org headers to message at startup."</span>)

(<span class="org-keyword">with-temp-buffer</span>
  (insert-file <span class="org-string">"~/git/.emacs.d/yt/init.org"</span>)
  (goto-char (point-min))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">org babels </span>
  (search-forward <span class="org-string">"\n* Babel Library"</span>)
  (org-copy-subtree)
  (<span class="org-keyword">let</span> ((tmp-file (make-temp-file <span class="org-string">"tmp"</span>)))
    (<span class="org-keyword">with-temp-file</span> tmp-file (yank))
    (org-babel-lob-ingest tmp-file))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">emacs lisp functions </span>
  (goto-char (point-min))
  (search-forward <span class="org-string">"\n* Emacs Configuration"</span>)
  (<span class="org-keyword">while</span> (not (eobp))
    (forward-line 1)
    (<span class="org-keyword">cond</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Report Headers</span>
     ((looking-at
       (format <span class="org-string">"\\*\\{2,%s\\} +.*$"</span> 
               endless/init.org-message-depth))
      (message <span class="org-string">"%s"</span> (match-string 0)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(message (format (current-time-string))))</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Evaluate Code Blocks</span>
     ((looking-at <span class="org-string">"[\s]*\\#\\+begin_src\semacs-lisp"</span>)
      <span class="org-comment-delimiter">;; </span><span class="org-comment">((looking-at "#\\+BEGIN_SRC +emacs-lisp.*$")</span>
      <span class="org-comment-delimiter">;; </span><span class="org-comment">((looking-at "^#\\+BEGIN_SRC +.*$")</span>
      (org-babel-execute-src-block))
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Finish on the next level-1 header</span>
     ((looking-at <span class="org-string">"^\\* End"</span>)
      (goto-char (point-max))))))
</pre>
</div>

<p>
or this 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq user-emacs-directory <span class="org-string">"~/git/.emacs.d/"</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">org</span>)
(org-babel-load-file 
 (expand-file-name <span class="org-string">"init.org"</span>
                   user-emacs-directory))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Emacs Configuration</h2>
<div class="outline-text-2" id="text-4">
<p>

</p>
</div>
<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">install packages</h3>
<div class="outline-text-3" id="text-4-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq my-package-list '(ess
                        ssh
                        auto-complete
                        nyan-mode
                        yasnippet
                        projectile
                        magit
                        helm-swoop
                        nyan-mode
                        org-jekyll
                        org-plus-contrib
                        helm-projectile
                        rainbow-delimiters
                        zenburn-theme
                        htmlize
                        nanowrimo
                        golden-ratio
                        artbollocks-mode
                        langtool
                        flycheck
                        expand-region
                        guide-key
                        exec-path-from-shell
                        smart-mode-line
                        smart-mode-line-powerline-theme
                        powerline
                        synosaurus
                        hydra
                        w3m
                        ace-window
                        calfw
                        multiple-cursors
                        org-download
                        paradox
                        smartparens
                        ace-jump-mode
                        voca-builder
                        org-download
                        gist
                        sunshine
                        keyfreq
                        pretty-mode
                        f
                        olivetti
                        ))

(<span class="org-keyword">require</span> '<span class="org-constant">package</span>)
(setq package-archives '((<span class="org-string">"melpa"</span> . <span class="org-string">"http://melpa.milkbox.net/packages/"</span>)
                         (<span class="org-string">"org"</span> . <span class="org-string">"http://orgmode.org/elpa/"</span>)
                         (<span class="org-string">"gnu"</span> . <span class="org-string">"http://elpa.gnu.org/packages/"</span>)
                         (<span class="org-string">"marmalade"</span> . <span class="org-string">"http://marmalade-repo.org/packages/"</span>)))
(package-initialize)

<span class="org-comment-delimiter">;; </span><span class="org-comment">fetch the list of packages available </span>
(<span class="org-keyword">unless</span> package-archive-contents
  (package-refresh-contents))
<span class="org-comment-delimiter">;; </span><span class="org-comment">install </span>
(<span class="org-keyword">dolist</span> (i-package my-package-list)
  (<span class="org-keyword">unless</span> (package-installed-p i-package)
    (package-install i-package)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">General</h3>
<div class="outline-text-3" id="text-4-2">
</div><div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1">remove keybind</h4>
<div class="outline-text-4" id="text-4-2-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(global-unset-key (kbd <span class="org-string">"C-x b"</span>))
(global-unset-key (kbd <span class="org-string">"C-x C-b"</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2">Assorted Pieces</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>

</p>

<p>
automatically backup the buffers to local. sometimes can save my ass. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">ref: http://stackoverflow.com/questions/151945/how-do-i-control-how-emacs-mak</span><span class="org-comment"><span class="org-whitespace-line">es-backup-files</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">save all backup files (foo~) to this directory.</span>
(setq backup-directory-alist '((<span class="org-string">"."</span> . <span class="org-string">"~/.emacs.d/backup"</span>))
      backup-by-copying t    <span class="org-comment-delimiter">; </span><span class="org-comment">Don't delink hardlinks</span>
      version-control t      <span class="org-comment-delimiter">; </span><span class="org-comment">Use version numbers on backups</span>
      delete-old-versions t  <span class="org-comment-delimiter">; </span><span class="org-comment">Automatically delete excess backups</span>
      kept-new-versions 20   <span class="org-comment-delimiter">; </span><span class="org-comment">how many of the newest versions to keep</span>
      kept-old-versions 5    <span class="org-comment-delimiter">; </span><span class="org-comment">and how many of the old</span>
      auto-save-timeout 20   <span class="org-comment-delimiter">; </span><span class="org-comment">number of seconds idle time before auto-save (def</span><span class="org-comment"><span class="org-whitespace-line">ault: 30)</span></span>
      auto-save-interval 200 <span class="org-comment-delimiter">; </span><span class="org-comment">number of keystrokes between auto-saves (default:</span><span class="org-comment"><span class="org-whitespace-line"> 300)</span></span>
      )

<span class="org-comment-delimiter">;; </span><span class="org-comment">guide-key package </span>
(<span class="org-keyword">require</span> '<span class="org-constant">guide-key</span>)
(setq guide-key/guide-key-sequence t) <span class="org-comment-delimiter">;; </span><span class="org-comment">on for all key-bindings </span>
(guide-key-mode 1) 

<span class="org-comment-delimiter">;; </span><span class="org-comment">start auto-complete with emacs</span>
(<span class="org-keyword">require</span> '<span class="org-constant">auto-complete</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">do default config for auto-complete</span>
(<span class="org-keyword">require</span> '<span class="org-constant">auto-complete-config</span>)
(ac-config-default)
</pre>
</div>

<p>
save a list of recent files, and I use it most of the time. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(recentf-mode 1)
(setq recentf-max-saved-items 200
      recentf-max-menu-items 15)
(setq inhibit-startup-message t)        <span class="org-comment-delimiter">; </span><span class="org-comment">Disable startup message</span>
</pre>
</div>

<p>
yasnippet is a powerful package that I need to discovery in the future, and this stage, I turned if off because I will slow down the start-up.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'yasnippet)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(yas-global-mode 1)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq yas-snippet-dirs '("~/git/.emacs.d/my-snippets"</span>
    <span class="org-comment-delimiter">;;                          </span><span class="org-comment">"~/git/.emacs.d/.cask/24.4.2/elpa/yasnippet-2014</span><span class="org-comment"><span class="org-whitespace-line">1102.1554/snippets"</span></span>
    <span class="org-comment-delimiter">;;                          </span><span class="org-comment">"~/git/.emacs.d/.cask/25.0.50.1/elpa/yasnippet-2</span><span class="org-comment"><span class="org-whitespace-line">0141102.1554/snippets"))</span></span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3">Window Layout/Navigation</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>

</p>

<p>
<code>C-c &lt;left&gt;</code> to undo window layout changes, and <code>C-c &lt;right&gt;</code> to redo. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">;;; winner-mode, undo window configration</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'winner-mode) ;; default package</span>
(winner-mode 1)
<span class="org-comment-delimiter">;; </span><span class="org-comment">winner-undo -&gt; C-c &lt;left&gt;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">winner-redo -&gt; C-c &lt;right&gt;</span>
</pre>
</div>

<p>
shows an notication for invalid operations. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq visible-bell t)
</pre>
</div>

<p>
quickly switch between windows by choosing the window number. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">move between windows, alternatives: window_number.el</span>
(<span class="org-keyword">require</span> '<span class="org-constant">ace-window</span>)
(global-set-key (kbd <span class="org-string">"&lt;f1&gt;"</span>) 'ace-window)
(setq aw-scope 'frame)


<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x &lt;up&gt;") 'windmove-up)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x &lt;down&gt;") 'windmove-down)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x &lt;right&gt;") 'windmove-right)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x &lt;left&gt;") 'windmove-left)</span>
</pre>
</div>


<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">golden-ratio</span>)
(golden-ratio-mode 1)
(add-to-list 'golden-ratio-extra-commands 'ace-window) <span class="org-comment-delimiter">;; </span><span class="org-comment">active golden ratio wh</span><span class="org-comment"><span class="org-whitespace-line">en using ace-window</span></span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">prefer horizentally split window</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq split-height-threshold nil)</span>
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(setq split-width-threshold 0)</span>
</pre>
</div>
</div>
</div>



<div id="outline-container-sec-4-2-4" class="outline-4">
<h4 id="sec-4-2-4">Utilities</h4>
<div class="outline-text-4" id="text-4-2-4">
<p>

</p>


<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Change "yes or no" to "y or n"</span>
(fset 'yes-or-no-p 'y-or-n-p)

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/reload-dot-emacs</span> ()
  <span class="org-doc">"Save the .emacs buffer if needed, then reload .emacs."</span>
  (interactive)
  (<span class="org-keyword">let</span> ((dot-emacs <span class="org-string">"~/.emacs"</span>))
    (and (get-file-buffer dot-emacs)
         (save-buffer (get-file-buffer dot-emacs)))
    (load-file dot-emacs))
  (message <span class="org-string">"Re-initialized!"</span>))
</pre>
</div>
<p>
use keyfreq package to record the commands I use in Emacs.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">keyfreq</span>)
(keyfreq-mode 1)
(keyfreq-autosave-mode 1)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2-5" class="outline-4">
<h4 id="sec-4-2-5">System Path</h4>
<div class="outline-text-4" id="text-4-2-5">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">osx, work with homebrew </span>
(<span class="org-keyword">defun</span> <span class="org-function-name">set-exec-path-from-shell-PATH</span> ()
  (<span class="org-keyword">let</span> ((path-from-shell 
         (replace-regexp-in-string <span class="org-string">"[[:space:]\n]*$"</span> <span class="org-string">""</span> 
                                   (shell-command-to-string <span class="org-string">"$SHELL -l -c 'echo </span><span class="org-string"><span class="org-whitespace-line">$PATH'"</span></span><span class="org-whitespace-line">))))</span>
    (setenv <span class="org-string">"PATH"</span> path-from-shell)
    (setq exec-path (split-string path-from-shell path-separator))))
(<span class="org-keyword">when</span> (equal system-type 'darwin) (set-exec-path-from-shell-PATH))


<span class="org-comment-delimiter">;; </span><span class="org-comment">modify mac keyboard </span>
(<span class="org-keyword">cond</span> ((eq system-type 'darwin)
       (fset 'insertPound <span class="org-string">"#"</span>)
       (global-set-key (kbd <span class="org-string">"M-3"</span>) 'insertPound)
       (setq ispell-program-name <span class="org-string">"/usr/local/bin/aspell"</span>)
       (setq mac-command-modifier 'meta)
       (global-unset-key (kbd <span class="org-string">"M-`"</span>))
       (global-set-key (kbd <span class="org-string">"M-`"</span>) 'other-frame)
       (global-set-key (kbd <span class="org-string">"C-Z"</span>) nil)
       ))

(prefer-coding-system 'utf-8)
(<span class="org-keyword">when</span> (display-graphic-p)
  (setq x-select-request-type '(UTF8_STRING COMPOUND_TEXT TEXT STRING)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">windows path convention</span>
(setenv <span class="org-string">"CYGWIN"</span> <span class="org-string">"nodosfilewarning"</span>)
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-2-6" class="outline-4">
<h4 id="sec-4-2-6">general editing</h4>
<div class="outline-text-4" id="text-4-2-6">
<p>
smartparens mode 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'smartparens-config)</span>
(smartparens-global-mode 1)

(sp-pair <span class="org-string">"("</span> <span class="org-string">")"</span> <span class="org-builtin">:wrap</span> <span class="org-string">"C-("</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">|foobar</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">hit C-(</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">becomes (|foobar)</span>
(sp-pair <span class="org-string">"'"</span> nil <span class="org-builtin">:actions</span> <span class="org-builtin">:rem</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-2-7" class="outline-4">
<h4 id="sec-4-2-7">Minibuffer history</h4>
<div class="outline-text-4" id="text-4-2-7">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq savehist-file <span class="org-string">"~/git/.emacs.d/history"</span>)
(savehist-mode 1)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">UI - Emacs Looks Cool</h3>
<div class="outline-text-3" id="text-4-3">
<p>

</p>

<p>
mode-line
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(display-time-mode)
(<span class="org-keyword">require</span> '<span class="org-constant">smart-mode-line</span>)
(setq powerline-arrow-shape 'curve)
(setq powerline-default-separator-dir '(right . left))
<span class="org-comment-delimiter">;; </span><span class="org-comment">These two lines you really need.</span>
(setq sml/theme 'powerline)
(setq sml/mode-width 0)
(setq sml/name-width 20)
(rich-minority-mode 1)
(setf rm-blacklist <span class="org-string">""</span>)
(sml/setup)
</pre>
</div>


<p>
theme:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">;; copy from http://amitp.blogspot.co.uk/2011/08/emacs-custom-mode-line.html</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">;; Mode line setup 'prog-mode-hook 'rainbow-delimiters-mode)</span>

(load-theme 'zenburn t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">font</span>
(set-default-font <span class="org-string">"Source Code Pro"</span> nil t)
(set-face-attribute 'default nil <span class="org-builtin">:height</span> 100)
</pre>
</div>

<p>
minimalist:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(tool-bar-mode -1)
(menu-bar-mode -1)
(scroll-bar-mode -1)
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4">Completion and Selection</h3>
<div class="outline-text-3" id="text-4-4">
<p>

</p>
</div>
<div id="outline-container-sec-4-4-1" class="outline-4">
<h4 id="sec-4-4-1">Helm - Fuzzy Match</h4>
<div class="outline-text-4" id="text-4-4-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">helm</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">helm-config</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">The default "C-x c" is quite close to "C-x C-c", which quits Emacs.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Changed to "C-c h". Note: We must set "C-c h" globally, because we</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">cannot change `</span><span class="org-comment"><span class="org-constant">helm-command-prefix-key</span></span><span class="org-comment">' once `</span><span class="org-comment"><span class="org-constant">helm-config</span></span><span class="org-comment">' is loaded.</span>
(global-set-key (kbd <span class="org-string">"C-c h"</span>) 'helm-command-prefix)
(global-unset-key (kbd <span class="org-string">"C-x c"</span>))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-map (kbd "&lt;tab&gt;") 'helm-execute-persistent-action) ; rebind </span><span class="org-comment"><span class="org-whitespace-line">tab to run persistent action</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-map (kbd "C-i") 'helm-execute-persistent-action) ; make TAB </span><span class="org-comment"><span class="org-whitespace-line">works in terminal</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-map (kbd "C-z")  'helm-select-action) ; list actions using C</span><span class="org-comment"><span class="org-whitespace-line">-z</span></span>

(global-set-key (kbd <span class="org-string">"M-x"</span>) 'helm-M-x)
(global-set-key (kbd <span class="org-string">"C-x C-f"</span>) 'helm-find-files)

(setq helm-M-x-fuzzy-match t) <span class="org-comment-delimiter">;; </span><span class="org-comment">optional fuzzy matching for helm-M-x</span>

(global-set-key (kbd <span class="org-string">"M-y"</span>) 'helm-show-kill-ring)
<span class="org-comment-delimiter">;;</span><span class="org-comment">(global-set-key (kbd "C-x b") 'helm-mini)</span>
(global-set-key (kbd <span class="org-string">"M-l"</span>) 'helm-mini) 
(setq helm-buffers-fuzzy-matching t
      helm-recentf-fuzzy-match    t)
(global-set-key (kbd <span class="org-string">"C-c h o"</span>) 'helm-occur)
(global-set-key (kbd <span class="org-string">"C-h a"</span>) 'helm-apropos)
(setq helm-apropos-fuzzy-match t)
(setq helm-semantic-fuzzy-match t
      helm-imenu-fuzzy-match    t)

(helm-autoresize-mode t)
(<span class="org-keyword">defun</span> <span class="org-function-name">pl/helm-alive-p</span> ()
  (<span class="org-keyword">if</span> (boundp 'helm-alive-p)
      (symbol-value 'helm-alive-p)))
     (add-to-list 'golden-ratio-inhibit-functions 'pl/helm-alive-p)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(add-to-list 'golden-ratio-inhitib-functions 'pl/helm-alive-p)</span>

(helm-mode 1)
</pre>
</div>
</div>
</div>




<div id="outline-container-sec-4-4-2" class="outline-4">
<h4 id="sec-4-4-2">Multi-Cursor &amp; Helm-swoop  - Multiple Selection</h4>
<div class="outline-text-4" id="text-4-4-2">
<p>

</p>

<p>
When refactoring code, I need to rename a variable or function names, one way to do it is to search/replace, or use <code>multiple-cursors</code>. It provides function <code>mc/mark-next-like-this</code> so that I can see what has been marked, and change them all at once. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">multiple-cursors</span>)
(global-set-key (kbd <span class="org-string">"C-S-&lt;right&gt;"</span>) 'mc/mark-next-like-this)
(global-set-key (kbd <span class="org-string">"C-S-&lt;left&gt;"</span>) 'mc/mark-previous-like-this)
(global-set-key (kbd <span class="org-string">"C-S-c C-S-c"</span>) 'mc/edit-lines)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-&gt;") 'mc/mark-next-like-this)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-&lt;") 'mc/mark-previous-like-this)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c C-&lt;") 'mc/mark-all-like-this)</span>
(global-set-key (kbd <span class="org-string">"C-c C-&lt;"</span>) 'mc/mark-all-like-this)
</pre>
</div>


<p>
Quickly jump between the string of interests and maybe editing as well. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;;; </span><span class="org-comment">helm-swoop </span>
(<span class="org-keyword">require</span> '<span class="org-constant">helm-swoop</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">Change the keybinds to whatever you like :)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-i") 'helm-swoop)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "M-I") 'helm-swoop-back-to-last-point)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-c M-i") 'helm-multi-swoop)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key (kbd "C-x M-i") 'helm-multi-swoop-all)</span>
(global-set-key (kbd <span class="org-string">"&lt;C-f1&gt;"</span>) 'helm-swoop)
<span class="org-comment-delimiter">;; </span><span class="org-comment">When doing isearch, hand the word over to helm-swoop</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key isearchp-mode-map (kbd "M-i") 'helm-swoop-from-isearch)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">From helm-swoop to helm-multi-swoop-all</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key helm-swoop-map (kbd "M-i") 'helm-multi-swoop-all-from-helm-swoop)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">When doing evil-search, hand the word over to helm-swoop</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(define-key evil-motion-state-map (kbd "M-i") 'helm-swoop-from-evil-search)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Save buffer when helm-multi-swoop-edit complete</span>
(setq helm-multi-swoop-edit-save t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">If this value is t, split window inside the current window</span>
(setq helm-swoop-split-with-multiple-windows nil)
<span class="org-comment-delimiter">;; </span><span class="org-comment">Split direcion. 'split-window-vertically or 'split-window-horizontally</span>
(setq helm-swoop-split-direction 'split-window-vertically)
<span class="org-comment-delimiter">;; </span><span class="org-comment">If nil, you can slightly boost invoke speed in exchange for text color</span>
(setq helm-swoop-speed-or-color nil)
<span class="org-comment-delimiter">;; </span><span class="org-comment">----------------------------------------------------------------------</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-4-3" class="outline-4">
<h4 id="sec-4-4-3">ace-jump</h4>
<div class="outline-text-4" id="text-4-4-3">
<p>
ace-jump, currently only use ace-jump-word-mode.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(global-set-key (kbd <span class="org-string">"C-c w"</span>) 'ace-jump-word-mode)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-4-4" class="outline-4">
<h4 id="sec-4-4-4">Expand-Region - Incremental Selection</h4>
<div class="outline-text-4" id="text-4-4-4">
<p>

</p>

<p>
works well with smartparens mode. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">[[https://github.com/magnars/expand-region.el][expand-region]]</span>
(<span class="org-keyword">require</span> '<span class="org-constant">expand-region</span>)
(global-set-key (kbd <span class="org-string">"C-="</span>) 'er/expand-region)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5">ESS - Emacs Speaks Statistics</h3>
<div class="outline-text-3" id="text-4-5">

<p>
As Statistician, coding in R and writing report is what I do most of the day.  I have been though a long way of searching the perfect editor for me, tried Rstudio, SublimeText, TextMate and settled down happily with ESS/Emacs, for both coding and writing. 
</p>

<p>
There three features that have me made the decision: 
</p>

<ol class="org-ol">
<li>Auto Formatting 

<p>
Scientists has reputation of being bad programmers, who wrote the code that is unreadable and therefore incomprehensible to others.  I have intention to become top level programmer and followed a style guide strictly.  It means I have to spent sometime in adding and removing space in the code.
</p>

<p>
To my surprise, Emacs will do it for me automatically, just by hitting the TAB and it also indent smartly, which make me conformable to write long function call and split it into multiple lines.  Here's an example.  Also if I miss placed a ')' or ']' the formatting will become strange and it reminders me to check.   
</p>

<div class="org-src-container">

<pre class="src src-R">rainfall.subset &lt;- <span class="org-ess-function-call">data.table</span>(rainfall.london,
                              rainfall.pairs,
                              rainfall.dublin)
</pre>
</div>
</li>

<li>Search Command History

<p>
I frequently search the command history. Imaging I was produce a plot and I realised there was something miss in the data, so I go back and  fix the data first, then run the ggplot command again, I press Up/Down bottom many times, or just search once/two times. <code>M-x ggplot(</code>  will gives me the most recent command I typed containing the keyword <i>ggplot(</i>, then I press <code>RET</code> to select the command, which might be <code>ggplot(gg.df, aes(lon, lat, col = city)) + geom_line() + .....</code>.  If it is not I want, I press <code>C-r</code> again to choose the second most recent one and repeat until I find right one.  
</p>
</li>

<li>Literate Programming 

<p>
I am an supporter of literate statistical analysis and believe we should put code, results and discoveries together in developing models. Rstudio provides an easy to use tool for this purpose, but it does not support different R sessions, so if I need to generate a report, I have to re-run all the code from beginning, which isn't particle for me with volumes data because it will take quit long. 
</p>

<p>
ESS and org-mode works really well via Babel, which is more friendly to use.  I can choose to run only part of the code and have the output being inserted automatically, no need to copy/paste.  Also, I can choose where to execute the code, on my local machine or the remote server, or both at the same time.
</p>
</li>
</ol>

<p>
These are only the surface of ESS and there are lot more useful features like spell checking for comments and documentation templates, that makes me productive and I would recommend anyone use R to learn ESS/Emacs.  The following is my current setting. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Adapted with one minor change from Felipe Salazar at</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics</span>
(<span class="org-keyword">require</span> '<span class="org-constant">ess-site</span>)
(setq ess-ask-for-ess-directory nil) <span class="org-comment-delimiter">;; </span><span class="org-comment">start R on default folder</span>
(setq ess-local-process-name <span class="org-string">"R"</span>)
(setq ansi-color-for-comint-mode 'filter) <span class="org-comment-delimiter">;;</span>
(setq comint-scroll-to-bottom-on-input t)
(setq comint-scroll-to-bottom-on-output t)
(setq comint-move-point-for-output t)
(setq ess-eval-visibly-p 'nowait) <span class="org-comment-delimiter">;; </span><span class="org-comment">no waiting while ess evalating</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">my-ess-start-R</span> ()
  (interactive)
  (<span class="org-keyword">if</span> (not (member <span class="org-string">"*R-main*"</span> (mapcar (function buffer-name) (buffer-list))))
      (<span class="org-keyword">progn</span>
        (delete-other-windows)
        (setq w1 (selected-window))
        (setq w1name (buffer-name))
        (setq w2 (split-window w1 nil t))
        (R)
        (set-window-buffer w2 <span class="org-string">"*R*"</span>)
        (rename-buffer <span class="org-string">"*R-main*"</span>)
        (set-window-buffer w1 w1name))))
(<span class="org-keyword">defun</span> <span class="org-function-name">my-ess-eval</span> ()
  (interactive)
  (my-ess-start-R)
  (<span class="org-keyword">if</span> (and transient-mark-mode mark-active)
      (call-interactively 'ess-eval-region)
    (call-interactively 'ess-eval-line-and-step)))
(add-hook 'ess-mode-hook
          '(<span class="org-keyword">lambda</span>()
             (local-set-key [(shift return)] 'my-ess-eval)))
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'inferior-ess-mode-hook</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'(lambda()</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(local-set-key [C-up] 'comint-previous-input)</span>
<span class="org-comment-delimiter">;;              </span><span class="org-comment">(local-set-key [C-down] 'comint-next-input)))</span>
(add-hook 'ess-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (flyspell-prog-mode)
            (run-hooks 'prog-mode-hook)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(prog-mode)</span>
            ))
(add-hook 'ess-R-post-run-hook (<span class="org-keyword">lambda</span> () (smartparens-mode 1)))


<span class="org-comment-delimiter">;; </span><span class="org-comment">REF: http://stackoverflow.com/questions/2901198/useful-keyboard-shortcuts-and</span><span class="org-comment"><span class="org-whitespace-line">-tips-for-ess-r</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Control and up/down arrow keys to search history with matching what you've al</span><span class="org-comment"><span class="org-whitespace-line">ready typed:</span></span>
(define-key comint-mode-map [C-up] 'comint-previous-matching-input-from-input)
(define-key comint-mode-map [C-down] 'comint-next-matching-input-from-input)
(setq ess-history-directory <span class="org-string">"~/.Rhisotry/"</span>)
</pre>
</div>
</div>
<div id="outline-container-sec-4-5-1" class="outline-4">
<h4 id="sec-4-5-1">Start-up</h4>
<div class="outline-text-4" id="text-4-5-1">
<p>

</p>

<p>
when R start, it will load few local settings, one of them is the user-setting, which is R scripts saved in ~/RProfile.  I'd like to have same settings on both my local, and remote server. and this can be achieved by using <code>ess-post-run-hook</code>. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq yt/ess--RProfile-string <span class="org-string">"</span>
<span class="org-string">#### change this file name to .Rprofile and place to ~/userName so when R starts</span><span class="org-string"><span class="org-whitespace-line">, the following command will be processed automatically</span></span>

<span class="org-string">## http://stackoverflow.com/questions/1189759/expert-r-users-whats-in-your-rprof</span><span class="org-string"><span class="org-whitespace-line">ile</span></span>
<span class="org-string">options(\"width\"=160)                # wide display with multiple monitors</span>
<span class="org-string">options(\"digits.secs\"=3)            # show sub-second time stamps</span>
<span class="org-string">options(\"repos\" = c(CRAN = \"http://www.stats.bris.ac.uk/R/\")) # hard code th</span><span class="org-string"><span class="org-whitespace-line">e UK repo for CRAN</span></span>
<span class="org-string">options(\"max.print\" = 200)</span>
<span class="org-string">## from the AER book by Zeileis and Kleiber</span>
<span class="org-string">options(prompt=\"R&gt; \", digits=4, show.signif.stars=FALSE)</span>

<span class="org-string">.Libs &lt;- function(){</span>
<span class="org-string">    library(GFESLib)</span>
<span class="org-string">    require(data.table)</span>
<span class="org-string">    require(ggplot2)</span>
<span class="org-string">    require(gridExtra)</span>
<span class="org-string">    require(sp)</span>
<span class="org-string">    require(geosphere)</span>
<span class="org-string">    library(rgeos)</span>
<span class="org-string">    require(sp)</span>
<span class="org-string">    require(dragonfly)</span>
<span class="org-string">}</span>

<span class="org-string">.libPaths(\"~/R_libs\")</span>
<span class="org-string">## improved list of objects</span>
<span class="org-string">.ls.objects &lt;- function (pos = 1, pattern, order.by,</span>
<span class="org-string">                 decreasing=FALSE, head=FALSE, n=5)</span>
<span class="org-string">    {</span>
<span class="org-string">        napply &lt;- function(names, fn) sapply(names, function(x)</span>
<span class="org-string">            fn(get(x, pos = pos)))</span>
<span class="org-string">        names &lt;- ls(pos = pos, pattern = pattern)</span>
<span class="org-string">        obj.class &lt;- napply(names, function(x) as.character(class(x))[1])</span>
<span class="org-string">        obj.mode &lt;- napply(names, mode)</span>
<span class="org-string">        obj.type &lt;- ifelse(is.na(obj.class), obj.mode, obj.class)</span>
<span class="org-string">        obj.prettysize &lt;- napply(names, function(x) {</span>
<span class="org-string">                                    capture.output(print(object.size(x), units =</span><span class="org-string"><span class="org-whitespace-line"> \"auto\")) })</span></span>
<span class="org-string">        obj.size &lt;- napply(names, object.size)</span>
<span class="org-string">        obj.dim &lt;- t(napply(names, function(x)</span>
<span class="org-string">            as.numeric(dim(x))[1:2]))</span>
<span class="org-string">        vec &lt;- is.na(obj.dim)[, 1] &amp; (obj.type != \"function\")</span>
<span class="org-string">        obj.dim[vec, 1] &lt;- napply(names, length)[vec]</span>
<span class="org-string">        out &lt;- data.frame(obj.type, obj.size, obj.prettysize, obj.dim)</span>
<span class="org-string">        names(out) &lt;- c(\"Type\", \"Size\", \"PrettySize\", \"Rows\", \"Columns\</span><span class="org-string"><span class="org-whitespace-line">")</span></span>
<span class="org-string">        if (!missing(order.by))</span>
<span class="org-string">            out &lt;- out[order(out[[order.by]], decreasing=decreasing), ]</span>
<span class="org-string">        if (head)</span>
<span class="org-string">            out &lt;- head(out, n)</span>
<span class="org-string">        out</span>
<span class="org-string">    }</span>
<span class="org-string">## shorthand</span>
<span class="org-string">lsos &lt;- function(..., n=10) {</span>
<span class="org-string">    .ls.objects(..., order.by=\"Size\", decreasing=TRUE, head=TRUE, n=n)</span>
<span class="org-string">}"</span>)

(add-hook 'ess-post-run-hook
          (<span class="org-keyword">lambda</span> ()
            (goto-char (point-max))
            (insert yt/ess--RProfile-string)
            (inferior-ess-send-input) <span class="org-comment-delimiter">;; </span><span class="org-comment">execuate the R scripts </span>
            <span class="org-comment-delimiter">;; </span><span class="org-comment">clean up</span>
            (search-backward <span class="org-string">"Type 'q()' to quit R."</span>)
            (next-line)
            (delete-region (point) (point-max))
            (inferior-ess-send-input)
            ))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-2" class="outline-4">
<h4 id="sec-4-5-2">Syntax highlight</h4>
<div class="outline-text-4" id="text-4-5-2">
<p>
In Emacs, syntax highlighting is known as font-locking.  You can customize the amount of syntax highlighting that you want to see.  At the top of the Emacs window, click on the ESS menu and select "Font Lock".  This will display a menu of buttons corresponding to language elements that you can syntax highlight.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq ess-R-font-lock-keywords
    '((ess-R-fl-keyword:modifiers . t)
     (ess-R-fl-keyword:fun-defs . t)
     (ess-R-fl-keyword:keywords . t)
     (ess-R-fl-keyword:assign-ops)
     (ess-R-fl-keyword:constants . t)
     (ess-fl-keyword:fun-calls . t)
     (ess-fl-keyword:numbers)
     (ess-fl-keyword:operators)
     (ess-fl-keyword:delimiters)
     (ess-fl-keyword:=)
     (ess-R-fl-keyword:F&amp;T)
     (ess-R-fl-keyword:%op%)))
</pre>
</div>
<p>
use pretty mode 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'ess-mode-hook 'turn-on-pretty-mode)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-5-3" class="outline-4">
<h4 id="sec-4-5-3">Programming Mode</h4>
<div class="outline-text-4" id="text-4-5-3">
<p>
After 2014, Emacs comes a prog-mode, for programming langauge.  it is generic mode, just like text-mode, that sits underneth all the programming language, either R, phython, C++ etc.  The good thinkg to have this concept is that we can define few things that will apply to all these mode, when we write scripts.  
</p>

<p>
One thing I find particulaar usefull and necessary is to highliht  characters in comments that has particullar meaning, like TODO, FIXME or other.  which can be particular handy in code reivew, I can navite and jump between the code quickly. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">highlights </span><span class="org-warning">FIXME</span><span class="org-comment">: </span><span class="org-warning">TODO</span><span class="org-comment">: and </span><span class="org-warning">BUG</span><span class="org-comment">: in prog-mode </span>
(add-hook 'prog-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (font-lock-add-keywords nil
                                    '((<span class="org-string">"\\&lt;</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">YT</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">FIXME</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">TODO</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">BUG</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">:"</span> 1 fon<span class="org-whitespace-line">t-lock-warning-face t)))))</span>
</pre>
</div>

<p>
we usually have long scripts, and in Subimetext, one cold folder and unfolder a function. in Emacs, this feature could be extended to furture, by define folder-characters.  at this statge, I tented to used the deafault, I.e. folder functions only.  in the folliwng setting, I could press <code>F3</code> to folder/unfolder a function, <code>C-F3</code> or <code>S-F3</code> to folder/unfolder all functions. 
</p>

<p>
one potentially solution is to use <code>org-strct-mode</code>, to show/hide the whole section, I havne;t tryied it before, but it sounds a good idea.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'prog-mode-hook 'hs-minor-mode)
(global-set-key (kbd <span class="org-string">"&lt;f3&gt;"</span>) 'hs-toggle-hiding)
(global-set-key (kbd <span class="org-string">"S-&lt;f3&gt;"</span>) 'hs-show-all) <span class="org-comment-delimiter">;; </span><span class="org-comment">S-&gt;show </span>
(global-set-key (kbd <span class="org-string">"C-&lt;f3&gt;"</span>) 'hs-hide-all) 
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-block                      C-c @ C-h</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-show-block                      C-c @ C-s</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-all                        C-c @ C-M-h</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-show-all                        C-c @ C-M-s</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-level                      C-c @ C-l</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-toggle-hiding </span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-mouse-toggle-hiding             [(shift mouse-2)]</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">hs-hide-initial-comment-block</span>
(global-set-key (kbd <span class="org-string">"C-d"</span>) 'comment-region) <span class="org-comment-delimiter">;; </span><span class="org-comment">overwite delete-char </span>
(global-set-key (kbd <span class="org-string">"C-S-d"</span>) 'uncomment-region)
</pre>
</div>


<p>
use subword-mode then ThisPhase has two word, and I can use <code>C-DEL</code> it will remove the Phase and left This. Very useful in CamerCase.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(subword-mode 1)
</pre>
</div>


<p>
highlights the text that are longer than 80 columns rule. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">whitespace</span>)
(setq whitespace-line-column 80) <span class="org-comment-delimiter">;; </span><span class="org-comment">limit line length</span>
(setq whitespace-style '(face lines-tail))
(add-hook 'prog-mode-hook 'whitespace-mode)
</pre>
</div>


<p>
Rainbow-delimiters. constantly have problem with package, and tired of fixing it, so I turned it off at this stage. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">rainbow-delimiters</span>)
(add-hook 'prog-mode-hook 'rainbow-delimiters-mode)
(show-paren-mode t) <span class="org-comment-delimiter">;</span><span class="org-comment">for Emacs</span>
(<span class="org-keyword">require</span> '<span class="org-constant">cl-lib</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">color</span>)
(<span class="org-keyword">cl-loop</span>
 for index from 1 to rainbow-delimiters-max-face-count
 do
 (<span class="org-keyword">let</span> ((face (intern (format <span class="org-string">"rainbow-delimiters-depth-%d-face"</span> index))))
   (cl-callf color-saturate-name (face-foreground face) 30)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-5-4" class="outline-4">
<h4 id="sec-4-5-4">Documentation</h4>
<div class="outline-text-4" id="text-4-5-4">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">edit roxy template</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">ess-roxy-update-entry</span>
(setq ess-roxy-template-alist '((<span class="org-string">"description"</span> . <span class="org-string">" content for description"</span>)
                                (<span class="org-string">"details"</span> . <span class="org-string">"content for details"</span>)
                                (<span class="org-string">"title"</span> . <span class="org-string">""</span>)
                                (<span class="org-string">"param"</span> . <span class="org-string">""</span>)
                                (<span class="org-string">"return"</span> . <span class="org-string">""</span>)
                                (<span class="org-string">"export"</span> . <span class="org-string">""</span>)
                                (<span class="org-string">"author"</span> . <span class="org-string">"Yi Tang"</span>)))
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-5-5" class="outline-4">
<h4 id="sec-4-5-5">R Style Check - Flycheck</h4>
<div class="outline-text-4" id="text-4-5-5">
<p>

</p>

<p>
<a href="https://github.com/jimhester/lintr">https://github.com/jimhester/lintr</a>
the default R-style is not meet my with current R project style, has to turn it off.     
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">flycheck</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">'(flycheck-lintr-caching nil) ;; need to customised it inside of Emacs</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'ess-mode-hook</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">(lambda () (flycheck-mode t)))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6">File Manager</h3>
<div class="outline-text-3" id="text-4-6">
<p>

</p>
</div>
<div id="outline-container-sec-4-6-1" class="outline-4">
<h4 id="sec-4-6-1">Alternative to shell</h4>
<div class="outline-text-4" id="text-4-6-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">full path of current buffer</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/copy-full-path-to-kill-ring</span> ()
  <span class="org-doc">"copy buffer's full path to kill ring"</span>
  (interactive)
  (<span class="org-keyword">when</span> buffer-file-name
    (kill-new (file-truename buffer-file-name))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">rename current buffer-visiting file</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/rename-current-buffer-file</span> ()
  <span class="org-doc">"Renames current buffer and file it is visiting."</span>
  (interactive)
  (<span class="org-keyword">let</span> ((name (buffer-name))
        (filename (buffer-file-name)))
    (<span class="org-keyword">if</span> (not (and filename (file-exists-p filename)))
        (<span class="org-warning">error</span> <span class="org-string">"Buffer '%s' is not visiting a file!"</span> name)
      (<span class="org-keyword">let</span> ((new-name (read-file-name <span class="org-string">"New name: "</span> filename)))
        (<span class="org-keyword">if</span> (get-buffer new-name)
            (<span class="org-warning">error</span> <span class="org-string">"A buffer named '%s' already exists!"</span> new-name)
          (rename-file filename new-name 1)
          (rename-buffer new-name)
          (set-visited-file-name new-name)
          (set-buffer-modified-p nil)
          (message <span class="org-string">"File '%s' successfully renamed to '%s'"</span>
                   name (file-name-nondirectory new-name)))))))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/delete-this-buffer-and-file</span> ()
  <span class="org-doc">"Removes file connected to current buffer and kills buffer."</span>
  (interactive)
  (<span class="org-keyword">let</span> ((filename (buffer-file-name))
        (buffer (current-buffer))
        (name (buffer-name)))
    (<span class="org-keyword">if</span> (not (and filename (file-exists-p filename)))
        (<span class="org-warning">error</span> <span class="org-string">"Buffer '%s' is not visiting a file!"</span> name)
      (<span class="org-keyword">when</span> (yes-or-no-p <span class="org-string">"Are you sure you want to remove this file? "</span>)
        (delete-file filename)
        (kill-buffer buffer)
        (message <span class="org-string">"File '%s' successfully removed"</span> filename)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/sudo-find-file</span> (file-name)
  <span class="org-doc">"Like find file, but opens the file as root."</span>
  (interactive <span class="org-string">"FSudo Find File: "</span>)
  (<span class="org-keyword">let</span> ((tramp-file-name (concat <span class="org-string">"/sudo::"</span> (expand-file-name file-name))))
    (find-file tramp-file-name)))


(defhydra hydra-file-management (<span class="org-builtin">:color</span> red
                                        <span class="org-builtin">:hint</span> nil)
  <span class="org-string">"</span>
<span class="org-string">_o_pen file</span>
<span class="org-string">_O_pen file as Sudo user </span>
<span class="org-string">copy file _p_ath to kill ring</span>
<span class="org-string">_r_ename buffer-visiting file </span>
<span class="org-string">_d_elete buffer-visiting file"</span>
  (<span class="org-string">"o"</span> find-file)
  (<span class="org-string">"O"</span> yt/sudo-find-file)
  (<span class="org-string">"p"</span> yt/copy-full-path-to-kill-ring)
  (<span class="org-string">"r"</span> yt/rename-current-buffer-file)
  (<span class="org-string">"c"</span> yt/copy-file-to)
  (<span class="org-string">"d"</span> yt/delete-this-buffer-and-file)
  )
(global-set-key [f5] 'hydra-file-management/body)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-6-2" class="outline-4">
<h4 id="sec-4-6-2">Projectile - Directory Access</h4>
<div class="outline-text-4" id="text-4-6-2">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">projectile</span>)
(helm-projectile-on)
(<span class="org-keyword">require</span> '<span class="org-constant">helm-projectile</span>)
(projectile-global-mode)
(setq projectile-enable-caching t)
(setq projectile-switch-project-action 'projectile-dired)
(setq projectile-remember-window-configs t )
(setq projectile-completion-system 'helm)
(setq projectile-switch-project-action 'helm-projectile)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-6-3" class="outline-4">
<h4 id="sec-4-6-3">Remote (SSH)</h4>
<div class="outline-text-4" id="text-4-6-3">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-22 Thu 23:11]</span></span>
Sometimes, I need to sync between local and remote machine, I can do it in termnial or in Emacs. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">tramp</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">ssh</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yt/sync-local-remote ()</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">"copy all files in remote:~/LR_share to local:~/LR_share,</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">does not support the ther way"</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(find-file "/ssh:JBA28:/home/local/JBANORTHWEST/yitang/LR_share")</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (mark-whole-buffer)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(dired-mark-subdir-files)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (find-file "~/LR_share")</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">;; (setq-local dirqed-dwim-target t)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(dired-do-copy))</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-6-4" class="outline-4">
<h4 id="sec-4-6-4">Git Sync</h4>
<div class="outline-text-4" id="text-4-6-4">
<p>

</p>

<p>
I use git and Github a lot, and usually in <code>shell-mode</code>, but I just can't remember all the commands.  Magit provides an interface to Git, and it is really pleasant to use.  So I don't need to remmeber all the commands, also it comes with excellent <a href="http://magit.github.io/master/magit.html">manual</a> and <a href="http://daemianmack.com/magit-cheatsheet.html">cheatsheet</a>.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">magit</span>)
</pre>
</div>

<p>
I use Emacs/org-mode as a unified system to do everything, at home, on Macbook Pro, on office, Windows/Ubuntu.  I used to use Dropbox/Copy to automateally sync the files on multiple machines, but this workflows seems dangous, image if I was editing same files on two machines at the same time, then I can't track which is which. 
</p>

<p>
The good thing about Git is that you can see what exactlly has been changed by each version, and auto log, with commit information and timesatmp.  Magit helps me to do it conviently but I need 3 more features: 
</p>
<ol class="org-ol">
<li>automatically save all the buffers

<p>
Ocanationally my office machine goes down because I run R with big data, and it commused all the memoery. If that happens, I potentially lose the newstest version of sripcts, which is bit annoy. The following snippets will save all buffers in every hours. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">yt/save-all-buffers</span> ()
  <span class="org-doc">"save all files-visiting buffers without user confirmation"</span>
  (interactive)
  (save-some-buffers t nil)
  (message <span class="org-string">"save all buffers... done"</span>))
(run-at-time <span class="org-string">"05:59"</span> 3600 'yt/save-all-buffers)))
</pre>
</div>
</li>
<li>quick rush

<p>
I shared lift with my colluge, and someimes I left at the last minutes, then what I do is call a  functions that commits and upload to the repo so that I can continue work at home.
</p>

<p>
The <code>yt/save-git-backup</code> function will do 
</p>
<ol class="org-ol">
<li>pull from the cloud, and make sure the local repo is always up-to-date.
</li>
<li>add everything and commit with a timesamp.
</li>
<li>push local changes to the cloud.
</li>
</ol>
<p>
Here is the snippts. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-backup</span> ()
  (interactive)
  (<span class="org-keyword">let</span> ((git-sh-scripts <span class="org-string">"</span>
<span class="org-string">echo Start to Sync: $(date) </span>

<span class="org-string">REPOS=\"org jbarm\"</span>
<span class="org-string">for REPO in $REPOS</span>
<span class="org-string">do</span>
<span class="org-string">    echo</span>
<span class="org-string">    echo \"Repository: $REPO\"</span>
<span class="org-string">    cd ~/git/$REPO</span>
<span class="org-string">    # update</span>
<span class="org-string">    git pull </span>
<span class="org-string">    # Remove deleted files</span>
<span class="org-string">    git ls-files --deleted -z | xargs -0 git rm &gt;/dev/null 2&gt;&amp;1</span>
<span class="org-string">    # Add new files</span>
<span class="org-string">    git add -A . &gt;/dev/null 2&gt;&amp;1</span>
<span class="org-string">    git commit -m \"$(date)\"</span>
<span class="org-string">    git push origin master </span>
<span class="org-string">done</span>

<span class="org-string">echo Finished Sync: $(date)</span>
<span class="org-string">"</span>))
    (async-shell-command git-sh-scripts))
  (message <span class="org-string">"all git sync... done"</span>))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/save-git-backup</span> ()
  (interactive)
  (yt/save-all-buffers)
  (yt/git-backup))
</pre>
</div>
</li>
<li>automatically commit 

<p>
Few times I did some important work over the weenend, but once I arrived office I realised I forgot uploading, These situations are quick fraustrative. The following snnipets will start to uploads once every three hours on my MacbookPro, but I don't use it anymore, since I can get most of my work done in the office.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(cond ((eq system-type 'darwin)</span>
<span class="org-comment-delimiter">;;        </span><span class="org-comment">(run-at-time "05:59" 10800 'yt/save-git-backup)))</span>
</pre>
</div>
</li>
</ol>
</div>
</div>
</div>


<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7">Writing in Emacs</h3>
<div class="outline-text-3" id="text-4-7">
<p>

</p>
</div>
<div id="outline-container-sec-4-7-1" class="outline-4">
<h4 id="sec-4-7-1">English Language</h4>
<div class="outline-text-4" id="text-4-7-1">
<p>

</p>

<p>
I type quit fast with lots of misspell and in writing, I don't need to correct every single one when writing, which will stop the flow.  I will do it afterwards in editing, I will press C-, to move the cursor to next misspelled word, and press <code>C-.</code> to correcct it, press it again, to correct it to another words.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">check spelling  </span>
(add-hook 'text-mode-hook 'flyspell-mode)
(add-hook 'org-mode-hook 'flyspell-mode)
(setq ispell-dictionary <span class="org-string">"british"</span>
      ispell-extra-args '() <span class="org-comment-delimiter">;; </span><span class="org-comment">TeX mode "-t"</span>
      ispell-silently-savep t)
(setq ispell-personal-dictionary <span class="org-string">"~/git/.emacs.d/personal-dict"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">add personal</span><span class="org-comment"><span class="org-whitespace-line"> dictionary</span></span>
</pre>
</div>

<p>
I need an grammar check to let me know that 
</p>
<pre class="example">
Have you do ...
</pre>
<p>
is wrong, and also tell me to change <i>do</i> to <i>done</i>, and also why.  <code>langtool</code> can do be the job, but currently I don't understand how to get it works, so I am not using it anymore. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">check grammar </span>
(<span class="org-keyword">require</span> '<span class="org-constant">langtool</span>)
(setq langtool-language-tool-jar <span class="org-string">"~/Java/LanguageTool-2.8/languagetool-commandli</span><span class="org-string"><span class="org-whitespace-line">ne.jar"</span></span><span class="org-whitespace-line">)</span>
(setq langtool-mother-tongue <span class="org-string">"en"</span>)
</pre>
</div>

<p>
English is my second language, and I am trying to avoid certain guarding term in writing.  The following snipts I get it from Sachua will highlight the word like <i>shuold</i> or <i>I think</i>, which reminds to confirm with what I am not sure about, and have more confidence in what I am saying. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">artbollocks-mode</span>)
(add-hook 'text-mode-hook 'artbollocks-mode)
(setq artbollocks-weasel-words-regex
      (concat <span class="org-string">"\\b"</span> (regexp-opt
                     '(<span class="org-string">"should"</span>
                       <span class="org-string">"just"</span>
                       <span class="org-string">"sort of"</span>
                       <span class="org-string">"a lot"</span>
                       <span class="org-string">"probably"</span>
                       <span class="org-string">"maybe"</span>
                       <span class="org-string">"perhaps"</span>
                       <span class="org-string">"I think"</span>
                       <span class="org-string">"really"</span>
                       <span class="org-string">"nice"</span>) t) <span class="org-string">"\\b"</span>))
</pre>
</div>

<p>
For about one month, I tried to write at least 500 words per day.  I also set up a special <code>write-mode</code> that has different color scheldules that helps me to set the moode.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">[2014-12-25 Thu 22:21]</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/write-mode</span> ()
  (interactive)
  (hl-sentence-mode)
  (variable-pitch-mode)
  (nanowrimo-mode))

<span class="org-comment-delimiter">;; </span><span class="org-comment">word count</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">https://bitbucket.org/gvol/nanowrimo.el</span>
(<span class="org-keyword">require</span> '<span class="org-constant">org-wc</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">nanowrimo</span>)
(setq nanowrimo-today-goal 500)


<span class="org-comment-delimiter">;; </span><span class="org-comment">[2014-12-23 Tue 22:06]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Highlight sentence</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">https://www.gnu.org/software/emacs/manual/html_node/elisp/Attribute-Functions</span><span class="org-comment"><span class="org-whitespace-line">.html</span></span>
(<span class="org-keyword">require</span> '<span class="org-constant">hl-sentence</span>)
(add-hook 'nanowrimo-mode 'hl-sentence-mode)
(set-face-attribute 'hl-sentence-face nil
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">:foreground "black")</span>
                    <span class="org-builtin">:foreground</span> <span class="org-string">"white"</span>)
(add-hook 'nanowrimo-mode 'variable-pitch-mode)
(set-face-attribute 'variable-pitch nil
                    <span class="org-builtin">:foreground</span> <span class="org-string">"gray40"</span>)
</pre>
</div>






<p>
add synosaurus
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">[2015-02-12 Thu 21:14]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">https://github.com/rootzlevel/synosaurus</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">synosaurus-lookup</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">synosaurus-choose-and-replace</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">brew install wordnet</span>
(<span class="org-keyword">require</span> '<span class="org-constant">synosaurus</span>)
(setq synosaurus-choose-method <span class="org-string">"popup"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">synosaurus-lookup C-c s l</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">synosaurus-choose-and-replace C-c s r        </span>
(setq synosaurus-backend 'synosaurus-backend-wordnet)
(setq synosaurus-choose-method 'popup)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-7-2" class="outline-4">
<h4 id="sec-4-7-2">Random Quotes</h4>
<div class="outline-text-4" id="text-4-7-2">
<p>

</p>

<p>
If I run out of idea, and I didn't write anything for 1 minutes, Emacs will pop a random quote that I collected in the echo area. The random quotes can inspire me sometimes.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defconst</span> <span class="org-variable-name">yt/quotes</span>
  '(<span class="org-string">"You can't see paradise, if you don't pedal.  - Chicken Run "</span>
    <span class="org-string">"He who who says he can and he who says he can&#8217;t are both usually right &#8213; Co</span><span class="org-string"><span class="org-whitespace-line">nfucius"</span></span>
    <span class="org-string">"Why waste time proving over and over how great you are when you could be ge</span><span class="org-string"><span class="org-whitespace-line">tting better? - Dweck The Mindset"</span></span>
    <span class="org-string">"You&#8217;re not a failure until you start to assign blame. - The legendary baske</span><span class="org-string"><span class="org-whitespace-line">tball coach John Wooden"</span></span>
    <span class="org-string">"I could hear my heart beating. I could hear everyone's heart. I could hear </span><span class="org-string"><span class="org-whitespace-line">the human noise we sat there making, not one of us moving, not even when the room went dark. - Raymond Carver"</span></span>
    <span class="org-string">"A writer is a sum of their experiences. Go get some - Stuck in Love (2012)"</span>
    <span class="org-string">"If there is any one secret of success, it lies in the ability to get the ot</span><span class="org-string"><span class="org-whitespace-line">her person's point of view and see things from that person's angle as well as from your own. - Henry Ford"</span></span>
    <span class="org-string">"People who can put themselves in the place of other people who can understa</span><span class="org-string"><span class="org-whitespace-line">nd the workings of their minds, need never worry about what the future has in store for them. - Owen D. Young"</span></span>
    )
  <span class="org-doc">"Good quotes </span>
<span class="org-doc">   they can be useful for creative writers as well."</span>)
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/show-random-quotes</span> ()
  <span class="org-doc">"Show random quotes to minibuffer"</span>
  (interactive)
  (message <span class="org-string">"%s"</span>
           (nth (random (length yt/quotes))
                yt/quotes)))
(run-with-idle-timer 60 t 'yt/show-random-quotes)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-7-3" class="outline-4">
<h4 id="sec-4-7-3">Abbreviation</h4>
<div class="outline-text-4" id="text-4-7-3">
<p>
I have been writing in Emacs/org-mode a lot, have been really tired of capitalise i to I, so I use abbrevitation table. 
</p>

<table id="my-text-abbrevs" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">name</th>
<th scope="col" class="left">expand</th>
<th scope="col" class="left">Category</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">i</td>
<td class="left">I</td>
<td class="left">write</td>
</tr>

<tr>
<td class="left">amax</td>
<td class="left">annual maximum</td>
<td class="left">stat</td>
</tr>

<tr>
<td class="left">gmap</td>
<td class="left">google map</td>
<td class="left">website</td>
</tr>

<tr>
<td class="left">mailme</td>
<td class="left">yi.tang.uk@me.com</td>
<td class="left">aboutme</td>
</tr>

<tr>
<td class="left">twitterme</td>
<td class="left">@yi_tang_uk</td>
<td class="left">aboutme</td>
</tr>

<tr>
<td class="left">iif</td>
<td class="left">if and only if</td>
<td class="left">maths</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">my-text-abbrev-expand-p</span> ()
  <span class="org-doc">"Return t if the abbrev is in a text context, which is: in</span>
<span class="org-doc"> comments and strings only when in a prog-mode derived-mode or</span>
<span class="org-doc"> src block in org-mode, and anywhere else."</span>
  (<span class="org-keyword">if</span> (or (derived-mode-p 'prog-mode)
          (and (eq major-mode 'org-mode)
               (org-in-src-block-p 'inside)))
      (nth 8 (syntax-ppss))
    t))

(define-abbrev-table 'my-text-abbrev-table ()
  <span class="org-doc">"Abbrev table for text-only abbrevs. Expands only in comments and strings."</span>
  <span class="org-builtin">:enable-function</span> #'my-text-abbrev-expand-p)

(<span class="org-keyword">dolist</span> (table (list text-mode-abbrev-table
                     prog-mode-abbrev-table))
  (abbrev-table-put table
                    <span class="org-builtin">:parents</span> (list my-text-abbrev-table)))

(<span class="org-keyword">defun</span> <span class="org-function-name">my-text-abbrev-table-init</span> (abbrevs-org-list)
  <span class="org-doc">"Parse 'name: expansion' pairs from an org list and insert into abbrev table."</span>
  (message <span class="org-string">"Creating text-abbrev table..."</span>)
  (<span class="org-keyword">dolist</span> (abbrev abbrevs-org-list)
    (<span class="org-keyword">let</span> ((name (nth 0 abbrev))
          (expansion (nth 1 abbrev)))
      <span class="org-comment-delimiter">;; </span><span class="org-comment">(print (cons name expansion))</span>
      (define-abbrev my-text-abbrev-table name expansion nil <span class="org-builtin">:system</span> t))))
(my-text-abbrev-table-init my-text-abbrevs)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8">eww</h3>
<div class="outline-text-3" id="text-4-8">
<p>
toggle the inline image 
</p>

<p>
<a href="http://emacs.stackexchange.com/questions/561/how-can-i-toggle-displaying-images-in-eww-without-a-page-refresh">http://emacs.stackexchange.com/questions/561/how-can-i-toggle-displaying-images-in-eww-without-a-page-refresh</a>
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar-local</span> <span class="org-variable-name">endless/display-images</span> t)

(<span class="org-keyword">defun</span> <span class="org-function-name">endless/toggle-image-display</span> ()
  <span class="org-doc">"Toggle images display on current buffer."</span>
  (interactive)
  (setq endless/display-images
        (null endless/display-images))
  (endless/backup-display-property endless/display-images))

(<span class="org-keyword">defun</span> <span class="org-function-name">endless/backup-display-property</span> (invert <span class="org-type">&amp;optional</span> object)
  <span class="org-doc">"Move the 'display property at POS to 'display-backup.</span>
<span class="org-doc">Only applies if display property is an image.</span>
<span class="org-doc">If INVERT is non-nil, move from 'display-backup to 'display</span>
<span class="org-doc">instead.</span>
<span class="org-doc">Optional OBJECT specifies the string or buffer. Nil means current</span>
<span class="org-doc">buffer."</span>
  (<span class="org-keyword">let*</span> ((inhibit-read-only t)
         (from (<span class="org-keyword">if</span> invert 'display-backup 'display))
         (to (<span class="org-keyword">if</span> invert 'display 'display-backup))
         (pos (point-min))
         left prop)
    (<span class="org-keyword">while</span> (and pos (/= pos (point-max)))
      (<span class="org-keyword">if</span> (get-text-property pos from object)
          (setq left pos)
        (setq left (next-single-property-change pos from object)))
      (<span class="org-keyword">if</span> (or (null left) (= left (point-max)))
          (setq pos nil)
        (setq prop (get-text-property left from object))
        (setq pos (or (next-single-property-change left from object)
                      (point-max)))
        (<span class="org-keyword">when</span> (eq (car prop) 'image)
          (add-text-properties left pos (list from nil to prop) object))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-9" class="outline-3">
<h3 id="sec-4-9">Org mode</h3>
<div class="outline-text-3" id="text-4-9">
<p>
I started to learn Emacs by reading Bernt Hansen's  <a href="http://doc.norang.ca/org-mode.html">Org Mode - Organize Your Life In Plain Text!</a>
</p>
</div>
<div id="outline-container-sec-4-9-1" class="outline-4">
<h4 id="sec-4-9-1">customised</h4>
<div class="outline-text-4" id="text-4-9-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">my/modify-org-done-face</span> ()
  (setq org-fontify-done-headline t)
  (set-face-attribute 'org-done nil <span class="org-builtin">:strike-through</span> t)
  (set-face-attribute 'org-headline-done nil
                      <span class="org-builtin">:strike-through</span> t
                      <span class="org-builtin">:foreground</span> <span class="org-string">"light gray"</span>))
(add-hook 'org-mode-hook 'my/modify-org-done-face)

(setq org-fontify-done-headline t)
(set-face-attribute 'org-done nil <span class="org-builtin">:strike-through</span> t)
(set-face-attribute 'org-headline-done nil <span class="org-builtin">:strike-through</span> t)
</pre>
</div>


<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq org-archive-location <span class="org-string">"::* Archived Tasks"</span>) <span class="org-comment-delimiter">;;</span><span class="org-comment">in-file archive </span>
(setq org-habit-show-habits nil)
(setq org-agenda-span 'week)
</pre>
</div>

<p>
Add markup wrapper for org-mode. to turn a word into bold, wrapper in a selected region, by using expand-region, which is bound to <code>C-=</code> then type *. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(sp-local-pair 'org-mode <span class="org-string">"="</span> <span class="org-string">"="</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">select region, hit = then region -&gt; =region=</span><span class="org-comment"><span class="org-whitespace-line"> in org-mode</span></span>
(sp-local-pair 'org-mode <span class="org-string">"*"</span> <span class="org-string">"*"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">select region, hit * then region -&gt; *region*</span><span class="org-comment"><span class="org-whitespace-line"> in org-mode</span></span>
(sp-local-pair 'org-mode <span class="org-string">"/"</span> <span class="org-string">"/"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">select region, hit / then region -&gt; /region/</span><span class="org-comment"><span class="org-whitespace-line"> in org-mode</span></span>
(sp-local-pair 'org-mode <span class="org-string">"_"</span> <span class="org-string">"_"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">select region, hit _ then region -&gt; _region_</span><span class="org-comment"><span class="org-whitespace-line"> in org-mode</span></span>
(sp-local-pair 'org-mode <span class="org-string">"+"</span> <span class="org-string">"+"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">select region, hit + then region -&gt; +region+</span><span class="org-comment"><span class="org-whitespace-line"> in org-mode</span></span>
</pre>
</div>

<p>
associate fills with .org extension with org-mode. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org\\'"</span> . org-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-9-2" class="outline-4">
<h4 id="sec-4-9-2">contribute libraries</h4>
<div class="outline-text-4" id="text-4-9-2">
<p>
Show org-mode bullets as UTF-8 characters.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">org-bullets</span>)
(add-to-list 'auto-mode-alist '(<span class="org-string">"\\.org\\'"</span> . org-mode))
(setq org-bullets-bullet-list '(<span class="org-comment-delimiter">;;; </span><span class="org-comment">Large</span>
                                <span class="org-string">"&#9673;"</span> <span class="org-string">"&#9675;"</span> <span class="org-comment-delimiter">;</span><span class="org-comment">"&#9678;" "&#9676;"</span>
                                <span class="org-string">"&#9672;"</span> <span class="org-string">"&#9671;"</span>
                                <span class="org-string">"&#9724;"</span> <span class="org-string">"&#9723;"</span>
                                <span class="org-string">"&#9650;"</span> <span class="org-string">"&#9651;"</span>
                                <span class="org-string">"&#10048;"</span> <span class="org-string">"&#10047;"</span> <span class="org-comment-delimiter">;</span><span class="org-comment">"&#10040;"</span>
                                <span class="org-string">"&#10010;"</span> <span class="org-string">"&#10012;"</span> 
                                <span class="org-string">"&#9679;"</span> <span class="org-string">"&#9775;"</span> <span class="org-comment-delimiter">;</span><span class="org-comment">"&#9762;" </span>
                                <span class="org-string">"&#9824;"</span> <span class="org-string">"&#9827;"</span> <span class="org-string">"&#9830;"</span> <span class="org-string">"&#9829;"</span>))
(add-hook 'org-mode-hook (<span class="org-keyword">lambda</span> () (org-bullets-mode 1)))
</pre>
</div>

<p>
org-download 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq-default org-download-image-dir <span class="org-string">"~/Downloads/img"</span>)
(setq-default org-download-heading-lvl nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-9-3" class="outline-4">
<h4 id="sec-4-9-3">Calendar</h4>
<div class="outline-text-4" id="text-4-9-3">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-02-23 Mon 10:20]</span></span>
<a href="https://github.com/kiwanami/emacs-calfw">calfw</a> display a calendar view in Emacs buffer.  this package has a good API, can integrate various calendar resources, iCal, Google Calendar and Org-mode etc into one calendar.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">calfw-cal</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'calfw-ical)</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(require 'calfw-howm)</span>
(<span class="org-keyword">require</span> '<span class="org-constant">calfw-org</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">my-open-calendar</span> ()
  (interactive)
  (cfw:open-calendar-buffer
   <span class="org-builtin">:contents-sources</span>
   (list
    (cfw:org-create-source <span class="org-string">"Green"</span>)  <span class="org-comment-delimiter">; </span><span class="org-comment">orgmode source</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(cfw:howm-create-source "Blue")  ; howm source</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(cfw:cal-create-source "Orange") ; diary source</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(cfw:ical-create-source "Moon" "~/moon.ics" "Gray")  ; ICS source1</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(cfw:ical-create-source "gcal" "https://..../basic.ics" "IndianRed") ; goo</span><span class="org-comment"><span class="org-whitespace-line">gle calendar ICS</span></span>
   ))) 

<span class="org-comment-delimiter">;;;; </span><span class="org-comment">customization </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Month</span>
(setq calendar-month-name-array
  [<span class="org-string">"January"</span> <span class="org-string">"February"</span> <span class="org-string">"March"</span>     <span class="org-string">"April"</span>   <span class="org-string">"May"</span>      <span class="org-string">"June"</span>
   <span class="org-string">"July"</span>    <span class="org-string">"August"</span>   <span class="org-string">"September"</span> <span class="org-string">"October"</span> <span class="org-string">"November"</span> <span class="org-string">"December"</span>])

<span class="org-comment-delimiter">;; </span><span class="org-comment">Week days</span>
(setq calendar-day-name-array
      [<span class="org-string">"Sunday"</span> <span class="org-string">"Monday"</span> <span class="org-string">"Tuesday"</span> <span class="org-string">"Wednesday"</span> <span class="org-string">"Thursday"</span> <span class="org-string">"Friday"</span> <span class="org-string">"Saturday"</span>])

<span class="org-comment-delimiter">;; </span><span class="org-comment">First day of the week</span>
(setq calendar-week-start-day 1) <span class="org-comment-delimiter">; </span><span class="org-comment">0:Sunday, 1:Monday</span>

(custom-set-faces
 '(cfw:face-title ((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#f0dfaf"</span> <span class="org-builtin">:weight</span> bold <span class="org-builtin">:height</span> 2.0 <span class="org-builtin">:inherit</span> v<span class="org-whitespace-line">ariable-pitch))))</span>
 '(cfw:face-header ((t (<span class="org-builtin">:foreground</span> <span class="org-string">"#d0bf8f"</span> <span class="org-builtin">:weight</span> bold))))
 '(cfw:face-sunday ((t <span class="org-builtin">:foreground</span> <span class="org-string">"#cc9393"</span> <span class="org-builtin">:background</span> <span class="org-string">"grey10"</span> <span class="org-builtin">:weight</span> bold))<span class="org-whitespace-line">)</span>
 '(cfw:face-saturday ((t <span class="org-builtin">:foreground</span> <span class="org-string">"#8cd0d3"</span> <span class="org-builtin">:background</span> <span class="org-string">"grey10"</span> <span class="org-builtin">:weight</span> bold<span class="org-whitespace-line">)))</span>
 '(cfw:face-holiday ((t <span class="org-builtin">:background</span> <span class="org-string">"grey10"</span> <span class="org-builtin">:foreground</span> <span class="org-string">"#8c5353"</span> <span class="org-builtin">:weight</span> bold)<span class="org-whitespace-line">))</span>
 '(cfw:face-grid ((t <span class="org-builtin">:foreground</span> <span class="org-string">"DarkGrey"</span>)))
 '(cfw:face-default-content ((t <span class="org-builtin">:foreground</span> <span class="org-string">"#bfebbf"</span>)))
 '(cfw:face-periods ((t <span class="org-builtin">:foreground</span> <span class="org-string">"cyan"</span>)))
 '(cfw:face-day-title ((t <span class="org-builtin">:background</span> <span class="org-string">"grey10"</span>)))
 '(cfw:face-default-day ((t <span class="org-builtin">:weight</span> bold <span class="org-builtin">:inherit</span> cfw:face-day-title)))
 '(cfw:face-annotation ((t <span class="org-builtin">:foreground</span> <span class="org-string">"RosyBrown"</span> <span class="org-builtin">:inherit</span> cfw:face-day-title))<span class="org-whitespace-line">)</span>
 '(cfw:face-disable ((t <span class="org-builtin">:foreground</span> <span class="org-string">"DarkGray"</span> <span class="org-builtin">:inherit</span> cfw:face-day-title)))
 '(cfw:face-today-title ((t <span class="org-builtin">:background</span> <span class="org-string">"#7f9f7f"</span> <span class="org-builtin">:weight</span> bold)))
 '(cfw:face-today ((t <span class="org-builtin">:background:</span> <span class="org-string">"grey10"</span> <span class="org-builtin">:weight</span> bold)))
 '(cfw:face-select ((t <span class="org-builtin">:background</span> <span class="org-string">"#2f2f2f"</span>)))
 '(cfw:face-toolbar ((t <span class="org-builtin">:foreground</span> <span class="org-string">"Steelblue4"</span> <span class="org-builtin">:background</span> <span class="org-string">"Steelblue4"</span>)))
 '(cfw:face-toolbar-button-off ((t <span class="org-builtin">:foreground</span> <span class="org-string">"Gray10"</span> <span class="org-builtin">:weight</span> bold)))
 '(cfw:face-toolbar-button-on ((t <span class="org-builtin">:foreground</span> <span class="org-string">"Gray50"</span> <span class="org-builtin">:weight</span> bold))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Default setting</span>
(setq cfw:fchar-junction ?+
      cfw:fchar-vertical-line ?|
      cfw:fchar-horizontal-line ?-
      cfw:fchar-left-junction ?+
      cfw:fchar-right-junction ?+
      cfw:fchar-top-junction ?+
      cfw:fchar-top-left-corner ?+
      cfw:fchar-top-right-corner ?+ )

<span class="org-comment-delimiter">;; </span><span class="org-comment">Unicode characters</span>
(setq cfw:fchar-junction ?&#9547;
      cfw:fchar-vertical-line ?&#9475;
      cfw:fchar-horizontal-line ?&#9473;
      cfw:fchar-left-junction ?&#9507;
      cfw:fchar-right-junction ?&#9515;
      cfw:fchar-top-junction ?&#9519;
      cfw:fchar-top-left-corner ?&#9487;
      cfw:fchar-top-right-corner ?&#9491;)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Another unicode chars</span>
(setq cfw:fchar-junction ?&#9580;
      cfw:fchar-vertical-line ?&#9553;
      cfw:fchar-horizontal-line ?&#9552;
      cfw:fchar-left-junction ?&#9568;
      cfw:fchar-right-junction ?&#9571;
      cfw:fchar-top-junction ?&#9574;
      cfw:fchar-top-left-corner ?&#9556;
      cfw:fchar-top-right-corner ?&#9559;)
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4-9-4" class="outline-4">
<h4 id="sec-4-9-4">Babel</h4>
<div class="outline-text-4" id="text-4-9-4">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq org-plantuml-jar-path <span class="org-string">"~/git/.emacs.d/java/plantuml.jar"</span>) <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: change </span><span class="org-comment"><span class="org-whitespace-line">the location.. </span></span>

(add-hook 'org-babel-after-execute-hook 'bh/display-inline-images 'append)

(setq org-babel-results-keyword <span class="org-string">"results"</span>)
(org-babel-do-load-languages
 (quote org-babel-load-languages)
 (quote ((emacs-lisp . t) <span class="org-comment-delimiter">;; </span><span class="org-warning">TODO</span><span class="org-comment">: simplifiy this list </span>
         (R . t)
         (sh . t)
         (ledger . t)
         (org . t)
         (plantuml . t)
         (dot . t)
         (octave . t)
         (latex . t))))

(add-to-list 'org-babel-default-header-args:R
             '(<span class="org-builtin">:session</span> . <span class="org-string">"*R-main*"</span>)
             '((<span class="org-builtin">:width</span> . 640) (<span class="org-builtin">:height</span> . 640)))


(setq org-confirm-babel-evaluate nil)

                                        <span class="org-comment-delimiter">;; </span><span class="org-comment">Use fundamental mode when editing pla</span><span class="org-comment"><span class="org-whitespace-line">ntuml blocks with C-c '</span></span>
 (add-to-list 'org-src-lang-modes (quote (<span class="org-string">"plantuml"</span> . fundamental)))
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-9-5" class="outline-4">
<h4 id="sec-4-9-5">Export</h4>
<div class="outline-text-4" id="text-4-9-5">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq org-export-with-toc nil
      org-export-with-todo-keywords t
      org-export-with-sub-superscripts nil
      org-export-with-planning t
      org-export-with-timestamps nil
      org-export-babel-evaluate nil)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-9-6" class="outline-4">
<h4 id="sec-4-9-6">PDF Export</h4>
<div class="outline-text-4" id="text-4-9-6">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">http://emacs-fu.blogspot.co.uk/2011/04/nice-looking-pdfs-with-org-mode-and.ht</span><span class="org-comment"><span class="org-whitespace-line">ml</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">'djcb-org-article' for export org documents to the LaTex 'article', using</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">XeTeX and some fancy fonts; requires XeTeX (see org-latex-to-pdf-process)</span>
(add-to-list 'org-latex-classes
             '(<span class="org-string">"yt/org-article"</span>
               <span class="org-string">"</span>
<span class="org-string">\\documentclass[11pt,a4paper]{article}</span>
<span class="org-string">\\usepackage{graphicx}    %% demo mode is a must when .img does not exists.</span>
<span class="org-string">\\usepackage[T1]{fontenc}</span>
<span class="org-string">\\usepackage{fontspec}</span>
<span class="org-string">\\usepackage{hyperref}</span>
<span class="org-string">\\usepackage{amsmath}</span>
<span class="org-string">\\usepackage{amstext}</span>
<span class="org-string">\\usepackage{amssymb} %% checkbox</span>
<span class="org-string">\\usepackage{minted}</span>
<span class="org-string">\\defaultfontfeatures{Mapping=tex-text}</span>
<span class="org-string">\\setromanfont [BoldFont={Gentium Basic Bold},</span>
<span class="org-string">                ItalicFont={Gentium Basic Italic}]{Gentium Plus}</span>
<span class="org-string">\\setsansfont{Charis SIL}</span>
<span class="org-string">\\setmonofont[Scale=0.8]{DejaVu Sans Mono}</span>
<span class="org-string">\\usepackage{geometry}</span>
<span class="org-string">\\geometry{a4paper, textwidth=6.5in, textheight=10in,</span>
<span class="org-string">            marginparsep=7pt, marginparwidth=.6in}</span>
<span class="org-string">\\pagestyle{empty}</span>

<span class="org-string">%% package from org-latex-default-packages-alist</span>
<span class="org-string">\\usepackage{setspace}</span>
<span class="org-string">\\onehalfspacing</span>
<span class="org-string">\\usepackage{textcomp}</span>
<span class="org-string">\\usepackage{marvosym}</span>
<span class="org-string">\\usepackage{wasysym}</span>
<span class="org-string">\\usepackage{ulem}</span>

<span class="org-string">%% \\renewcommand\\texttt[1]{{\\mint{cl}|#1|}} </span>

<span class="org-string">\\title{}</span>
<span class="org-string">      [NO-DEFAULT-PACKAGES]</span>
<span class="org-string">      [NO-PACKAGES]"</span>
               (<span class="org-string">"\\section{%s}"</span> . <span class="org-string">"\\section*{%s}"</span>)
               (<span class="org-string">"\\subsection{%s}"</span> . <span class="org-string">"\\subsection*{%s}"</span>)
               (<span class="org-string">"\\subsubsection{%s}"</span> . <span class="org-string">"\\subsubsection*{%s}"</span>)
               (<span class="org-string">"\\paragraph{%s}"</span> . <span class="org-string">"\\paragraph*{%s}"</span>)
               (<span class="org-string">"\\subparagraph{%s}"</span> . <span class="org-string">"\\subparagraph*{%s}"</span>)))
(setq org-latex-default-class <span class="org-string">"yt/org-article"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">code highlights using minted package </span>
(add-to-list 'org-latex-packages-alist '(<span class="org-string">""</span> <span class="org-string">"minted"</span>))
(setq org-latex-listings 'minted)
(setq org-latex-minted-options
      '((<span class="org-string">"frame"</span> <span class="org-string">"lines"</span>)
        (<span class="org-string">"fontsize"</span> <span class="org-string">"\\scriptsize"</span>)
        (<span class="org-string">"linenos"</span> <span class="org-string">""</span>)))
<span class="org-comment-delimiter">;;;; </span><span class="org-comment">comple pdf </span>
(setq org-latex-pdf-process
      '(<span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span class="org-string">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span><span class="org-whitespace-line">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-9-7" class="outline-4">
<h4 id="sec-4-9-7">HTML Export</h4>
<div class="outline-text-4" id="text-4-9-7">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">http://sachachua.com/blog/2014/03/emacs-tweaks-export-org-checkboxes-using-ut</span><span class="org-comment"><span class="org-whitespace-line">f-8-symbols/</span></span>
(<span class="org-keyword">defun</span> <span class="org-function-name">sacha/org-html-checkbox</span> (checkbox)
  <span class="org-doc">"Format CHECKBOX into HTML."</span>
  (case checkbox (on <span class="org-string">"&lt;span class=\"check\"&gt;&amp;#x2611;&lt;/span&gt;"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">checkbox (checke</span><span class="org-comment"><span class="org-whitespace-line">d)</span></span>
        (off <span class="org-string">"&lt;span class=\"checkbox\"&gt;&amp;#x2610;&lt;/span&gt;"</span>)
        (trans <span class="org-string">"&lt;code&gt;[-]&lt;/code&gt;"</span>)
        (t <span class="org-string">""</span>)))
(<span class="org-keyword">defadvice</span> <span class="org-function-name">org-html-checkbox</span> (around sacha activate)
  (setq ad-return-value (sacha/org-html-checkbox (ad-get-arg 0))))

(setq org-html-head
      <span class="org-string">"&lt;link rel=\"stylesheet\" type=\"text/css\"</span>
<span class="org-string">href=\"http://sachachua.com/blog/wp-content/themes/sacha-v3/foundation/css/found</span><span class="org-string"><span class="org-whitespace-line">ation.min.css\"&gt;&lt;/link&gt;</span></span>
<span class="org-string">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"http://sachachua.com/org-expor</span><span class="org-string"><span class="org-whitespace-line">t.css\"&gt;&lt;/link&gt;</span></span>
<span class="org-string">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"http://sachachua.com/blog/wp-c</span><span class="org-string"><span class="org-whitespace-line">ontent/themes/sacha-v3/style.css\"&gt;&lt;/link&gt;</span></span>
<span class="org-string">&lt;script src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js\"</span><span class="org-string"><span class="org-whitespace-line">&gt;&lt;/script&gt;"</span></span><span class="org-whitespace-line">)</span>
(setq org-html-htmlize-output-type 'css)
(setq org-src-fontify-natively t)
(setq org-html-preamble <span class="org-string">"&lt;a name=\"top\" id=\"top\"&gt;&lt;/a&gt;"</span>)
(setq org-html-postamble <span class="org-string">"</span>
<span class="org-string">&lt;style type=\"text/css\"&gt;</span>
<span class="org-string">.back-to-top {</span>
<span class="org-string">    position: fixed;</span>
<span class="org-string">    bottom: 2em;</span>
<span class="org-string">    right: 0px;</span>
<span class="org-string">    text-decoration: none;</span>
<span class="org-string">    color: #000000;</span>
<span class="org-string">    background-color: rgba(235, 235, 235, 0.80);</span>
<span class="org-string">    font-size: 12px;</span>
<span class="org-string">    padding: 1em;</span>
<span class="org-string">    display: none;</span>
<span class="org-string">}</span>
<span class="org-string">.back-to-top:hover {    </span>
<span class="org-string">    background-color: rgba(135, 135, 135, 0.50);</span>
<span class="org-string">}</span>
<span class="org-string">&lt;/style&gt;</span>
<span class="org-string">&lt;div class=\"back-to-top\"&gt;</span>
<span class="org-string">&lt;a href=\"#top\"&gt;Back to top&lt;/a&gt; | &lt;a href=\"mailto:yi.tang.uk@me.com\"&gt;E-mail m</span><span class="org-string"><span class="org-whitespace-line">e&lt;/a&gt;</span></span>
<span class="org-string">&lt;/div&gt;</span>
<span class="org-string">&lt;script type=\"text/javascript\"&gt;</span>
<span class="org-string">    var offset = 220;</span>
<span class="org-string">    var duration = 500;</span>
<span class="org-string">    jQuery(window).scroll(function() {</span>
<span class="org-string">        if (jQuery(this).scrollTop() &gt; offset) {</span>
<span class="org-string">            jQuery('.back-to-top').fadeIn(duration);</span>
<span class="org-string">        } else {</span>
<span class="org-string">            jQuery('.back-to-top').fadeOut(duration);</span>
<span class="org-string">        }</span>
<span class="org-string">    });</span>
<span class="org-string">&lt;/script&gt;"</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">Inline images in HTML instead of producting links to the image</span>
(setq org-html-inline-images t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">Do not use sub or superscripts - I currently don't need this functionality in</span><span class="org-comment"><span class="org-whitespace-line"> my documents</span></span>
(setq org-export-with-sub-superscripts t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">Export with LaTeX fragments</span>
(setq org-export-with-LaTeX-fragments t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">Increase default number of headings to export</span>
(setq org-export-headline-levels 6)
</pre>
</div>

<p>
like the fontified area for key-bindings. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq org-html-text-markup-alist
      '((bold . <span class="org-string">"&lt;b&gt;%s&lt;/b&gt;"</span>)
        (code . <span class="org-string">"&lt;kbd&gt;%s&lt;/kbd&gt;"</span>)
        (italic . <span class="org-string">"&lt;i&gt;%s&lt;/i&gt;"</span>)
        (strike-through . <span class="org-string">"&lt;del&gt;%s&lt;/del&gt;"</span>)
        (underline . <span class="org-string">"&lt;span class=\"underline\"&gt;%s&lt;/span&gt;"</span>)
        (verbatim . <span class="org-string">"&lt;code&gt;%s&lt;/code&gt;"</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-9-8" class="outline-4">
<h4 id="sec-4-9-8">Blogging with Jekyll</h4>
<div class="outline-text-4" id="text-4-9-8">
<p>
I have encountered people who wants to blog, but never start it or quit at the beigining.  I've used wordpress, online editing, and others, but never a big fan or if. because you have to learn how to write the html code, before you thinking what to write.  I think this is the reason many people quit. 
</p>

<p>
Since I've been use org-mode, and did lot of publishing work, either for client, or colluge.  I usually keep learning notes in org-mode, and sometimes want to share with otehrs, and doing it in org-mode make it less hazzord to share with others, via org-mode-publish. 
</p>

<p>
so the currenlt workflow now is:
</p>

<ol class="org-ol">
<li>keep a note

<p>
I tent to keep notes about creazy ideas I learnt, some tehnical stuff I learnt. if I feel it is necessary to share, either because there's good online material, or I think I shuold standard out and speak, for exmaple, the upcomming artile about intro to data.table in R, and few Emacs's thing.  
</p>
</li>

<li>write &amp; Edit 

<p>
for a persoal note, I always keep it short, and to the exactly out, and it also fit it the big project that I defined.  if I take it out, one may feel it lost the context.  also, writing is not only about the problem-solutiion, but mora ebout analyse the problem, convicne people etc.  I need to find reference, highlight code, add picture etc. 
</p>
</li>

<li>share 

<p>
once I feel the artiel is ready to share, I can run the <code>org-publish</code> to generate the html file.  and push it to Github Page. 
</p>
</li>

<li>Render 

<p>
currently I use Jekyll to build the site, I haven't done any research about other servei, since it is do a very good job, thereisn't necessary to find a better one, as for a blog, the most important thing is the content.
</p>
</li>
</ol>

<p>
Jeklly have few conventins, like the new, YAML etc, it is better to solve it autoamtilcally and in Emacs, as part of the export process. 
</p>


<p>
First, define a publish project, so that the exported html file will go to certail place, and we can define the styles, and other features for a praticularlly project.  but for Jeklly, it is more about to match the constraints.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">ref: http://cute-jumper.github.io/emacs/2013/10/06/orgmode-to-github-pages-wi</span><span class="org-comment"><span class="org-whitespace-line">th-jekyll/</span></span>
(setq org-publish-project-alist
      '((<span class="org-string">"MyBlog"</span> <span class="org-comment-delimiter">;; </span><span class="org-comment">settings for cute-jumper.github.io</span>
         <span class="org-builtin">:base-directory</span> <span class="org-string">"~/git/MyBlog/org"</span>
         <span class="org-builtin">:base-extension</span> <span class="org-string">"org"</span>
         <span class="org-builtin">:publishing-directory</span> <span class="org-string">"~/git/MyBlog"</span>
         <span class="org-builtin">:recursive</span> t
         <span class="org-builtin">:publishing-function</span> org-html-publish-to-html
         <span class="org-builtin">:with-toc</span> nil
         <span class="org-builtin">:headline-levels</span> 4
         <span class="org-builtin">:section-numbers</span> nil
         <span class="org-builtin">:auto-preamble</span> nil
         <span class="org-builtin">:auto-sitemap</span> nil
         <span class="org-builtin">:html-extension</span> <span class="org-string">"html"</span>
         <span class="org-builtin">:htmlized-source</span> t
         <span class="org-builtin">:body-only</span> t
         <span class="org-builtin">:with-toc</span> nil
         )))
</pre>
</div>

<p>
For managing a blog, it is good idea to keep the original org file inside of the website.  
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-directory</span> (expand-file-name <span class="org-string">"~/git/MyBlog/org/"</span>)
  <span class="org-doc">"Path to Jekyll blog."</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-drafts-dir</span> <span class="org-string">"_drafts/"</span>
  <span class="org-doc">"Relative path to drafts directory."</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-posts-dir</span> <span class="org-string">"_posts/"</span>
  <span class="org-doc">"Relative path to posts directory."</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-post-ext</span> <span class="org-string">".org"</span>
  <span class="org-doc">"File extension of Jekyll posts."</span>)
(<span class="org-keyword">defvar</span> <span class="org-variable-name">jekyll-post-template</span>
  <span class="org-string">" </span>
<span class="org-string">#+BEGIN_HTML</span>
<span class="org-string">---</span>
<span class="org-string">layout: post</span>
<span class="org-string">title: %s</span>
<span class="org-string">excerpt: </span>
<span class="org-string">categories:</span>
<span class="org-string">  -  </span>
<span class="org-string">tags:</span>
<span class="org-string">  -</span>
<span class="org-string">comments: true </span>
<span class="org-string">---</span>
<span class="org-string">#+END_HTML</span>

<span class="org-string">#+call: GetLastUpdatedDate[:exports none]()[:results org]</span>

<span class="org-string">#+TOC: headlines 4</span>
<span class="org-string">"</span>
    <span class="org-doc">"Default template for Jekyll posts. %s will be replace by the post title."</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">jekyll-make-slug</span> (s)
  <span class="org-doc">"Turn a string into a slug."</span>
  (replace-regexp-in-string
   <span class="org-string">" "</span> <span class="org-string">"-"</span> (downcase
            (replace-regexp-in-string
             <span class="org-string">"[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">A-Za-z0-9 ]"</span> <span class="org-string">""</span> s))))

(<span class="org-keyword">defun</span> <span class="org-function-name">jekyll-yaml-escape</span> (s)
  <span class="org-doc">"Escape a string for YAML."</span>
  (<span class="org-keyword">if</span> (or (string-match <span class="org-string">":"</span> s)
        2  (string-match <span class="org-string">"\""</span> s))
      (concat <span class="org-string">"\""</span> (replace-regexp-in-string <span class="org-string">"\""</span> <span class="org-string">"\\\\\""</span> s) <span class="org-string">"\""</span>)
    s))

(<span class="org-keyword">defun</span> <span class="org-function-name">blog-draft-post</span> (title)
  <span class="org-doc">"Create a new Jekyll blog post."</span>
  (interactive <span class="org-string">"sPost Title: "</span>)
  (<span class="org-keyword">let</span> ((draft-file (concat jekyll-directory jekyll-drafts-dir
                            (jekyll-make-slug title)
                            jekyll-post-ext)))
    (<span class="org-keyword">if</span> (file-exists-p draft-file)
        (find-file draft-file)
      (find-file draft-file)
      (insert (format jekyll-post-template (jekyll-yaml-escape title))))))

(<span class="org-keyword">defun</span> <span class="org-function-name">blog-publish-post</span> ()
  <span class="org-doc">"Move a draft post to the posts directory, and rename it so that it</span>
<span class="org-doc"> contains the date."</span>
  (interactive)
  (<span class="org-keyword">cond</span>
   ((not (equal
          (file-name-directory (buffer-file-name (current-buffer)))
          (concat jekyll-directory jekyll-drafts-dir)))
    (message <span class="org-string">"This is not a draft post."</span>))
   ((buffer-modified-p)
    (message <span class="org-string">"Can't publish post; buffer has modifications."</span>))
   (t
    (<span class="org-keyword">let</span> ((filename
           (concat jekyll-directory jekyll-posts-dir
                   (format-time-string <span class="org-string">"%Y-%m-%d-"</span>)
                   (file-name-nondirectory
                    (buffer-file-name (current-buffer)))))
          (old-point (point)))
      (rename-file (buffer-file-name (current-buffer))
                   filename)
      (kill-buffer nil)
      (find-file filename)
      (set-window-point (selected-window) old-point)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">org-jekyll-post-link-follow</span> (path)
  (org-open-file-with-emacs path))

(<span class="org-keyword">defun</span> <span class="org-function-name">org-jekyll-post-link-export</span> (path desc format)
  (<span class="org-keyword">cond</span>
   ((eq format 'html)
    (format <span class="org-string">"&lt;a href=\"{%% post_url %s %%}\"&gt;%s&lt;/a&gt;"</span> path desc))))

(org-add-link-type <span class="org-string">"jekyll-post"</span> 'org-jekyll-post-link-follow 'org-jekyll-post-l<span class="org-whitespace-line">ink-export)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Improve our blogging experience with Org-Jekyll. This code sets four</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">functions with corresponding key bindings:</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j n - Create new draft</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j P - Post current draft</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j d - Show all drafts</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">C-c j p - Show all posts</span>
<span class="org-comment-delimiter">;;</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Once a draft has been posted (i.e., moved from the _drafts</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">directory to _post with the required date prefix in the filename), we</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">then need to html-export it to the jekyll rootdir (with org-publish).</span>

(global-set-key (kbd <span class="org-string">"C-c j n"</span>) 'blog-draft-post)
(global-set-key (kbd <span class="org-string">"C-c j P"</span>) 'blog-publish-post)
(global-set-key (kbd <span class="org-string">"C-c j p"</span>) (<span class="org-keyword">lambda</span> ()
                                  (interactive)
                                  (find-file <span class="org-string">"~/git/MyBlog/org/_posts/"</span>)))
(global-set-key (kbd <span class="org-string">"C-c j d"</span>) (<span class="org-keyword">lambda</span> ()
                                  (interactive)
                                  (find-file <span class="org-string">"~/git/MyBlog/org/_drafts/"</span>)))
</pre>
</div>
</div>



<div id="outline-container-sec-4-9-8-1" class="outline-5">
<h5 id="sec-4-9-8-1">code highlight</h5>
<div class="outline-text-5" id="text-4-9-8-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-to-jekyll-src</span> (lang)
  <span class="org-doc">" change src block heading to {% highlight %} "</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(with-temp-buffer</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(insert-file "current buffer name")</span>
  (interactive)
  (goto-char (point-min))
  (<span class="org-keyword">while</span> (not (eobp))
    (forward-line 1)
    (<span class="org-keyword">cond</span>
     ((looking-at (concat <span class="org-string">"^#\\+BEGIN_SRC "</span> lang <span class="org-string">".*$"</span>))
      (goto-char (match-beginning 0))
      (kill-line)
      (insert <span class="org-string">"#+begin_html\n"</span>)
      (insert (concat <span class="org-string">"{% highlight "</span> lang <span class="org-string">" %}"</span>)))
     ((looking-at <span class="org-string">"^#\\+END_SRC"</span>)
      (goto-char (match-beginning 0))
      (kill-line)
      (insert <span class="org-string">"{% endhighlight %}\n"</span>)
      (insert <span class="org-string">"\#+end_html"</span>)))))
(<span class="org-keyword">defun</span> <span class="org-function-name">jekyll-highlight-converter</span> ()
  <span class="org-doc">"use jekyll highlight style"</span>
  (interactive)
  (org-to-jekyll-src <span class="org-string">"R"</span>)
  (org-to-jekyll-src <span class="org-string">"C++"</span>)
  (org-to-jekyll-src <span class="org-string">"emacs-lisp"</span>)
  (org-to-jekyll-src <span class="org-string">"CSS"</span>)
  (org-to-jekyll-src <span class="org-string">"html"</span>)
  )
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-9-8-2" class="outline-5">
<h5 id="sec-4-9-8-2">Path Issues</h5>
<div class="outline-text-5" id="text-4-9-8-2">
<p>
When publishing, the org-file is firstly exported to html file, and when Jekyll build the website, the html file will be saved in to some folder that depends on the YMAL. Then the relative path to image files are broken. To solve that, according to the Jeklyy web site, is to save all the image or downloade files in assets/ folder.  Then those image files are referende by org-mode. 
</p>

<p>
First, define a img link, that when exporting, the image a_img.png will be set to linked to /assets/a_img.png. when I click, it wil open the img file in Emacs.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">org-custom-link-img-follow</span> (path)
  (org-open-file-with-emacs
   (format <span class="org-string">"../../assets/%s"</span> path)))

(<span class="org-keyword">defun</span> <span class="org-function-name">org-custom-link-img-export</span> (path desc format)
  (<span class="org-keyword">cond</span>
   ((eq format 'html)
    (format <span class="org-string">"&lt;img src=\"/assets/%s\" alt=\"%s\"/&gt;"</span> path desc))))

(org-add-link-type <span class="org-string">"img"</span> 'org-custom-link-img-follow 'org-custom-link-img-export<span class="org-whitespace-line">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4-10" class="outline-3">
<h3 id="sec-4-10">mu4e - Email Client</h3>
<div class="outline-text-3" id="text-4-10">
<p>
The advantage of use Emacs as an email client: 
</p>

<ol class="org-ol">
<li>communication happens at the point where the content is genreated. 
as a statisician/programmer, most likely I need to mmunicate with numbers, table, graphs, or snippet.  I could just copy these results from to email, do an quickly editing.  
</li>
<li>HTML email with CSS style.  
I like to formate my email use headingline, fonts, and highlhgit the code, I used to be write a report in Word/LatEx and write an email with only onbe line, please see the attachment.  which I don't like. 
</li>
<li>search properly 
I use search all the time, and this functionality is not working at all in outlkooik 2013, it also shows up random info (mail.app in osx did a great job).  
</li>
</ol>

<p>
Disadvantage / can;t do: 
</p>
<ol class="org-ol">
<li>don't expect me to reply immediately 
this is how does it works: 1. download the email from server, 2) index with head, body, attachment, user name etc.  3) Emacs talk to and show in GUI.  I usually update the meail about 30 imnutes.  but I helps me out of disrupts.
</li>
<li>book Meeting/Appointment 
I didn't aware that you can do it in emacs, and we need an iterative way to do.  Outlook Schedule Asistant do a good job, it list agenda of all attendence, and I could spot oen time slot that suit for all or most people. 
</li>
<li>calendar 
I don't know how to integrate Office 365 calendar with Org-mode calandar yet.  even it can, I doubt I can download and see other people's agenda.
</li>
</ol>


<p>
<b>Usage</b> 
</p>

<dl class="org-dl">
<dt> attachment </dt><dd>move the point to end of message buffer, <kbd>C-c C-a</kbd>, to add attachment. 
</dd>
<dt> narrow down messages </dt><dd><kbd>/</kbd> to start query,
<dl class="org-dl">
<dt> from someone </dt><dd>from:Yi
</dd>
<dt> with attachment </dt><dd>flag:attach
</dd>
<dt> priority  </dt><dd>prior:high or prior:low 
</dd>
</dl>
</dd>
</dl>

<p>
This setting need two programms to work: 1) mu, 2) offlineimap. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">usage:</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">$ offlineimap</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">$ mu index</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-x mu4e</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">from mu's official manual </span>
<span class="org-comment-delimiter">;;</span><span class="org-comment">----------------------------------------------------------</span>
(add-to-list 'load-path <span class="org-string">"~/git/.emacs.d/elpa/mu4e"</span>)
(<span class="org-keyword">require</span> '<span class="org-constant">mu4e</span>)
(setq mu4e-mu-binary <span class="org-string">"/usr/local/bin/mu"</span>)
<span class="org-comment-delimiter">;; </span><span class="org-comment">default</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">don't save message to Sent Messages, Gmail/IMAP takes care of this</span>
(setq mu4e-sent-messages-behavior 'sent)

<span class="org-comment-delimiter">;; </span><span class="org-comment">allow for updating mail using 'U' in the main view:</span>
(setq mu4e-get-mail-command <span class="org-string">"offlineimap -a JBA"</span>)
(setq mu4e-update-interval 300)

<span class="org-comment-delimiter">;; </span><span class="org-comment">sending mail -- replace USERNAME with your gmail username</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">also, make sure the gnutls command line utils are installed</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">package 'gnutls-bin' in Debian/Ubuntu</span>
(setq smtpmail-default-smtp-server <span class="org-string">"smtpserver"</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">needs to be specified before </span><span class="org-comment"><span class="org-whitespace-line">the (require)</span></span>
(<span class="org-keyword">require</span> '<span class="org-constant">smtpmail</span>)


<span class="org-comment-delimiter">;; </span><span class="org-comment">don't keep message buffers around</span>
(setq message-kill-buffer-on-exit t)


<span class="org-comment-delimiter">;; </span><span class="org-comment">attempt to show images when viewing messages</span>
(setq mu4e-view-show-images t
      mu4e-show-images t
      mu4e-view-image-max-width 800)


(setq mu4e-html2text-command <span class="org-string">"html2text -utf8 -width 72"</span>) <span class="org-comment-delimiter">;; </span><span class="org-comment">nil "Shel command t</span><span class="org-comment"><span class="org-whitespace-line">hat converts HTML</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">yt</span>
(setq mu4e-view-prefer-html t) <span class="org-comment-delimiter">;; </span><span class="org-comment">try to render </span>
(add-to-list 'mu4e-view-actions 
             '(<span class="org-string">"ViewInBrowser"</span> . mu4e-action-view-in-browser) t) <span class="org-comment-delimiter">;; </span><span class="org-comment">read in brow</span><span class="org-comment"><span class="org-whitespace-line">ser </span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">mu4e as default email agent in emacs</span>
(setq mail-user-agent 'mu4e-user-agent)
(<span class="org-keyword">require</span> '<span class="org-constant">org-mu4e</span>)
                                        <span class="org-comment-delimiter">;</span><span class="org-comment">== M-x org-mu4e-compose-org-mode==</span>
(setq org-mu4e-convert-to-html t) <span class="org-comment-delimiter">;; </span><span class="org-comment">org -&gt; html</span>
                                        <span class="org-comment-delimiter">; </span><span class="org-comment">= M-m C-c.= </span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">give me ISO(ish) format date-time stamps in the header list</span>
(setq  mu4e-headers-date-format <span class="org-string">"%Y-%m-%d %H:%M"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">customize the reply-quote-string</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">M-x find-function RET message-citation-line-format for docs</span>
(setq message-citation-line-format <span class="org-string">"%N @ %Y-%m-%d %H:%M %Z:\n"</span>)
(setq message-citation-line-function 'message-insert-formatted-citation-line)

<span class="org-comment-delimiter">;; </span><span class="org-comment">the headers to show in the headers list -- a pair of a field</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">and its width, with `</span><span class="org-comment"><span class="org-constant">nil</span></span><span class="org-comment">' meaning 'unlimited'</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(better only use that for the last field.</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">These are the defaults:</span>
(setq mu4e-headers-fields
    '( (<span class="org-builtin">:date</span>          .  25)
       (<span class="org-builtin">:flags</span>         .   6)
       (<span class="org-builtin">:from</span>          .  22)
       (<span class="org-builtin">:subject</span>       .  nil)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">don't keep message buffers around</span>
(setq message-kill-buffer-on-exit t)
<span class="org-comment-delimiter">;; </span><span class="org-comment">attachments go here</span>
(setq mu4e-attachment-dir  <span class="org-string">"~/Downloads"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">should mu4e use fancy utf characters? NO. they're ugly.</span>
<span class="org-comment-delimiter">;;</span><span class="org-comment">(setq mu4e-use-fancy-chars 't)</span>
</pre>
</div>
</div>


<div id="outline-container-sec-4-10-1" class="outline-4">
<h4 id="sec-4-10-1">Account</h4>
<div class="outline-text-4" id="text-4-10-1">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-23 Fri 17:32]</span></span>
set up email account, use office 365 in the office, and iCloud at macbook por. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;;</span>

(setq  mu4e-maildir-shortcuts  '((<span class="org-string">"/JBA/INBOX"</span>    . ?j)
                          (<span class="org-string">"/iCloud/INBOX"</span> . ?i)
                          (<span class="org-string">"/Gmail/INBOX"</span> . ?g)
                          (<span class="org-string">"/Sent Items"</span>   . ?s)
                          (<span class="org-string">"/Trash"</span>        . ?t)
                          (<span class="org-string">"/All Mail"</span>     . ?a)))


(<span class="org-keyword">defun</span> <span class="org-function-name">yt/email-jba</span> ()
  (interactive)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">setup for smtp </span>
  (setq message-send-mail-function 'smtpmail-send-it
        smtpmail-stream-type 'starttls
        smtpmail-default-smtp-server <span class="org-string">"smtp.office365.com"</span>
        smtpmail-smtp-server <span class="org-string">"smtp.office365.com"</span>
        smtpmail-smtp-service 587
        smtpmail-smtp-user <span class="org-string">"yi.tang@jbarisk.com"</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">account info </span>
        user-mail-address <span class="org-string">"yi.tang@jbarisk.com"</span>
        user-full-name  <span class="org-string">"Yi Tang"</span>
        <span class="org-comment-delimiter">;; </span><span class="org-comment">mu4e </span>
        mu4e-drafts-folder <span class="org-string">"/JBA/Drafts"</span>
        mu4e-sent-folder   <span class="org-string">"/JBA/Sent Items"</span>
        mu4e-trash-folder  <span class="org-string">"/JBA/Trash"</span>
        mu4e-maildir-shortcuts  '((<span class="org-string">"/JBA/INBOX"</span>    . ?i)
                                  (<span class="org-string">"/Sent Items"</span>   . ?s)
                                  (<span class="org-string">"/Trash"</span>        . ?t)
                                  (<span class="org-string">"/All Mail"</span>     . ?a))
        mu4e-compose-signature (concat
                                <span class="org-string">"Yi Tang\n"</span>
                                <span class="org-string">"Statistician\n"</span>
                                <span class="org-string">"T: +44 (0) 1756 799919\n"</span>)))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/email-icloud</span> ()
  (setq  <span class="org-comment-delimiter">;; </span><span class="org-comment">account info</span>
   user-mail-address <span class="org-string">"yi.tang.uk@me.com"</span>
   user-full-name  <span class="org-string">"Yi Tang"</span>
   message-send-mail-function 'smtpmail-send-it
   smtpmail-stream-type 'starttls
   smtpmail-default-smtp-server <span class="org-string">"smtp.mail.me.com"</span>
   smtpmail-smtp-server <span class="org-string">"smtp.mail.me.com"</span>
   smtpmail-smtp-service 587
   smtpmail-smtp-user <span class="org-string">"yi.tang.uk@me.com"</span>
   mu4e-maildir <span class="org-string">"~/Maildir"</span>
   mu4e-drafts-folder <span class="org-string">"/iCloud/Drafts"</span>
   mu4e-sent-folder   <span class="org-string">"/iCloud/Sent Messages"</span>
   mu4e-trash-folder  <span class="org-string">"/iCloud/Deleted Messages"</span>

   mu4e-maildir-shortcuts  '((<span class="org-string">"/iCloud/INBOX"</span>    . ?i)
                             (<span class="org-string">"/Sent Items"</span>   . ?s)
                             (<span class="org-string">"/Trash"</span>        . ?t)
                             (<span class="org-string">"/All Mail"</span>     . ?a))


   mu4e-compose-signature (concat
                           <span class="org-string">"&#21776;&#27589; (Yi Tang)\n"</span>
                           <span class="org-string">"Email: yi.tang.uk@me.com\n"</span>
                           <span class="org-string">"\n"</span>)))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/email-gmail</span> ()

  <span class="org-comment-delimiter">;; </span><span class="org-comment">sent emails </span>
  (setq message-send-mail-function 'smtpmail-send-it
        starttls-use-gnutls t
        smtpmail-starttls-credentials '((<span class="org-string">"smtp.gmail.com"</span> 587 nil nil))
        <span class="org-comment-delimiter">;; </span><span class="org-comment">smtpmail-auth-credentials</span>
        <span class="org-comment-delimiter">;;   </span><span class="org-comment">'(("smtp.gmail.com" 587 "yi.tang.uni@gmail.com" nil))</span>
        smtpmail-default-smtp-server <span class="org-string">"smtp.gmail.com"</span>
        smtpmail-smtp-server <span class="org-string">"smtp.gmail.com"</span>
        smtpmail-smtp-service 587
        smtpmail-smtp-user <span class="org-string">"yi.tang.uni@gmail.com"</span>)



  (setq user-mail-address <span class="org-string">"yi.tang.uni@gmail.com"</span> )
  (setq user-full-name  <span class="org-string">"Yi Tang"</span> )
  (setq mu4e-drafts-folder <span class="org-string">"/Gmail/Drafts"</span> )
  (setq mu4e-sent-folder   <span class="org-string">"/Gmail/Sent Items"</span> )
  (setq mu4e-trash-folder  <span class="org-string">"/Gmail/Trash"</span> )
  (setq mu4e-maildir-shortcuts  '((<span class="org-string">"/Gmail/INBOX"</span>    . ?i) 
                                  (<span class="org-string">"/Sent Items"</span>   . ?s)
                                  (<span class="org-string">"/Trash"</span>        . ?t)
                                  (<span class="org-string">"/All Mail"</span>     . ?a)))
  (setq mu4e-compose-signature (concat
                                <span class="org-string">"Yi Tang\n"</span>
                                <span class="org-string">"Statistician\n"</span>
                                <span class="org-string">"T: 07445510033\n"</span>)))




(<span class="org-keyword">defun</span> <span class="org-function-name">yt/mu4e-jba</span> ()
  (interactive)
  (yt/email-jba)
  (mu4e)
  )
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/mu4e-gmail</span>()
  (interactive)
  (yt/email-gmail)
  (mu4e))
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/mu4e-icloud</span>()
  (interactive)
  (yt/email-icloud)
  (mu4e))

(defhydra hydra-email (<span class="org-builtin">:color</span> blue <span class="org-builtin">:hint</span> nil)
  <span class="org-string">"</span>
<span class="org-string">Mu4e: _g_mail _j_ba _i_Cloud"</span>
  (<span class="org-string">"g"</span> yt/mu4e-gmail)
  (<span class="org-string">"j"</span> yt/mu4e-jba)
  (<span class="org-string">"i"</span> yt/mu4e-icloud))
(global-set-key [f2] 'hydra-email/body)
</pre>
</div>

<p>
when I sent an email, it will promote and ask for email, I only need type once per Emacs session, also, I can save the password to an <i>.authoty</i> file. 
</p>
</div>
</div>
<div id="outline-container-sec-4-10-2" class="outline-4">
<h4 id="sec-4-10-2">Contacts</h4>
<div class="outline-text-4" id="text-4-10-2">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-01-23 Fri 17:28]</span></span>
have problem with BBDB installtion, and use org-contact.el to manage contact.  add contactor very easy. I cna use tab to completet contacts, which is really handy.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">org-contacts</span>)
(setq mu4e-org-contacts-file  <span class="org-string">"~/git/org/contacts.org"</span>)
(add-to-list 'mu4e-headers-actions
             '(<span class="org-string">"org-contact-add"</span> . mu4e-action-add-org-contact) t)
(add-to-list 'mu4e-view-actions
             '(<span class="org-string">"org-contact-add"</span> . mu4e-action-add-org-contact) t)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-10-3" class="outline-4">
<h4 id="sec-4-10-3">Workflow</h4>
<div class="outline-text-4" id="text-4-10-3">
<p>

</p>

<p>
I am trying to avoid use <code>C-x m</code> to write/sent email directy, unless it is really short. otherwise, if it relates to a project, I will make an org headline to keep track the project communciation, to do that,  I compose email/message in org mode, then sent the whole subtree by <code>C-c M-o</code>.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;;;; </span><span class="org-comment">[2015-01-14 Wed 22:32]</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">org-mime</span>
(<span class="org-keyword">require</span> '<span class="org-constant">org-mime</span>)
(setq org-mime-library 'mml)
(add-hook 'message-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (local-set-key <span class="org-string">"\C-c\M-o"</span> 'org-mime-htmlize)))
(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (local-set-key <span class="org-string">"\C-c\M-o"</span> 'org-mime-org-buffer-htmlize)))
(add-hook 'org-mime-html-hook
          (<span class="org-keyword">lambda</span> ()
            (insert-file-contents <span class="org-string">"~/git/.emacs.d/style/office.css"</span>)
            <span class="org-comment-delimiter">;; </span><span class="org-comment">(goto-char 5)</span>
            )
          t)


(add-hook 'org-mode-hook
          (<span class="org-keyword">lambda</span> ()
            (local-set-key (kbd <span class="org-string">"C-c M-o"</span>) 'org-mime-subtree))
          'append)
</pre>
</div>

<p>
just in case I didn't get the format right at the first place and need some quick fix in message mode, save me few seconds in going back to org-mode.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-hook 'message-mode-hook 'orgstruct++-mode 'append)
(add-hook 'message-mode-hook 'turn-on-auto-fill 'append)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-mode-hook 'bbdb-define-all-aliases 'append)</span>
(add-hook 'message-mode-hook 'orgtbl-mode 'append)
(add-hook 'message-mode-hook 'turn-on-flyspell 'append)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(add-hook 'message-mode-hook</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'(lambda () (setq fill-column 270))</span>
<span class="org-comment-delimiter">;;           </span><span class="org-comment">'append)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-10-4" class="outline-4">
<h4 id="sec-4-10-4"><span class="todo TODO">TODO</span> Comprehensive Email</h4>
<div class="outline-text-4" id="text-4-10-4">
<p>

</p>

<p>
<b>Attach and Inline Image</b> 
I got an email from an estate agency where there are few images are inlined, but also in the attachment.  why not just save the attachment online and inline the image as a normal HTML do? 
</p>

<ol class="org-ol">
<li>add an png attachment, display it as inline image.  
</li>
</ol>

<p>
<b>Render LaTeX code as image</b>
currently it is broken.  the error message is the path issues, and seems the file is not generated. 
</p>
</div>
</div>
</div>


<div id="outline-container-sec-4-11" class="outline-3">
<h3 id="sec-4-11">Refile</h3>
<div class="outline-text-3" id="text-4-11">
<p>
hydra 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">hydra</span>)
(defhydra hydra-zoom (global-map <span class="org-string">"&lt;f2&gt;"</span>)
  <span class="org-string">"zoom"</span>
  (<span class="org-string">"g"</span> text-scale-increase <span class="org-string">"in"</span>)
  (<span class="org-string">"l"</span> text-scale-decrease <span class="org-string">"out"</span>))

(defhydra hydra-search (<span class="org-builtin">:color</span> blue
                               <span class="org-builtin">:hint</span> nil)
  <span class="org-string">"</span>
<span class="org-string">Current Buffer   : _i_search helm-_s_woop _a_ce-jump-word </span>
<span class="org-string">Multiple Buffers : helm-multi-_S_woop </span>
<span class="org-string">Project Directory: projectile-_g_rep  helm-projectile-_G_rep</span>
<span class="org-string">"</span>
  (<span class="org-string">"i"</span> isearch-forward)
  (<span class="org-string">"s"</span> helm-swoop)
  (<span class="org-string">"a"</span> ace-jump-word-mode)
  (<span class="org-string">"S"</span> helm-multi-swoop)
  (<span class="org-string">"g"</span> projectile-grep)
  (<span class="org-string">"G"</span> helm-projectile-grep))
(global-set-key [f5] 'hydra-search/body)
</pre>
</div>


<p>
voca-builde 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">require</span> '<span class="org-constant">voca-builder</span>)
(setq voca-builder/voca-file <span class="org-string">"~/.vocabulary.org"</span>)
(setq voca-builder/current-tag <span class="org-string">"WinFriend"</span>)
(global-set-key (kbd <span class="org-string">"&lt;f4&gt;"</span>) 'voca-builder/search-popup)
(setq sentence-end-double-space nil)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(olivetti-mode)
</pre>
</div>


<p>
weather forcasting 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">sunshine: weather forcaste service</span>
(setq sunshine-units 'metric)
(setq sunshine-location <span class="org-string">"Keighley, GB"</span>)
</pre>
</div>

<p>
automatically back-up keyfreq 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">yt/daily-back-keyfreq</span> ()
  <span class="org-doc">"back up .emacs.keyfreq file.</span>
<span class="org-doc">Move it to ~/git/.emacs.d/keyfreq with file name being the date and machine"</span>
  (interactive)
  (<span class="org-keyword">let*</span> ((place (<span class="org-keyword">if</span> (string= system-name <span class="org-string">"mbp.local"</span>)
                    <span class="org-string">"mac"</span>
                  <span class="org-string">"ubuntu"</span>))
         (file-name (concat (format-time-string <span class="org-string">"%F"</span>)
                            <span class="org-string">"-"</span>
                            place)))
    (<span class="org-keyword">if</span> (yes-or-no-p (concat <span class="org-string">"will move .emacs.keyfreq to "</span> file-name))
        (shell-command (concat <span class="org-string">"cd ~/git/.emacs.d/keyfreq/; mv ~/.emacs.keyfreq </span><span class="org-string"><span class="org-whitespace-line">"</span></span><span class="org-whitespace-line"> file-name)) </span>
      <span class="org-string">"do nothing"</span>)
    ))
</pre>
</div>
</div>
<div id="outline-container-sec-4-11-1" class="outline-4">
<h4 id="sec-4-11-1">open stree map</h4>
<div class="outline-text-4" id="text-4-11-1">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span class="org-keyword">defun</span> <span class="org-function-name">omap_bbox</span> (minlon minlat maxlon maxlat)
  <span class="org-doc">"generate to hyperlink and also view an area in openstreemap.  </span>
<span class="org-doc">the area is defined by the bounding box. "</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
  (<span class="org-keyword">let</span> ((address (concat  <span class="org-string">"http://www.openstreetmap.org/?"</span>
           <span class="org-string">"minlon="</span> (number-to-string minlon) <span class="org-string">"&amp;"</span>
           <span class="org-string">"minlat="</span> (number-to-string minlat) <span class="org-string">"&amp;"</span>
           <span class="org-string">"maxlon="</span> (number-to-string maxlon) <span class="org-string">"&amp;"</span>
           <span class="org-string">"maxlat="</span> (number-to-string maxlat) <span class="org-string">"&amp;"</span>)))
    (browse-url address)
    (kill-new address)))


(<span class="org-keyword">defun</span> <span class="org-function-name">omap_point</span> (lon lat)
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  (<span class="org-keyword">let</span> ((address (concat  <span class="org-string">"http://www.openstreetmap.org/?"</span>
                          <span class="org-string">"mlat="</span> (number-to-string lat) <span class="org-string">"&amp;"</span>
                          <span class="org-string">"mlon="</span> (number-to-string lon))))
    (browse-url address)
    (kill-new address)))

(<span class="org-keyword">defun</span> <span class="org-function-name">omap_site</span> (site)
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  (<span class="org-keyword">let</span> ((address (concat <span class="org-string">"http://nominatim.openstreetmap.org/search.php?q="</span> site<span class="org-whitespace-line">)))</span>
    (browse-url address)
    (kill-new address)))

(<span class="org-keyword">defun</span> <span class="org-function-name">omap</span> (arg)
<span class="org-comment-delimiter">;;  </span><span class="org-comment">(interactive)</span>
  (<span class="org-keyword">cond</span> ((= 1 (length arg))
         (omap_site (nth 0 arg)))
        ((= 2 (length arg))
         (omap_point (nth 0 arg) (nth 1 arg)))
        ((= 4 (length arg))
         (omap_bbox (nth 0 arg)
                     (nth 1 arg)
                     (nth 2 arg)
                     (nth 3 arg)))
        (t <span class="org-string">"nope"</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '(-0.489 51.28 0.236 51.686)) ;; london area</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.openstreetmap.org/?minlon=-0.489&amp;minlat=51.28&amp;maxlon=0.236&amp;maxlat=</span><span class="org-comment"><span class="org-whitespace-line">51.686&amp;</span></span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '(-76.3412 38.6710)) ;; New york </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://www.openstreetmap.org/?mlat=38.671&amp;mlon=-76.3412</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(omap '("UK"))  ;; UK, obvs </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">http://nominatim.openstreetmap.org/search.php?q=UK</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4-12" class="outline-3">
<h3 id="sec-4-12">Git-Report</h3>
<div class="outline-text-3" id="text-4-12">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yt/git-repo-info ()</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(let* ((sh-num-unpushed-commits "git status | grep \"\'origin/master\'\" | </span><span class="org-comment"><span class="org-whitespace-line">grep -Po \"[0-9]\"")</span></span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(sh-num-uncommited-files "git status --porcelain 2&gt;/dev/null| egrep \"^</span><span class="org-comment"><span class="org-whitespace-line">(M| M)\" | wc -l")</span></span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(unpush (shell-command-to-string sh-num-unpushed-commits))</span>
<span class="org-comment-delimiter">;;       </span><span class="org-comment">(uncommit (shell-command-to-string sh-num-uncommited-files)))</span>
<span class="org-comment-delimiter">;;     </span><span class="org-comment">(concat "unpushed commits: " unpush "\n" "uncommited files: " uncommit)))</span>

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-check-repo-update</span> (path)
  (interactive)
  (<span class="org-keyword">let*</span> ((git-cmd <span class="org-string">"git status | grep clean"</span>)
         (sh-cmd (concat <span class="org-string">"cd "</span> path <span class="org-string">"; "</span> git-cmd))
         (sh-result (shell-command-to-string sh-cmd))
         (is-git-repo (not (string= <span class="org-string">"fatal: Not a git repository (or any of the </span><span class="org-string"><span class="org-whitespace-line">parent directories): .git\n"</span></span>
                                  sh-result)))
         (repo-clean-p (string= <span class="org-string">"nothing to commit, working directory clean\n"</span>
                                sh-result)))
    (<span class="org-keyword">cond</span> ((not is-git-repo)
           (concat path <span class="org-string">" is not a git repo"</span>))
          (repo-clean-p
           (concat path <span class="org-string">" is clean"</span>))
          (t
           (concat path <span class="org-string">" is dirty"</span>)))))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-status-report</span> (repo-list)
  (interactive)
  (<span class="org-keyword">let</span> ((repo-status (mapconcat 'yt/git-check-repo-update repo-list <span class="org-string">"\n"</span>)))
    repo-status))


(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-status-report-org-mode</span> (repo-list)
  (interactive)
  (<span class="org-keyword">let</span> ((repo-status (mapcar 'yt/git-check-repo-update-return-list repo-list))) <span class="org-whitespace-line">   </span>
    repo-status))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-check-repo-update-return-list</span> (path)
  (<span class="org-keyword">let*</span> ((status (yt/git-check-repo-update path))
         (status (car (cdr (split-string status <span class="org-string">" is "</span>))))
         (magit-link 
          (<span class="org-keyword">if</span> (string= <span class="org-string">"not a git repo"</span> status)
              <span class="org-string">" "</span>
            (concat <span class="org-string">"[[magit:"</span> path <span class="org-string">"]]"</span>))))
    (list path
          status
          magit-link)))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/list-to-org-table</span> (a-list)
  (<span class="org-keyword">let</span> ((a-list-string (mapconcat 'identity a-list <span class="org-string">" | "</span>))) <span class="org-comment-delimiter">;; </span><span class="org-comment">use | to separate</span><span class="org-comment"><span class="org-whitespace-line"> each item</span></span>
    (concat <span class="org-string">"| "</span> a-list-string <span class="org-string">" |"</span> <span class="org-string">"\n"</span>)))

(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-check-repo-update-org-table</span> (repo-list)
  (<span class="org-keyword">let*</span> ((status-list (mapcar 'yt/git-check-repo-update-return-list repo-list))
        (status-table (mapcar 'yt/list-to-org-table status-list))
        (status-table-string (mapconcat 'identity status-table <span class="org-string">" "</span>))
        (table-header <span class="org-string">"| repo | status | magit |\n"</span>))
    (concat table-header <span class="org-string">" "</span> status-table-string)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">from https://lists.gnu.org/archive/html/emacs-orgmode/2009-08/msg00460.html</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">magit link in org-mode </span>
(<span class="org-keyword">defun</span> <span class="org-function-name">org-magit-store-link</span> ()
  <span class="org-doc">"Store a link to a directory to open with magit."</span>
  (<span class="org-keyword">when</span> (eq major-mode 'magit-mode)
    (<span class="org-keyword">let*</span> ((dir default-directory)
           (link (org-make-link <span class="org-string">"magit:"</span> dir))
           (desc (abbreviate-file-name dir)))
      (org-store-link-props <span class="org-builtin">:type</span> <span class="org-string">"magit"</span> <span class="org-builtin">:link</span> link <span class="org-builtin">:description</span> desc)
      link)))
(<span class="org-keyword">defun</span> <span class="org-function-name">org-magit-open</span> (dir)
  <span class="org-doc">"Follow a magit link to DIR."</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">magit</span>)
  (magit-status dir))
(org-add-link-type <span class="org-string">"magit"</span> 'org-magit-open nil)
(add-hook 'org-store-link-functions 'org-magit-store-link)



(<span class="org-keyword">require</span> '<span class="org-constant">f</span>)
(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-all-git-dir</span> (git-base-dir)
  (f-directories <span class="org-string">"~/git"</span>
                 '(<span class="org-keyword">lambda</span> (arg)
                    (<span class="org-keyword">let*</span> ((f (directory-files arg))
                           (f-string (format <span class="org-string">"%s"</span> f)))
                      (<span class="org-keyword">if</span> (string-match <span class="org-string">"\\.git"</span> f-string)
                          t
                        nil)))
                 t))


(<span class="org-keyword">defun</span> <span class="org-function-name">yt/git-generate-report</span> ()
  (interactive)
  (<span class="org-keyword">let</span>  ((git-report (yt/git-check-repo-update-org-table repo-list)))
    (<span class="org-keyword">with-temp-buffer</span>
      (insert (format <span class="org-string">"%s"</span> git-report))
      (write-region (point-min) (point-max) git-report-temp-file)
      )
    (find-file git-report-temp-file)
    (goto-char (+ 1 (point-min)))
    (org-mode)
    (org-ctrl-c-ret)
    (previous-line 2)
    (search-forward <span class="org-string">"status"</span>)
    (next-line 2)
    <span class="org-comment-delimiter">;; </span><span class="org-comment">(setq current-prefix-arg '(4)) ; C-u</span>
    (org-table-sort-lines t ?a)
    )
  )


(setq git-report-temp-file <span class="org-string">"~/git-report-buffer"</span>)
(setq repo-list (yt/git-all-git-dir <span class="org-string">"~/git"</span>))
<span class="org-comment-delimiter">;; </span><span class="org-comment">(yt/git-generate-report)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-13" class="outline-3">
<h3 id="sec-4-13">Office Setting</h3>
<div class="outline-text-3" id="text-4-13">
<p>
<span class="timestamp-wrapper"><span class="timestamp">[2015-03-18 Wed 18:32]</span></span>
In the office, I have differnet settings for 
</p>

<ol class="org-ol">
<li>org-agenda files 
</li>
<li>org-capture-templates,
</li>
<li>org-html-export 
</li>
</ol>

<p>
In my office Ubuntu machine, set a variable WhereAmI to Office, then the setting will be done automatically.  wrap all the settings in the <code>my/all-office-settings</code> function for I can call it explicity when I work on my Mac. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(setq WhereAmI "Office") ;; set this variable in ~/.emacs</span>
(<span class="org-keyword">defun</span> <span class="org-function-name">my/office-org-agenda-file</span> ()
  (setq org-agenda-files '(<span class="org-string">"~/git/jbarm"</span> )))

(<span class="org-keyword">defun</span> <span class="org-function-name">my/office-org-capture-temp</span> ()
  (setq org-capture-templates
        (quote ((<span class="org-string">"t"</span> <span class="org-string">"todo"</span> entry (file <span class="org-string">"~/git/jbarm/re_org_refile.org"</span>)
                 <span class="org-string">"* TODO %?\nSCHEDULED:%t \n %U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t) <span class="org-comment-delimiter"><span class="org-whitespace-line">;; </span></span><span class="org-warning"><span class="org-whitespace-line">TODO</span></span><span class="org-comment"><span class="org-whitespace-line">: %? %U %a, what does these means??? %: %c </span></span>
                (<span class="org-string">"r"</span> <span class="org-string">"respond"</span> entry (file <span class="org-string">"~/git/jbarm/re_org_refile.org"</span>)
                 <span class="org-string">"* To %? about :RESPONSE:  \nSCHEDULED: %t\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:</span><span class="org-builtin"><span class="org-whitespace-line">clock-resume</span></span><span class="org-whitespace-line"> t)</span>
                (<span class="org-string">"n"</span> <span class="org-string">"note"</span> entry (file <span class="org-string">"~/git/jbarm/re_org_refile.org"</span>)
                 <span class="org-string">"* %? :NOTE:\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t)
                (<span class="org-string">"j"</span> <span class="org-string">"Journal"</span> entry (file+datetree <span class="org-string">"~/git/jbarm/re_org_diary.or</span><span class="org-string"><span class="org-whitespace-line">g"</span></span><span class="org-whitespace-line">)</span>
                 <span class="org-string">"* %?\n%U\n"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t)
                (<span class="org-string">"l"</span> <span class="org-string">"Ledger Journal"</span> plain (file <span class="org-string">"~/git/org/Finance/ledger"</span>)
                 <span class="org-string">"%(org-read-date) * %^{Payee}\n\tExpenses:%^{Account}\t&#163; %^{Amo</span><span class="org-string"><span class="org-whitespace-line">unt}\n\tAssets:Checking"</span></span><span class="org-whitespace-line"> </span><span class="org-builtin"><span class="org-whitespace-line">:immediate-finish</span></span><span class="org-whitespace-line"> </span><span class="org-builtin"><span class="org-whitespace-line">:clock-in</span></span><span class="org-whitespace-line"> t </span><span class="org-builtin"><span class="org-whitespace-line">:clock-resume</span></span><span class="org-whitespace-line"> t) </span>
                (<span class="org-string">"h"</span> <span class="org-string">"Habit"</span> entry (file <span class="org-string">"~/git/jbarm/re_org_habits.org"</span>)
                 <span class="org-string">"* NEXT %?\n%U\nSCHEDULED: %(format-time-string \"&lt;%Y-%m-%d .+1</span><span class="org-string"><span class="org-whitespace-line">d/3d&gt;\")\n:PROPERTIES:\n:STYLE: habit\n:REPEAT_TO_STATE: NEXT\n:END:\n"</span></span><span class="org-whitespace-line">)</span>
                (<span class="org-string">"v"</span> <span class="org-string">"Vocabulary"</span> entry (file <span class="org-string">"~/git/jbarm/re_org_refile.org"</span>)
                 <span class="org-string">"* %? :VOCA:\n%U"</span> <span class="org-builtin">:clock-in</span> t <span class="org-builtin">:clock-resume</span> t)
                ))))

(<span class="org-keyword">defun</span> <span class="org-function-name">my/all-office-settings</span> ()
  (interactive)
  (my/office-org-agenda-file)
  (my/office-org-capture-temp)
  (setq org-html-head-extra <span class="org-string">"&lt;link rel=\"stylesheet\" href=\"/home/yitang/git/.e</span><span class="org-string"><span class="org-whitespace-line">macs.d/style/office.css\" type=\"text/css\" /&gt;"</span></span>
        org-html-head <span class="org-string">"&lt;link rel=\"stylesheet\" href=\"\\SKI-CQV5LZ1\static\yi_r</span><span class="org-string"><span class="org-whitespace-line">eport.css\" type=\"text/css\" /&gt;"</span></span><span class="org-whitespace-line">)</span>
  )

(<span class="org-keyword">when</span> (equal <span class="org-string">"Office"</span> WhereAmI)
  (my/all-office-settings))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Babel Library</h2>
<div class="outline-text-2" id="text-5">
<p>
to load a 
</p>
<pre class="example">
(org-babel-lob-ingest "~/git/.emacs.d/yi.babel.org)
</pre>
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Update Emacs library</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-sh" id="UpdateEmacsPackages">cask install --path ~/git/.emacs.d
cask upgrade-cask --path ~/git/.emacs.d
git add -A 
git commit -m <span class="org-string">"cask update $(</span><span class="org-sh-quoted-exec">date</span><span class="org-string">)"</span>
git push
</pre>
</div>

<pre class="example">
#+call: UpdateEmacsPackages()

#+results:
: [master 3f5c750] cask update Sat Nov  8 18:06:08 GMT 2014
:  2 files changed, 7 insertions(+), 3 deletions(-)
:  delete mode 120000 .#yi.babel.org
</pre>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">Ledger</h3>
<div class="outline-text-3" id="text-5-2">
<p>
add the following to .ledgerrc 
</p>

<p>
&#x2013;start-of-week=1 -f ~/git/ImportantFiles/ledger
</p>

<div class="org-src-container">

<pre class="src src-sh" id="Weekly_Transaction">ledger --period <span class="org-string">"this week"</span>  register Exp -S <span class="org-string">"date, amount"</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh" id="Weekly_Balance_Sheet">ledger --period <span class="org-string">"this week"</span>  bal Exp
</pre>
</div>

<pre class="example">
#+call: Weekly_Transaction() 
2015-04-06 GiffGaff             Expenses:Bill:Phone         £ 10.00      £ 10.00
2015-04-06 Tesco                Expenses:Food:Grocery       £ 15.25      £ 25.25
2015-04-08 HS                   Expenses:Transport           £ 4.20      £ 29.45
2015-04-08 Tesco                Expenses:Food:Grocery       £ 14.11      £ 43.56
2015-04-10 HS                   Expenses:Food:Lunch          £ 2.50      £ 46.06
2015-04-10 Tesco                Expenses:Speical:Cig         £ 5.48      £ 51.54
15-Apr-06 GiffGaff              Expenses:Bill:Phone         £ 10.00      £ 10.00
15-Apr-06 Tesco                 Expenses:Food:Grocery       £ 15.25      £ 25.25
15-Apr-08 HS                    Expenses:Transport           £ 4.20      £ 29.45
15-Apr-08 Tesco                 Expenses:Food:Grocery       £ 14.11      £ 43.56
15-Apr-10 HS                    Expenses:Food:Lunch          £ 2.50      £ 46.06
15-Apr-10 Tesco                 Expenses:Speical:Cig         £ 5.48      £ 51.54
</pre>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">image process</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">

<pre class="src src-sh" id="Extract_PDF_Pages"><span class="org-comment-delimiter">## </span><span class="org-comment">http://www.linuxjournal.com/content/tech-tip-extract-pages-pdf</span>
<span class="org-keyword">function</span> <span class="org-function-name">pdfpextr</span>() 
{
    <span class="org-comment-delimiter"># </span><span class="org-comment">this function uses 3 arguments:</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$1 is the first page of the range to extract</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$2 is the last page of the range to extract</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">$3 is the input file</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">output file will be named "inputfile_pXX-pYY.pdf"</span>
    <span class="org-comment-delimiter"># </span><span class="org-warning">TODO</span><span class="org-comment">: add format=png option </span>
    gs -sDEVICE=pdfwrite -dNOPAUSE -dBATCH -dSAFER <span class="org-sh-escaped-newline">\</span>
       -dFirstPage=${<span class="org-variable-name">1</span>} <span class="org-sh-escaped-newline">\</span>
       -dLastPage=${<span class="org-variable-name">2</span>} <span class="org-sh-escaped-newline">\</span>
       -sOutputFile=${<span class="org-variable-name">3</span>%.pdf}_p${<span class="org-variable-name">1</span>}-p${<span class="org-variable-name">2</span>}.pdf <span class="org-sh-escaped-newline">\</span>
       ${<span class="org-variable-name">3</span>}
}
pdfpextr $<span class="org-variable-name">pageStart</span> $<span class="org-variable-name">pageEnd</span> $<span class="org-variable-name">pdfFile</span>
</pre>
</div>

<pre class="example">
#+name: Extract_PDF_Pages[:dir ~/git/org/img](1, 10, "tmp.pdf")
</pre>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">org contact</h3>
<div class="outline-text-3" id="text-5-4">
<p>

</p>
<div class="org-src-container">

<pre class="src src-elisp" id="GetContactGroup">(<span class="org-keyword">defun</span> <span class="org-function-name">GetContactGroup</span> (contact-file search-tag contact-type)
  (interactive)
  (<span class="org-keyword">let</span> ((name-address (org-map-entries (<span class="org-keyword">lambda</span>()
                                 (cons (elt (org-heading-components) 4)  <span class="org-comment-delimiter">;; </span><span class="org-comment">get </span><span class="org-comment"><span class="org-whitespace-line">headline (name) </span></span>
                                       (org-entry-get nil contact-type))) <span class="org-comment-delimiter">;; </span><span class="org-comment">get</span><span class="org-comment"><span class="org-whitespace-line"> Email/phone etc property </span></span>
                               search-tag
                               contact-file)))
    (mapconcat (<span class="org-keyword">lambda</span> (a-list)
                  (concat (car a-list) <span class="org-string">" &lt;"</span> (cdr a-list) <span class="org-string">"&gt;"</span>))
                name-address <span class="org-string">", "</span>)))
(GetContactGroup contact-file search-tag contact-type)
</pre>
</div>

<pre class="example">
#+call: GetContactGroup('("~/git/org/contacts.org"), "RunningClub", "EMAIL")
#+results:
: Foo Bar &lt;Foo.Bar@somewhere.com&gt;, Bar Foo &lt;Bar.Foo@somewhere.com&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">Blog</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">

<pre class="src src-R" id="GetBlogPosts">posts.dir &lt;- <span class="org-string">"~/git/yi-tang.github.io/org/_posts"</span>
all.posts &lt;- <span class="org-ess-function-call">list.files</span>(posts.dir, pattern = <span class="org-string">".org$"</span>)
<span class="org-ess-function-call">sapply</span>(<span class="org-ess-function-call">seq_along</span>(all.posts), <span class="org-keyword">function</span>(i){
headline &lt;- <span class="org-ess-function-call">paste0</span>(<span class="org-string">"* "</span>, all.posts[i])
content &lt;- <span class="org-ess-function-call">paste0</span>(<span class="org-string">"#+INCLUDE: "</span>, <span class="org-string">'"'</span>, <span class="org-ess-function-call">file.path</span>(posts.dir, all.posts[i]), <span class="org-string">'"'</span>)
page.break &lt;- <span class="org-string">"#+latex: \\newpage"</span>
<span class="org-ess-function-call">paste</span>(headline, content, page.break, sep = <span class="org-string">"\n"</span>)
})
</pre>
</div>


<div class="org-src-container">

<pre class="src src-emacs-lisp" id="GetLastUpdatedDate-:eval-no"><span class="org-comment-delimiter">;; </span><span class="org-comment">(defun yt/last-updated-date ()</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">"return modification time of current file-visitng buffer"</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(interactive)</span>
<span class="org-comment-delimiter">;;   </span><span class="org-comment">(let ((y (format-time-string "%d %b %Y" (visited-file-modtime))))</span>
<span class="org-comment-delimiter">;;    </span><span class="org-comment">(concat  "/Last Updated/: " y))) ;; print out results </span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(yt/last-updated-date)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">End</h2>
<div class="outline-text-2" id="text-6">
<p>

</p>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Archive</h2>
<div class="outline-text-2" id="text-7">
<p>

</p>
</div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">C++</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">(global-set-key [(f9)] 'compile)</span>
(setq compilation-window-height 2)
(setq compilation-finish-function
      (<span class="org-keyword">lambda</span> (buf str)

        (<span class="org-keyword">if</span> (string-match <span class="org-string">"exited abnormally"</span> str)

            <span class="org-comment-delimiter">;;</span><span class="org-comment">there were errors</span>
            (message <span class="org-string">"compilation errors, press C-x ` to visit"</span>)

          <span class="org-comment-delimiter">;;</span><span class="org-comment">no errors, make the compilation window go away in 0.5 seconds</span>
          (run-at-time 0.5 nil 'delete-windows-on buf)
          (message <span class="org-string">"NO COMPILATION ERRORS!"</span>))))



(<span class="org-keyword">defun</span> <span class="org-function-name">indent-buffer-ask</span>()
   (<span class="org-keyword">when</span> (y-or-n-p <span class="org-string">"Indent buffer before saving? "</span>)
     (indent-region (point-min) (point-max))))

(<span class="org-keyword">defun</span> <span class="org-function-name">indent-buffer-no-ask</span>()
  (indent-region (point-min) (point-max)))

(setq c++-mode-hook
      '(<span class="org-keyword">lambda</span> ()
         (c-set-style <span class="org-string">"cc-mode"</span>)
         (define-key c++-mode-map <span class="org-string">"\C-c\C-c"</span> 'compile)
         (define-key c++-mode-map <span class="org-string">"\C-c\C-e"</span> 'next-error)
<span class="org-comment-delimiter">;        </span><span class="org-comment">(add-hook 'before-save-hook 'indent-buffer-ask nil t)                  </span>
         (add-hook 'before-save-hook 'indent-buffer-no-ask nil t)  <span class="org-comment-delimiter">;; </span><span class="org-comment">indent c++</span><span class="org-comment"><span class="org-whitespace-line"> files after save.</span></span>
))




(<span class="org-keyword">require</span> '<span class="org-constant">flymake-google-cpplint</span>)
(add-hook 'c++-mode-hook 'flymake-google-cpplint-load)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(custom-set-variables</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">'(flymake-google-cpplint-command "/Library/Python/2.7/site-packages/cpplint/c</span><span class="org-comment"><span class="org-whitespace-line">pplint.py"))</span></span>
<span class="org-comment-delimiter">;</span><span class="org-comment">"/usr/local/bin/cpplint"))</span>

<span class="org-comment-delimiter">; </span><span class="org-comment">start google-c-style with emacs</span>
(<span class="org-keyword">require</span> '<span class="org-constant">google-c-style</span>)
(add-hook 'c-mode-common-hook 'google-set-c-style)
(add-hook 'c++-mode-common-hook 'google-make-newline-indent)
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<style type="text/css">
.back-to-top {
    position: fixed;
    bottom: 2em;
    right: 0px;
    text-decoration: none;
    color: #000000;
    background-color: rgba(235, 235, 235, 0.80);
    font-size: 12px;
    padding: 1em;
    display: none;
}
.back-to-top:hover {    
    background-color: rgba(135, 135, 135, 0.50);
}
</style>
<div class="back-to-top">
<a href="#top">Back to top</a> | <a href="mailto:yi.tang.uk@me.com">E-mail me</a>
</div>
<script type="text/javascript">
    var offset = 220;
    var duration = 500;
    jQuery(window).scroll(function() {
        if (jQuery(this).scrollTop() > offset) {
            jQuery('.back-to-top').fadeIn(duration);
        } else {
            jQuery('.back-to-top').fadeOut(duration);
        }
    });
</script>
</div>
</body>
</html>
