<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>init</title>
<!-- 2015-01-19 Mon 12:20 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Yi Tang" />
<link rel="stylesheet" href="http://uce.uniovi.es/tips/Emacs/docs/mystyle.css" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">init</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. init.el</a>
<ul>
<li><a href="#sec-1-1">1.1. General</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. Theme</a></li>
<li><a href="#sec-1-1-2">1.1.2. Helm</a></li>
<li><a href="#sec-1-1-3">1.1.3. Projectile</a></li>
<li><a href="#sec-1-1-4">1.1.4. Git Sync</a></li>
<li><a href="#sec-1-1-5">1.1.5. Multi-Cursor</a></li>
<li><a href="#sec-1-1-6">1.1.6. Writing</a></li>
<li><a href="#sec-1-1-7">1.1.7. Window Nevigation</a></li>
<li><a href="#sec-1-1-8">1.1.8. Programming Mode</a></li>
<li><a href="#sec-1-1-9">1.1.9. Utilitise</a></li>
<li><a href="#sec-1-1-10">1.1.10. OS</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2. Email - mu4e</a></li>
<li><a href="#sec-1-3">1.3. Modeline</a></li>
<li><a href="#sec-1-4">1.4. Cplusplus</a></li>
<li><a href="#sec-1-5">1.5. ESS - R</a></li>
<li><a href="#sec-1-6">1.6. Org mode</a></li>
<li><a href="#sec-1-7">1.7. Org Jekyll</a></li>
</ul>
</li>
<li><a href="#sec-2">2. End here</a>
<ul>
<li><a href="#sec-2-1">2.1. Test</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>

</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> init.el</h2>
<div class="outline-text-2" id="text-1">
<p>

</p>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> General</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #b2f7b2;">(</span>&gt;= emacs-major-version 24<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">package</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>package-initialize<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>add-to-list 'package-archives '<span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"melpa"</span> . <span style="color: #CC9393;">"http://melpa.milkbox.net/packages/"</span><span style="color: #e7ca77;">)</span> t<span style="color: #b2f7b2;">)</span>
  <span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">ref: http://stackoverflow.com/questions/151945/how-do-i-control-how-emacs-makes-backup-files
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">save all backup files (foo~) to this directory.
</span><span style="color: #e8e8bf;">(</span>setq backup-directory-alist '<span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"."</span> . <span style="color: #CC9393;">"~/.emacs.d/backup"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
      backup-by-copying t    <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Don't delink hardlinks
</span>      version-control t      <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Use version numbers on backups
</span>      delete-old-versions t  <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Automatically delete excess backups
</span>      kept-new-versions 20   <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">how many of the newest versions to keep
</span>      kept-old-versions 5    <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">and how many of the old
</span>      auto-save-timeout 20   <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">number of seconds idle time before auto-save (default: 30)
</span>      auto-save-interval 200 <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">number of keystrokes between auto-saves (default: 300)
</span>      <span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;;; winner-mode, undo window configration
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #b2f7b2;">(</span>fboundp 'winner-mode<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>winner-mode 1<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">winner-undo -&gt; C-c &lt;left&gt;
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">winner-redo -&gt; C-c &lt;right&gt;
</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">[2015-01-05 Mon 15:52]
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">guide-key package 
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">guide-key</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq guide-key/guide-key-sequence t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">on for all key-bindings 
</span><span style="color: #e8e8bf;">(</span>guide-key-mode 1<span style="color: #e8e8bf;">)</span> 







                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">start auto-complete with emacs
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">auto-complete</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">do default config for auto-complete
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">auto-complete-config</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>ac-config-default<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">yasnippet</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>yas-global-mode 1<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq yas-snippet-dirs '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"~/git/.emacs.d/my-snippets"</span>
                         <span style="color: #CC9393;">"~/git/.emacs.d/.cask/24.4.2/elpa/yasnippet-20141102.1554/snippets"</span>
                         <span style="color: #CC9393;">"~/git/.emacs.d/.cask/25.0.50.1/elpa/yasnippet-20141102.1554/snippets"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(yas/reload-all)
</span>
<span style="color: #e8e8bf;">(</span>recentf-mode 1<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq recentf-max-saved-items 200
      recentf-max-menu-items 15<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #CC9393;">"\C-r"</span> 'helm-recentf<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">prefer horizentally split window
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq split-height-threshold nil)
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">(setq split-width-threshold 0)
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">font
</span><span style="color: #e8e8bf;">(</span>set-default-font <span style="color: #CC9393;">"Source Code Pro"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'default nil <span style="color: #DCDCCC; font-weight: bold;">:height</span> 140<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(when (window-system)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(set-frame-font "Source Code Pro")
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(set-face-attribute 'default nil :font "Source Code Pro" :height 140)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(set-face-font 'default "Source Code Pro"))
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">windows path convention
</span><span style="color: #e8e8bf;">(</span>setenv <span style="color: #CC9393;">"CYGWIN"</span> <span style="color: #CC9393;">"nodosfilewarning"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">kill *scratch* buffer if possible
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(kill-buffer "*scratch*")
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(kill-buffer "*GNU Emacs*")
</span><span style="color: #e8e8bf;">(</span>setq inhibit-startup-message t<span style="color: #e8e8bf;">)</span>        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Disable startup message
</span>
</pre>
</div>
</div>
<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> Theme</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span>load-theme 'zenburn t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>print <span style="color: #CC9393;">"End of general.el"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">rainbow-delimiters</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'prog-mode-hook 'rainbow-delimiters-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>show-paren-mode t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">for Emacs
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">cl-lib</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">color</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">cl-loop</span>
 for index from 1 to rainbow-delimiters-max-face-count
 do
 <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>face <span style="color: #87dc87;">(</span>intern <span style="color: #87bdff;">(</span>format <span style="color: #CC9393;">"rainbow-delimiters-depth-%d-face"</span> index<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span>cl-callf color-saturate-name <span style="color: #7ef2f7;">(</span>face-foreground face<span style="color: #7ef2f7;">)</span> 30<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">modify mac keyboard 
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span>eq system-type 'darwin<span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>global-unset-key <span style="color: #7ef2f7;">(</span>kbd <span style="color: #CC9393;">"M-`"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>global-set-key <span style="color: #7ef2f7;">(</span>kbd <span style="color: #CC9393;">"M-`"</span><span style="color: #7ef2f7;">)</span> 'other-frame<span style="color: #e7ca77;">)</span>
       <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>






<p>
#+end_src
</p>
</div>
</div>
<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> Helm</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">helm 
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">helm-config</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>helm-mode 1<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">helm-swoop</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Change the keybinds to whatever you like :)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "M-i") 'helm-swoop)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "M-I") 'helm-swoop-back-to-last-point)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-c M-i") 'helm-multi-swoop)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-x M-i") 'helm-multi-swoop-all)
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f1&gt;"</span><span style="color: #b2f7b2;">)</span> 'helm-swoop<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">When doing isearch, hand the word over to helm-swoop
</span><span style="color: #e8e8bf;">(</span>define-key isearch-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"M-i"</span><span style="color: #b2f7b2;">)</span> 'helm-swoop-from-isearch<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">From helm-swoop to helm-multi-swoop-all
</span><span style="color: #e8e8bf;">(</span>define-key helm-swoop-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"M-i"</span><span style="color: #b2f7b2;">)</span> 'helm-multi-swoop-all-from-helm-swoop<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">When doing evil-search, hand the word over to helm-swoop
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(define-key evil-motion-state-map (kbd "M-i") 'helm-swoop-from-evil-search)
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Save buffer when helm-multi-swoop-edit complete
</span><span style="color: #e8e8bf;">(</span>setq helm-multi-swoop-edit-save t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">If this value is t, split window inside the current window
</span><span style="color: #e8e8bf;">(</span>setq helm-swoop-split-with-multiple-windows nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Split direcion. 'split-window-vertically or 'split-window-horizontally
</span><span style="color: #e8e8bf;">(</span>setq helm-swoop-split-direction 'split-window-vertically<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">If nil, you can slightly boost invoke speed in exchange for text color
</span><span style="color: #e8e8bf;">(</span>setq helm-swoop-speed-or-color nil<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">----------------------------------------------------------------------
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-b"</span><span style="color: #b2f7b2;">)</span> 'helm-buffers-list<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3"><span class="section-number-4">1.1.3</span> Projectile</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">projectile</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">helm-projectile</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>projectile-global-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq projectile-enable-caching t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq projectile-switch-project-action 'projectile-dired<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq projectile-remember-window-configs t <span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq projectile-completion-system 'helm<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-4" class="outline-4">
<h4 id="sec-1-1-4"><span class="section-number-4">1.1.4</span> Git Sync</h4>
<div class="outline-text-4" id="text-1-1-4">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">backup git repo automatically 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">git
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">magit</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/git-backup</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">(call-process-shell-command "~/git/AutoCommit.sh" nil nil t)
</span>  <span style="color: #b2f7b2;">(</span>start-process-shell-command <span style="color: #CC9393;">"git-sync"</span> <span style="color: #CC9393;">"~/git/org/sync.log"</span> <span style="color: #CC9393;">"~/git/org/AutoSync.sh"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>message <span style="color: #CC9393;">"all git sync... done"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/save-all-buffers</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"save all files-visiting buffers without user confirmation"</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>save-some-buffers t nil<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>message <span style="color: #CC9393;">"save all buffers... done"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/save-git-backup</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>yt/save-all-buffers<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>yt/git-backup<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span>eq system-type 'darwin<span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>run-at-time <span style="color: #CC9393;">"05:59"</span> 10800 'yt/save-git-backup<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-5" class="outline-4">
<h4 id="sec-1-1-5"><span class="section-number-4">1.1.5</span> Multi-Cursor</h4>
<div class="outline-text-4" id="text-1-1-5">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">multiple-cursors</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-c C-S-c"</span><span style="color: #b2f7b2;">)</span> 'mc/edit-lines<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-&gt;") 'mc/mark-next-like-this)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-&lt;") 'mc/mark-previous-like-this)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-c C-&lt;") 'mc/mark-all-like-this)
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-&lt;right&gt;"</span><span style="color: #b2f7b2;">)</span> 'mc/mark-next-like-this<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-&lt;left&gt;"</span><span style="color: #b2f7b2;">)</span> 'mc/mark-previous-like-this<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c C-&lt;"</span><span style="color: #b2f7b2;">)</span> 'mc/mark-all-like-this<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-6" class="outline-4">
<h4 id="sec-1-1-6"><span class="section-number-4">1.1.6</span> Writing</h4>
<div class="outline-text-4" id="text-1-1-6">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">spell, grammar 
</span><span style="color: #e8e8bf;">(</span>add-hook 'text-mode-hook 'flyspell-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook 'flyspell-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq ispell-dictionary <span style="color: #CC9393;">"british"</span>
      ispell-extra-args '<span style="color: #b2f7b2;">()</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">TeX mode "-t"
</span>      ispell-silently-savep t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">artbollocks-mode</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'text-mode-hook 'artbollocks-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq artbollocks-weasel-words-regex
      <span style="color: #b2f7b2;">(</span>concat <span style="color: #CC9393;">"\\b"</span> <span style="color: #e7ca77;">(</span>regexp-opt
                     '<span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"one of the"</span>
                       <span style="color: #CC9393;">"should"</span>
                       <span style="color: #CC9393;">"just"</span>
                       <span style="color: #CC9393;">"sort of"</span>
                       <span style="color: #CC9393;">"a lot"</span>
                       <span style="color: #CC9393;">"probably"</span>
                       <span style="color: #CC9393;">"maybe"</span>
                       <span style="color: #CC9393;">"perhaps"</span>
                       <span style="color: #CC9393;">"I think"</span>
                       <span style="color: #CC9393;">"really"</span>
                       <span style="color: #CC9393;">"pretty"</span>
                       <span style="color: #CC9393;">"nice"</span>
                       <span style="color: #CC9393;">"action"</span>
                       <span style="color: #CC9393;">"utilize"</span>
                       <span style="color: #CC9393;">"leverage"</span><span style="color: #7ef2f7;">)</span> t<span style="color: #e7ca77;">)</span> <span style="color: #CC9393;">"\\b"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">langtool</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq langtool-language-tool-jar <span style="color: #CC9393;">"~/Java/LanguageTool-2.8/languagetool-commandline.jar"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq langtool-mother-tongue <span style="color: #CC9393;">"en"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">[2014-12-25 Thu 22:21]
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/write-mode</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>hl-sentence-mode<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>variable-pitch-mode<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>nanowrimo-mode<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">word count
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">https://bitbucket.org/gvol/nanowrimo.el
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-wc</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">nanowrimo</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq nanowrimo-today-goal 500<span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">[2014-12-23 Tue 22:06]
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Highlight sentence
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">https://www.gnu.org/software/emacs/manual/html_node/elisp/Attribute-Functions.html
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">hl-sentence</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'nanowrimo-mode 'hl-sentence-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'hl-sentence-face nil
                    <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">:foreground "black")
</span>                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"white"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'nanowrimo-mode 'variable-pitch-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'variable-pitch nil
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray40"</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-7" class="outline-4">
<h4 id="sec-1-1-7"><span class="section-number-4">1.1.7</span> Window Nevigation</h4>
<div class="outline-text-4" id="text-1-1-7">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">visible notication for invalid options 
</span><span style="color: #e8e8bf;">(</span>setq visible-bell t<span style="color: #e8e8bf;">)</span> 
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">move between windows, alternatives: window_number.el
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-x &lt;up&gt;"</span><span style="color: #b2f7b2;">)</span> 'windmove-up<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-x &lt;down&gt;"</span><span style="color: #b2f7b2;">)</span> 'windmove-down<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-x &lt;right&gt;"</span><span style="color: #b2f7b2;">)</span> 'windmove-right<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-x &lt;left&gt;"</span><span style="color: #b2f7b2;">)</span> 'windmove-left<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">golden-ratio</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>golden-ratio-mode 1<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-8" class="outline-4">
<h4 id="sec-1-1-8"><span class="section-number-4">1.1.8</span> Programming Mode</h4>
<div class="outline-text-4" id="text-1-1-8">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">highlights </span><span style="color: #D0BF8F; font-weight: bold;">FIXME</span><span style="color: #7F9F7F;">: </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: and </span><span style="color: #D0BF8F; font-weight: bold;">BUG</span><span style="color: #7F9F7F;">: in prog-mode 
</span><span style="color: #e8e8bf;">(</span>add-hook 'prog-mode-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>font-lock-add-keywords nil
                                    '<span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span><span style="color: #CC9393;">"\\&lt;</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">YT</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">FIXME</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">TODO</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">BUG</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;">:"</span> 1 font-lock-warning-face t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'prog-mode-hook 'hs-minor-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f3&gt;"</span><span style="color: #b2f7b2;">)</span> 'hs-toggle-hiding<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"S-&lt;f3&gt;"</span><span style="color: #b2f7b2;">)</span> 'hs-show-all<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">S-&gt;show 
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-&lt;f3&gt;"</span><span style="color: #b2f7b2;">)</span> 'hs-hide-all<span style="color: #e8e8bf;">)</span> 
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-hide-block                      C-c @ C-h
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-show-block                      C-c @ C-s
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-hide-all                        C-c @ C-M-h
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-show-all                        C-c @ C-M-s
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-hide-level                      C-c @ C-l
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-toggle-hiding 
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-mouse-toggle-hiding             [(shift mouse-2)]
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">hs-hide-initial-comment-block
</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-d"</span><span style="color: #b2f7b2;">)</span> 'comment-region<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">overwite delete-char 
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-d"</span><span style="color: #b2f7b2;">)</span> 'uncomment-region<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-9" class="outline-4">
<h4 id="sec-1-1-9"><span class="section-number-4">1.1.9</span> Utilitise</h4>
<div class="outline-text-4" id="text-1-1-9">
<p>

</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Change "yes or no" to "y or n"
</span><span style="color: #e8e8bf;">(</span>fset 'yes-or-no-p 'y-or-n-p<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/reload-dot-emacs</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Save the .emacs buffer if needed, then reload .emacs."</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>dot-emacs <span style="color: #CC9393;">"~/.emacs"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>and <span style="color: #7ef2f7;">(</span>get-file-buffer dot-emacs<span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>save-buffer <span style="color: #87dc87;">(</span>get-file-buffer dot-emacs<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>load-file dot-emacs<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>message <span style="color: #CC9393;">"Re-initialized!"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/delete-this-buffer-and-file</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Removes file connected to current buffer and kills buffer."</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>filename <span style="color: #87dc87;">(</span>buffer-file-name<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>buffer <span style="color: #87dc87;">(</span>current-buffer<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>name <span style="color: #87dc87;">(</span>buffer-name<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #7ef2f7;">(</span>not <span style="color: #87dc87;">(</span>and filename <span style="color: #87bdff;">(</span>file-exists-p filename<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #D0BF8F; font-weight: bold;">error</span> <span style="color: #CC9393;">"Buffer '%s' is not visiting a file!"</span> name<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #87dc87;">(</span>yes-or-no-p <span style="color: #CC9393;">"Are you sure you want to remove this file? "</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>delete-file filename<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>kill-buffer buffer<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>message <span style="color: #CC9393;">"File '%s' successfully removed"</span> filename<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">full path of current buffer
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/copy-full-path-to-kill-ring</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"copy buffer's full path to kill ring"</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> buffer-file-name
    <span style="color: #e7ca77;">(</span>kill-new <span style="color: #7ef2f7;">(</span>file-truename buffer-file-name<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">[</span>C-f1<span style="color: #b2f7b2;">]</span> 'yt/copy-full-path-to-kill-ring<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Or any other key you want
</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-1-10" class="outline-4">
<h4 id="sec-1-1-10"><span class="section-number-4">1.1.10</span> OS</h4>
<div class="outline-text-4" id="text-1-1-10">
<p>

</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">osx, work with homebrew 
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">set-exec-path-from-shell-PATH</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>path-from-shell 
         <span style="color: #87dc87;">(</span>replace-regexp-in-string <span style="color: #CC9393;">"[[:space:]\n]*$"</span> <span style="color: #CC9393;">""</span> 
                                   <span style="color: #87bdff;">(</span>shell-command-to-string <span style="color: #CC9393;">"$SHELL -l -c 'echo $PATH'"</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>setenv <span style="color: #CC9393;">"PATH"</span> path-from-shell<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>setq exec-path <span style="color: #7ef2f7;">(</span>split-string path-from-shell path-separator<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #b2f7b2;">(</span>equal system-type 'darwin<span style="color: #b2f7b2;">)</span> <span style="color: #b2f7b2;">(</span>set-exec-path-from-shell-PATH<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span>eq system-type 'darwin<span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>fset 'insertPound <span style="color: #CC9393;">"#"</span><span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>global-set-key <span style="color: #7ef2f7;">(</span>kbd <span style="color: #CC9393;">"M-3"</span><span style="color: #7ef2f7;">)</span> 'insertPound<span style="color: #e7ca77;">)</span>
       <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>prefer-coding-system 'utf-8<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #b2f7b2;">(</span>display-graphic-p<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq x-select-request-type '<span style="color: #e7ca77;">(</span>UTF8_STRING COMPOUND_TEXT TEXT STRING<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Email - mu4e</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">usage:
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">$ offlineimap
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">$ mu index
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">M-x mu4e
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">from mu's official manual 
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">----------------------------------------------------------
</span><span style="color: #e8e8bf;">(</span>add-to-list 'load-path <span style="color: #CC9393;">"~/mu-master/mu4e"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">mu4e</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-mu-binary <span style="color: #CC9393;">"/usr/local/bin/mu"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">default
</span><span style="color: #e8e8bf;">(</span>setq mu4e-maildir <span style="color: #CC9393;">"~/Maildir"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-drafts-folder <span style="color: #CC9393;">"/iCloud/Drafts"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-sent-folder   <span style="color: #CC9393;">"/iCloud/Sent Messages"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-trash-folder  <span style="color: #CC9393;">"/iCloud/Deleted Messages"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">don't save message to Sent Messages, Gmail/IMAP takes care of this
</span><span style="color: #e8e8bf;">(</span>setq mu4e-sent-messages-behavior 'sent<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">setup some handy shortcuts
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">you can quickly switch to your Inbox -- press ``</span><span style="color: #BFEBBF;">ji</span><span style="color: #7F9F7F;">''
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">then, when you want archive some messages, move them to
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">the 'All Mail' folder by pressing ``</span><span style="color: #BFEBBF;">ma</span><span style="color: #7F9F7F;">''.
</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-maildir-shortcuts
      '<span style="color: #b2f7b2;">(</span> <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"/iCloud/INBOX"</span>               . ?i<span style="color: #e7ca77;">)</span>
         <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"/iCloud/Sent Messages"</span>   . ?s<span style="color: #e7ca77;">)</span>
         <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"/iCloud/Deleted Messages"</span>       . ?t<span style="color: #e7ca77;">)</span>
         <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">("/iCloud.All Mail"    . ?a)
</span>         <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">allow for updating mail using 'U' in the main view:
</span><span style="color: #e8e8bf;">(</span>setq mu4e-get-mail-command <span style="color: #CC9393;">"offlineimap"</span><span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">something about ourselves
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;; (setq
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;; user-mail-address "yi.tang.uk@me.com"
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;; user-full-name  "&#21776;&#27589; (Yi Tang)"
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">;; message-signature
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">;; (concat
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">;;  "&#21776;&#27589; (Yi Tang)\n"
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">;;  "Email: yi.tang.uk@me.com\n"
</span><span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">;;  "\n"))
</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">sending mail -- replace USERNAME with your gmail username
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">also, make sure the gnutls command line utils are installed
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">package 'gnutls-bin' in Debian/Ubuntu
</span><span style="color: #e8e8bf;">(</span>setq smtpmail-default-smtp-server <span style="color: #CC9393;">"smtpserver"</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">needs to be specified before the (require)
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">smtpmail</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/mail-setup</span> <span style="color: #b2f7b2;">()</span> 
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
   <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>eq system-type 'gnu/linux<span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>setq message-send-mail-function 'smtpmail-send-it
          smtpmail-stream-type 'starttls
          smtpmail-default-smtp-server <span style="color: #CC9393;">"smtp.office365.com"</span>
          smtpmail-smtp-server <span style="color: #CC9393;">"smtp.office365.com"</span>
          smtpmail-smtp-service 587
          smtpmail-smtp-user <span style="color: #CC9393;">"yi.tang@jbarisk.com"</span>
          user-mail-address <span style="color: #CC9393;">"yi.tang@jbarisk.com"</span>
          user-full-name  <span style="color: #CC9393;">"Yi Tang"</span>
          message-signature
          <span style="color: #87dc87;">(</span>concat
           <span style="color: #CC9393;">"Yi Tang\n"</span>
           <span style="color: #CC9393;">"Statistician\n"</span>
           <span style="color: #CC9393;">"T: +44 (0) 1756 799919\n"</span><span style="color: #87dc87;">)</span>
          <span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"sent email via office365 email account"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>eq system-type 'darwin<span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>setq message-send-mail-function 'smtpmail-send-it
          smtpmail-stream-type 'starttls
          smtpmail-default-smtp-server <span style="color: #CC9393;">"smtp.mail.me.com"</span>
          smtpmail-smtp-server <span style="color: #CC9393;">"smtp.mail.me.com"</span>
          smtpmail-smtp-service 587
          smtpmail-smtp-user <span style="color: #CC9393;">"yi.tang.uk@me.com"</span>
          user-mail-address <span style="color: #CC9393;">"yi.tang.uk@me.com"</span>
          user-full-name  <span style="color: #CC9393;">"Yi Tang"</span>
          message-signature
          <span style="color: #87dc87;">(</span>concat
           <span style="color: #CC9393;">"&#21776;&#27589; (Yi Tang)\n"</span>
           <span style="color: #CC9393;">"Email: yi.tang.uk@me.com\n"</span>
           <span style="color: #CC9393;">"\n"</span><span style="color: #87dc87;">)</span>
          <span style="color: #7ef2f7;">)</span>   
    <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"sent email via icloud email account"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>yt/mail-setup<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">don't keep message buffers around
</span><span style="color: #e8e8bf;">(</span>setq message-kill-buffer-on-exit t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">use 'fancy' non-ascii characters in various places in mu4e
</span><span style="color: #e8e8bf;">(</span>setq mu4e-use-fancy-chars t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">save attachment to my desktop (this can also be a function)
</span><span style="color: #e8e8bf;">(</span>setq mu4e-attachment-dir <span style="color: #CC9393;">"~/Desktop"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">attempt to show images when viewing messages
</span><span style="color: #e8e8bf;">(</span>setq mu4e-view-show-images t
      mu4e-show-images t
      mu4e-view-image-max-width 800<span style="color: #e8e8bf;">)</span>



<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">yt
</span><span style="color: #e8e8bf;">(</span>setq mu4e-view-prefer-html t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">try to render 
</span><span style="color: #e8e8bf;">(</span>add-to-list 'mu4e-view-actions 
             '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"ViewInBrowser"</span> . mu4e-action-view-in-browser<span style="color: #b2f7b2;">)</span> t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">read in browser 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">mu4e as default email agent in emacs
</span><span style="color: #e8e8bf;">(</span>setq mail-user-agent 'mu4e-user-agent<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-mu4e</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">== M-x org-mu4e-compose-org-mode==
</span><span style="color: #e8e8bf;">(</span>setq org-mu4e-convert-to-html t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">org -&gt; html
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">= M-m C-c.= 
</span>




<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
 <span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span>eq system-type 'gnu/linux<span style="color: #e7ca77;">)</span>
  <span style="color: #e7ca77;">(</span>setq mu4e-drafts-folder <span style="color: #CC9393;">"/Drafts"</span><span style="color: #e7ca77;">)</span>
  <span style="color: #e7ca77;">(</span>setq mu4e-sent-folder   <span style="color: #CC9393;">"/Sent Items"</span><span style="color: #e7ca77;">)</span>
  <span style="color: #e7ca77;">(</span>setq mu4e-trash-folder  <span style="color: #CC9393;">"/Trash"</span><span style="color: #e7ca77;">)</span>
  <span style="color: #e7ca77;">(</span>setq mu4e-maildir-shortcuts
        '<span style="color: #7ef2f7;">(</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"/JBA/INBOX"</span>               . ?i<span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"/Sent Items"</span>   . ?s<span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"/Trash"</span>       . ?t<span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"/All Mail"</span>    . ?a<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq mu4e-compose-signature
      <span style="color: #b2f7b2;">(</span>concat
       <span style="color: #CC9393;">"Yi Tang\n"</span>
       <span style="color: #CC9393;">"Statistician\n"</span>
       <span style="color: #CC9393;">"T: +44 (0) 1756 799919\n"</span><span style="color: #b2f7b2;">)</span>
      <span style="color: #e8e8bf;">)</span>n


<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-contacts</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq mu4e-org-contacts-file  <span style="color: #CC9393;">"~/git/org/contacts"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-to-list 'mu4e-headers-actions
             '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"org-contact-add"</span> . mu4e-action-add-org-contact<span style="color: #b2f7b2;">)</span> t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-to-list 'mu4e-view-actions
             '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"org-contact-add"</span> . mu4e-action-add-org-contact<span style="color: #b2f7b2;">)</span> t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq mu4e-html2text-command <span style="color: #CC9393;">"html2text -utf8 -width 72"</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">nil "Shel command that converts HTML
</span>


<span style="color: #5F7F5F;">;;;; </span><span style="color: #7F9F7F;">[2015-01-14 Wed 22:32]
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">org-mime
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-mime</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-mime-library 'mml<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #CC9393;">"\C-c\M-o"</span> 'org-mime-htmlize<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #CC9393;">"\C-c\M-o"</span> 'org-mime-org-buffer-htmlize<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'org-mime-html-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>insert-file-contents <span style="color: #CC9393;">"~/git/.emacs.d/style/jba.css"</span><span style="color: #e7ca77;">)</span>
            <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(goto-char 5)
</span>            <span style="color: #b2f7b2;">)</span>
          t<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Modeline</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">nyan-mode</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>nyan-mode 1<span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">copy from http://amitp.blogspot.co.uk/2011/08/emacs-custom-mode-line.html
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Mode line setup
</span><span style="color: #e8e8bf;">(</span>setq-default
 mode-line-format
 '<span style="color: #b2f7b2;">(</span><span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Position, including warning for 80 columns
</span>   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:propertize</span> <span style="color: #CC9393;">"%4l:"</span> face mode-line-position-face<span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:eval</span> <span style="color: #7ef2f7;">(</span>propertize <span style="color: #CC9393;">"%3c"</span> 'face
                      <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87bdff;">(</span>&gt;= <span style="color: #f3d88b;">(</span>current-column<span style="color: #f3d88b;">)</span> 80<span style="color: #87bdff;">)</span>
                          'mode-line-80col-face
                        'mode-line-position-face<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">emacsclient [default -- keep?]
</span>   mode-line-client
   <span style="color: #CC9393;">"  "</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">read-only or modified status
</span>   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:eval</span>
    <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #87dc87;">(</span>buffer-read-only
           <span style="color: #87bdff;">(</span>propertize <span style="color: #CC9393;">" RO "</span> 'face 'mode-line-read-only-face<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>buffer-modified-p<span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span>propertize <span style="color: #CC9393;">" ** "</span> 'face 'mode-line-modified-face<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>t <span style="color: #CC9393;">"      "</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #CC9393;">"    "</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">directory and buffer/file name
</span>   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:propertize</span> <span style="color: #7ef2f7;">(</span><span style="color: #DCDCCC; font-weight: bold;">:eval</span> <span style="color: #87dc87;">(</span>shorten-directory default-directory 30<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
                face mode-line-folder-face<span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:propertize</span> <span style="color: #CC9393;">"%b"</span>
                face mode-line-filename-face<span style="color: #e7ca77;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">narrow [default -- keep?]
</span>   <span style="color: #CC9393;">" %n "</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">mode indicators: vc, recursive edit, major mode, minor modes, process, global
</span>   <span style="color: #e7ca77;">(</span>vc-mode vc-mode<span style="color: #e7ca77;">)</span>
   <span style="color: #CC9393;">"  %["</span>
   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:propertize</span> mode-name
                face mode-line-mode-face<span style="color: #e7ca77;">)</span>
   <span style="color: #CC9393;">"%] "</span>
   <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(:eval (propertize (format-mode-line minor-mode-alist)
</span>   <span style="color: #5F7F5F;">;;                    </span><span style="color: #7F9F7F;">'face 'mode-line-minor-mode-face))
</span>   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:propertize</span> mode-line-process
                face mode-line-process-face<span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span>global-mode-string global-mode-string<span style="color: #e7ca77;">)</span>
   <span style="color: #CC9393;">"    "</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">nyan-mode uses nyan cat as an alternative to %p
</span>   <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:eval</span> <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> nyan-mode <span style="color: #87dc87;">(</span>list <span style="color: #87bdff;">(</span>nyan-create<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Helper function
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">shorten-directory</span> <span style="color: #b2f7b2;">(</span>dir max-length<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Show up to `</span><span style="color: #BFEBBF;">max-length</span><span style="color: #9FC59F;">' characters of a directory name `</span><span style="color: #BFEBBF;">dir</span><span style="color: #9FC59F;">'."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>path <span style="color: #87dc87;">(</span>reverse <span style="color: #87bdff;">(</span>split-string <span style="color: #f3d88b;">(</span>abbreviate-file-name dir<span style="color: #f3d88b;">)</span> <span style="color: #CC9393;">"/"</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>output <span style="color: #CC9393;">""</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #7ef2f7;">(</span>and path <span style="color: #87dc87;">(</span>equal <span style="color: #CC9393;">""</span> <span style="color: #87bdff;">(</span>car path<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>setq path <span style="color: #87dc87;">(</span>cdr path<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #7ef2f7;">(</span>and path <span style="color: #87dc87;">(</span>&lt; <span style="color: #87bdff;">(</span>length output<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>- max-length 4<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>setq output <span style="color: #87dc87;">(</span>concat <span style="color: #87bdff;">(</span>car path<span style="color: #87bdff;">)</span> <span style="color: #CC9393;">"/"</span> output<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>setq path <span style="color: #87dc87;">(</span>cdr path<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> path
      <span style="color: #7ef2f7;">(</span>setq output <span style="color: #87dc87;">(</span>concat <span style="color: #CC9393;">".../"</span> output<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    output<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Extra mode line faces
</span><span style="color: #e8e8bf;">(</span>make-face 'mode-line-read-only-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-modified-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-folder-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-filename-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-position-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-mode-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-minor-mode-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-process-face<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>make-face 'mode-line-80col-face<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line nil
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray60"</span> <span style="color: #DCDCCC; font-weight: bold;">:background</span> <span style="color: #CC9393;">"gray20"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:inverse-video</span> nil
                    <span style="color: #DCDCCC; font-weight: bold;">:box</span> '<span style="color: #b2f7b2;">(</span><span style="color: #DCDCCC; font-weight: bold;">:line-width</span> 6 <span style="color: #DCDCCC; font-weight: bold;">:color</span> <span style="color: #CC9393;">"gray20"</span> <span style="color: #DCDCCC; font-weight: bold;">:style</span> nil<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-inactive nil
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray80"</span> <span style="color: #DCDCCC; font-weight: bold;">:background</span> <span style="color: #CC9393;">"gray40"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:inverse-video</span> nil
                    <span style="color: #DCDCCC; font-weight: bold;">:box</span> '<span style="color: #b2f7b2;">(</span><span style="color: #DCDCCC; font-weight: bold;">:line-width</span> 6 <span style="color: #DCDCCC; font-weight: bold;">:color</span> <span style="color: #CC9393;">"gray40"</span> <span style="color: #DCDCCC; font-weight: bold;">:style</span> nil<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-read-only-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"#4271ae"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:box</span> '<span style="color: #b2f7b2;">(</span><span style="color: #DCDCCC; font-weight: bold;">:line-width</span> 2 <span style="color: #DCDCCC; font-weight: bold;">:color</span> <span style="color: #CC9393;">"#4271ae"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-modified-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"#c82829"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:background</span> <span style="color: #CC9393;">"#ffffff"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:box</span> '<span style="color: #b2f7b2;">(</span><span style="color: #DCDCCC; font-weight: bold;">:line-width</span> 2 <span style="color: #DCDCCC; font-weight: bold;">:color</span> <span style="color: #CC9393;">"#c82829"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-folder-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray60"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-filename-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"#eab700"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:weight</span> 'bold<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-position-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:family</span> <span style="color: #CC9393;">"Menlo"</span> <span style="color: #DCDCCC; font-weight: bold;">:height</span> 100<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-mode-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray80"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-minor-mode-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-mode-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"gray40"</span>
                    <span style="color: #DCDCCC; font-weight: bold;">:height</span> 110<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-process-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"#718c00"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-face-attribute 'mode-line-80col-face nil
                    <span style="color: #DCDCCC; font-weight: bold;">:inherit</span> 'mode-line-position-face
                    <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"black"</span> <span style="color: #DCDCCC; font-weight: bold;">:background</span> <span style="color: #CC9393;">"#eab700"</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Cplusplus</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key [(f9)] 'compile)
</span><span style="color: #e8e8bf;">(</span>setq compilation-window-height 2<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq compilation-finish-function
      <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">(</span>buf str<span style="color: #e7ca77;">)</span>

        <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #7ef2f7;">(</span>string-match <span style="color: #CC9393;">"exited abnormally"</span> str<span style="color: #7ef2f7;">)</span>

            <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">there were errors
</span>            <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"compilation errors, press C-x ` to visit"</span><span style="color: #7ef2f7;">)</span>

          <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">no errors, make the compilation window go away in 0.5 seconds
</span>          <span style="color: #7ef2f7;">(</span>run-at-time 0.5 nil 'delete-windows-on buf<span style="color: #7ef2f7;">)</span>
          <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"NO COMPILATION ERRORS!"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>



<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">indent-buffer-ask</span><span style="color: #b2f7b2;">()</span>
   <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #e7ca77;">(</span>y-or-n-p <span style="color: #CC9393;">"Indent buffer before saving? "</span><span style="color: #e7ca77;">)</span>
     <span style="color: #e7ca77;">(</span>indent-region <span style="color: #7ef2f7;">(</span>point-min<span style="color: #7ef2f7;">)</span> <span style="color: #7ef2f7;">(</span>point-max<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">indent-buffer-no-ask</span><span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>indent-region <span style="color: #e7ca77;">(</span>point-min<span style="color: #e7ca77;">)</span> <span style="color: #e7ca77;">(</span>point-max<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq c++-mode-hook
      '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
         <span style="color: #e7ca77;">(</span>c-set-style <span style="color: #CC9393;">"cc-mode"</span><span style="color: #e7ca77;">)</span>
         <span style="color: #e7ca77;">(</span>define-key c++-mode-map <span style="color: #CC9393;">"\C-c\C-c"</span> 'compile<span style="color: #e7ca77;">)</span>
         <span style="color: #e7ca77;">(</span>define-key c++-mode-map <span style="color: #CC9393;">"\C-c\C-e"</span> 'next-error<span style="color: #e7ca77;">)</span>
<span style="color: #5F7F5F;">;        </span><span style="color: #7F9F7F;">(add-hook 'before-save-hook 'indent-buffer-ask nil t)                  
</span>         <span style="color: #e7ca77;">(</span>add-hook 'before-save-hook 'indent-buffer-no-ask nil t<span style="color: #e7ca77;">)</span>  <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">indent c++ files after save.
</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>




<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">flymake-google-cpplint</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'c++-mode-hook 'flymake-google-cpplint-load<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(custom-set-variables
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">'(flymake-google-cpplint-command "/Library/Python/2.7/site-packages/cpplint/cpplint.py"))
</span><span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">"/usr/local/bin/cpplint"))
</span>
<span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">start google-c-style with emacs
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">google-c-style</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'c-mode-common-hook 'google-set-c-style<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'c++-mode-common-hook 'google-make-newline-indent<span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> ESS - R</h3>
<div class="outline-text-3" id="text-1-5">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Adapted with one minor change from Felipe Salazar at
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">http://www.emacswiki.org/emacs/EmacsSpeaksStatistics
</span><span style="color: #e8e8bf;">(</span>add-to-list 'load-path <span style="color: #CC9393;">"~/git/.emacs.d/elpa/ess-13.09-1/lisp"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">ess-site</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq ess-ask-for-ess-directory nil<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">start R on default folder
</span><span style="color: #e8e8bf;">(</span>setq ess-local-process-name <span style="color: #CC9393;">"R"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq ansi-color-for-comint-mode 'filter<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #e8e8bf;">(</span>setq comint-scroll-to-bottom-on-input t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq comint-scroll-to-bottom-on-output t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq comint-move-point-for-output t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq ess-eval-visibly-p 'nowait<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">no waiting while ess evalating
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">my-ess-start-R</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>not <span style="color: #7ef2f7;">(</span>member <span style="color: #CC9393;">"*R*"</span> <span style="color: #87dc87;">(</span>mapcar <span style="color: #87bdff;">(</span>function buffer-name<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>buffer-list<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>delete-other-windows<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>setq w1 <span style="color: #87dc87;">(</span>selected-window<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>setq w1name <span style="color: #87dc87;">(</span>buffer-name<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>setq w2 <span style="color: #87dc87;">(</span>split-window w1 nil t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>R<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>set-window-buffer w2 <span style="color: #CC9393;">"*R*"</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>set-window-buffer w1 w1name<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">my-ess-eval</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>my-ess-start-R<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>and transient-mark-mode mark-active<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>call-interactively 'ess-eval-region<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>call-interactively 'ess-eval-line-and-step<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'ess-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span><span style="color: #e7ca77;">()</span>
             <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #7ef2f7;">[</span><span style="color: #87dc87;">(</span>shift return<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">]</span> 'my-ess-eval<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'inferior-ess-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span><span style="color: #e7ca77;">()</span>
             <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #7ef2f7;">[</span>C-up<span style="color: #7ef2f7;">]</span> 'comint-previous-input<span style="color: #e7ca77;">)</span>
             <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #7ef2f7;">[</span>C-down<span style="color: #7ef2f7;">]</span> 'comint-next-input<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'Rnw-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span><span style="color: #e7ca77;">()</span>
             <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #7ef2f7;">[</span><span style="color: #87dc87;">(</span>shift return<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">]</span> 'my-ess-eval<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'ess-mode-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>flyspell-prog-mode<span style="color: #e7ca77;">)</span>
            <span style="color: #e7ca77;">(</span>run-hooks 'prog-mode-hook<span style="color: #e7ca77;">)</span>
            <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(prog-mode)
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">...
</span>            <span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(require 'ess-site)
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">REF: http://stackoverflow.com/questions/2901198/useful-keyboard-shortcuts-and-tips-for-ess-r
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Control and up/down arrow keys to search history with matching what you've already typed:
</span><span style="color: #e8e8bf;">(</span>define-key comint-mode-map <span style="color: #b2f7b2;">[</span>C-up<span style="color: #b2f7b2;">]</span> 'comint-previous-matching-input-from-input<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>define-key comint-mode-map <span style="color: #b2f7b2;">[</span>C-down<span style="color: #b2f7b2;">]</span> 'comint-next-matching-input-from-input<span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-b = list buffers
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-b") 'bs-show)
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;; ESS Mode (.R file)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define-key ess-mode-map "\C-l" 'ess-eval-line-and-step)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define-key ess-mode-map "\C-p" 'ess-eval-function-or-paragraph-and-step)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define-key ess-mode-map "\C-r" 'ess-eval-region)
</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">use ess-transcript-clean-buffer to
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">1. clean *R* buffer, remove all outputs
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">2. save commands history
</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">edit roxy template
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">ess-roxy-update-entry
</span><span style="color: #e8e8bf;">(</span>setq ess-roxy-template-alist '<span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"description"</span> . <span style="color: #CC9393;">".. content for \\description{} (no empty lines) .."</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"details"</span> . <span style="color: #CC9393;">".. content for \\details{} .."</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"title"</span> . <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"param"</span> . <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"return"</span> . <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"export"</span> . <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span>
                                <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"author"</span> . <span style="color: #CC9393;">"Yi Tang"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Org mode</h3>
<div class="outline-text-3" id="text-1-6">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-habit</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-agenda-files '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"~/git/org/"</span> <span style="color: #CC9393;">"~/git/jbarm"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Standard key bindings
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #CC9393;">"\C-c l"</span> 'org-store-link<span style="color: #e8e8bf;">)</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-c C-l is defualt, 
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #CC9393;">"\C-c a"</span> 'org-agenda<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #CC9393;">"\C-c b"</span> 'org-iswitchb<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">switch between org files. &lt; helm recentf
</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Custom Key Bindings
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f12&gt;"</span><span style="color: #b2f7b2;">)</span> 'org-agenda<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f5&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/org-todo<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;S-f5&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/widen<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f7&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/set-truncate-lines<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f8&gt;"</span><span style="color: #b2f7b2;">)</span> 'org-cycle-agenda-files<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; &lt;f9&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/show-org-agenda<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; b"</span><span style="color: #b2f7b2;">)</span> 'bbdb<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; c"</span><span style="color: #b2f7b2;">)</span> 'calendar<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "&lt;f9&gt; f") 'boxquote-insert-file)
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; g"</span><span style="color: #b2f7b2;">)</span> 'gnus<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; h"</span><span style="color: #b2f7b2;">)</span> 'bh/hide-other<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; n"</span><span style="color: #b2f7b2;">)</span> 'bh/toggle-next-task-display<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; I"</span><span style="color: #b2f7b2;">)</span> 'bh/punch-in<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; O"</span><span style="color: #b2f7b2;">)</span> 'bh/punch-out<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; o"</span><span style="color: #b2f7b2;">)</span> 'bh/make-org-scratch<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; r"</span><span style="color: #b2f7b2;">)</span> 'boxquote-region<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; s"</span><span style="color: #b2f7b2;">)</span> 'bh/switch-to-scratch<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; t"</span><span style="color: #b2f7b2;">)</span> 'bh/insert-inactive-timestamp<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; T"</span><span style="color: #b2f7b2;">)</span> 'bh/toggle-insert-inactive-timestamp<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; v"</span><span style="color: #b2f7b2;">)</span> 'visible-mode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; l"</span><span style="color: #b2f7b2;">)</span> 'org-toggle-link-display<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; SPC"</span><span style="color: #b2f7b2;">)</span> 'bh/clock-in-last-task<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-&lt;f9&gt;"</span><span style="color: #b2f7b2;">)</span> 'previous-buffer<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"M-&lt;f9&gt;"</span><span style="color: #b2f7b2;">)</span> 'org-toggle-inline-images<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-x n r"</span><span style="color: #b2f7b2;">)</span> 'narrow-to-region<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-&lt;f10&gt;"</span><span style="color: #b2f7b2;">)</span> 'next-buffer<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f11&gt;"</span><span style="color: #b2f7b2;">)</span> 'org-clock-goto<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-&lt;f11&gt;"</span><span style="color: #b2f7b2;">)</span> 'org-clock-in<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-s-&lt;f12&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/save-then-publish<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c c"</span><span style="color: #b2f7b2;">)</span> 'org-capture<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/hide-other</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>org-back-to-heading 'invisible-ok<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>hide-other<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-cycle<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-cycle<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-cycle<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/set-truncate-lines</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Toggle value of truncate-lines and refresh window display."</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq truncate-lines <span style="color: #e7ca77;">(</span>not truncate-lines<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">now refresh window display (an idiom from simple.el):
</span>  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>set-window-start <span style="color: #7ef2f7;">(</span>selected-window<span style="color: #7ef2f7;">)</span>
                      <span style="color: #7ef2f7;">(</span>window-start <span style="color: #87dc87;">(</span>selected-window<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/make-org-scratch</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"/tmp/publish/scratch.org"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>gnus-make-directory <span style="color: #CC9393;">"/tmp/publish"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/switch-to-scratch</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>switch-to-buffer <span style="color: #CC9393;">"*scratch*"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-todo-keywords
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>sequence <span style="color: #CC9393;">"TODO(t)"</span> <span style="color: #CC9393;">"NEXT(n)"</span> <span style="color: #CC9393;">"|"</span> <span style="color: #CC9393;">"DONE(d)"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span>sequence <span style="color: #CC9393;">"WAITING(w@/!)"</span> <span style="color: #CC9393;">"HOLD(h@/!)"</span> <span style="color: #CC9393;">"|"</span> <span style="color: #CC9393;">"CANCELLED(c@/!)"</span> <span style="color: #CC9393;">"PHONE"</span> <span style="color: #CC9393;">"MEETING"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-todo-keyword-faces
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"TODO"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"red"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"NEXT"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"blue"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"DONE"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"forest green"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"WAITING"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"orange"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"HOLD"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"magenta"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"CANCELLED"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"forest green"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"MEETING"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"forest green"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"PHONE"</span> <span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"forest green"</span> <span style="color: #DCDCCC; font-weight: bold;">:weight</span> bold<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-use-fast-todo-selection t<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: turn off!, need it. 
</span>
<span style="color: #e8e8bf;">(</span>setq org-treat-S-cursor-todo-selection-as-state-change nil<span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">BUG</span><span style="color: #7F9F7F;">: need to remove S-&lt;left&gt; and &lt;right&gt; from org key map completely, as it used for moving to window.
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">keep todo, done, next (project ongoing), waiting (program running), hold (no process machine), cancel (someone else will do) keyworld .
</span><span style="color: #e8e8bf;">(</span>setq org-todo-state-tags-triggers
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"CANCELLED"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"CANCELLED"</span> . t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"WAITING"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span> . t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"HOLD"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"HOLD"</span> . t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span>done <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"HOLD"</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"TODO"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"CANCELLED"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"HOLD"</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"NEXT"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"CANCELLED"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"HOLD"</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"DONE"</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"WAITING"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"CANCELLED"</span><span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span><span style="color: #CC9393;">"HOLD"</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-directory <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"~/git/jbarm"</span>
                            <span style="color: #CC9393;">"~/git/org"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">FIXME</span><span style="color: #7F9F7F;">: add ~/git/jbarm folder 
</span>
<span style="color: #e8e8bf;">(</span>setq org-default-notes-file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">I use C-c c to start capture mode
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c c"</span><span style="color: #b2f7b2;">)</span> 'org-capture<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">mine modication 
</span><span style="color: #e8e8bf;">(</span>setq org-capture-templates
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"t"</span> <span style="color: #CC9393;">"todo"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* TODO %?\n%U\n"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: %? %U %a, what does these means??? %: %c 
</span>              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"r"</span> <span style="color: #CC9393;">"respond"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">"* NEXT Respond to %^{whom} on %^{subject} \n %? \nSCHEDULED: %t\n%U\n" :clock-in t :clock-resume t :immediate-finish t)
</span>               <span style="color: #CC9393;">"* To %? about :RESPONSE:  \nSCHEDULED: %t\n%U\n"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"n"</span> <span style="color: #CC9393;">"note"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* %? :NOTE:\n%U\n"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"j"</span> <span style="color: #CC9393;">"Journal"</span> entry <span style="color: #87dc87;">(</span>file+datetree <span style="color: #CC9393;">"~/git/org/diary.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* %?\n%U\n"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"m"</span> <span style="color: #CC9393;">"Meeting"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* MEETING with %? :MEETING:\n%U"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"p"</span> <span style="color: #CC9393;">"Phone call"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/refile.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* PHONE %? :PHONE:\n%U"</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"h"</span> <span style="color: #CC9393;">"Habit"</span> entry <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/org/habits.org"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"* NEXT %?\n%U\nSCHEDULED: %(format-time-string \"&lt;%Y-%m-%d .+1d/3d&gt;\")\n:PROPERTIES:\n:STYLE: habit\n:REPEAT_TO_STATE: NEXT\n:END:\n"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"l"</span> <span style="color: #CC9393;">"Ledger entries"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">("ll" "Lloyas" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"ll"</span> <span style="color: #CC9393;">"Lloyas"</span> plain <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/ImportantFiles/ledger"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"%(org-read-date) %^{Payee}\n\tExpenses:%^{Account}\t&#163; %^{Amount}\n\tAssets:Lloyds"</span> <span style="color: #DCDCCC; font-weight: bold;">:immediate-finish</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">("lc" "Cash" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"lc"</span> <span style="color: #CC9393;">"Cash"</span> plain <span style="color: #87dc87;">(</span>file <span style="color: #CC9393;">"~/git/ImportantFiles/ledger"</span><span style="color: #87dc87;">)</span>
               <span style="color: #CC9393;">"%(org-read-date) * %^{Payee}\n\tExpenses:%^{Account}\t&#163; %^{Amount}\n\tAssets:Cash"</span> <span style="color: #DCDCCC; font-weight: bold;">:immediate-finish</span> <span style="color: #DCDCCC; font-weight: bold;">:clock-in</span> t <span style="color: #DCDCCC; font-weight: bold;">:clock-resume</span> t<span style="color: #7ef2f7;">)</span>
              <span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">("f" "Food log")
</span>              <span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">("fb" "Breakfast" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">"%(org-read-date) * %^{Place|Home|Office|Cafe}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; %^{What_I_Ate}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Cook:Breakfast\t M %^{Time}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Eat:Breakfast\t M %^{Time} 
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Time:Food" :immediate-finish :clock-in t :clock-resume t)
</span>              <span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">("fl" "Lunch" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">"%(org-read-date) * %^{Place|Home|Office|Cafe}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; %^{What_I_Ate}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Cook:Lunch\tM %^{Time}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Eat:Lunch\tM %^{Time} 
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Time:Food" :immediate-finish :clock-in t :clock-resume t)
</span>              <span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">("fd" "Dinner" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">"%(org-read-date) * %^{Place|Home|Office|Cafe}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; %^{What_I_Ate}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Cook:Dinner\tM %^{Time}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Eat:Dinner\tM %^{Time} 
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Time:Food" :immediate-finish :clock-in t :clock-resume t)
</span>              <span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">("fs" "Snack" plain (file+olp "~/git/org/refile.org"  "Finance")
</span>              <span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">"%(org-read-date) * %^{Place|Home|Office|Cafe}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; %^{What_I_Ate}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Cook:Snack\tM %^{Time}
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Eat:Snack\tM %^{Time} 
</span>              <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Time:Food" :immediate-finish :clock-in t :clock-resume t)
</span>              <span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>



<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Remove empty LOGBOOK drawers on clock out
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(defun bh/remove-empty-drawer-on-clock-out ()
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(interactive)
</span><span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(save-excursion
</span><span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(beginning-of-line 0)
</span><span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(org-remove-empty-drawer-at (point))))
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">replaced above by: http://stackoverflow.com/questions/21767471/org-capture-and-time-clocking-misbehaving
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/remove-empty-drawer-on-clock-out</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>beginning-of-line 0<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-remove-empty-drawer-at <span style="color: #CC9393;">"LOGBOOK"</span> <span style="color: #7ef2f7;">(</span>point<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-clock-out-hook 'bh/remove-empty-drawer-on-clock-out 'append<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Targets include this file and any file contributing to the agenda - up to 9 levels deep
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: change this block, use helm completion 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-completion-handler to 'helm)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">actually, the following setting is mimic the helm behavoir, why not we just use helm, instead of making ido helm 
</span>
<span style="color: #e8e8bf;">(</span>setq org-refile-targets <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>nil <span style="color: #DCDCCC; font-weight: bold;">:maxlevel</span> . 9<span style="color: #7ef2f7;">)</span>
                                 <span style="color: #7ef2f7;">(</span>org-agenda-files <span style="color: #DCDCCC; font-weight: bold;">:maxlevel</span> . 9<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-completion-handler 'helm<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Use full outline paths for refile targets - we file directly with IDO
</span><span style="color: #e8e8bf;">(</span>setq org-refile-use-outline-path t<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Targets complete directly with IDO
</span><span style="color: #e8e8bf;">(</span>setq org-outline-path-complete-in-steps nil<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Allow refile to create parent tasks with confirmation
</span><span style="color: #e8e8bf;">(</span>setq org-refile-allow-creating-parent-nodes <span style="color: #b2f7b2;">(</span>quote confirm<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; Use IDO for both buffer and file completion and ido-everywhere to t
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-completion-use-ido t)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq ido-everywhere t)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq ido-max-directory-size 100000)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(ido-mode (quote both))
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; Use the current window when visiting files and buffers with ido
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq ido-default-file-method 'selected-window)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq ido-default-buffer-method 'selected-window)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; Use the current window for indirect buffer display
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-indirect-buffer-display 'current-window)
</span>
<span style="color: #5F7F5F;">;;;; </span><span style="color: #7F9F7F;">Refile settings
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Exclude DONE state tasks from refile targets
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/verify-refile-target</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Exclude todo keywords with a done state from refile targets"</span>
  <span style="color: #b2f7b2;">(</span>not <span style="color: #e7ca77;">(</span>member <span style="color: #7ef2f7;">(</span>nth 2 <span style="color: #87dc87;">(</span>org-heading-components<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span> org-done-keywords<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-refile-target-verify-function 'bh/verify-refile-target<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Do not dim blocked tasks
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-dim-blocked-tasks nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Compact the block agenda view
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-compact-blocks nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Custom agenda command definitions
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-custom-commands
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"N"</span> <span style="color: #CC9393;">"Notes"</span> tags <span style="color: #CC9393;">"NOTE"</span>
               <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Notes"</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>org-tags-match-list-sublevels t<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"h"</span> <span style="color: #CC9393;">"Habits"</span> tags-todo <span style="color: #CC9393;">"STYLE=\"habit\""</span>
               <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Habits"</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>org-agenda-sorting-strategy
                 '<span style="color: #f3d88b;">(</span>todo-state-down effort-up category-keep<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">"Agenda"</span>
               <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>agenda <span style="color: #CC9393;">""</span> nil<span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-CANCELLED+WAITING|HOLD/!"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #48bfc6;">(</span>concat <span style="color: #CC9393;">"Waiting and Postponed Tasks"</span>
                                                                  <span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span style="color: #CC9393;">""</span>
                                                                    <span style="color: #CC9393;">" (including WAITING and SCHEDULED tasks)"</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-non-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels nil<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags <span style="color: #CC9393;">"RESPONSE"</span>
                      <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Response"</span><span style="color: #72ce72;">)</span>
                       <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels nil<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-CANCELLED/!NEXT"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #48bfc6;">(</span>concat <span style="color: #CC9393;">"Project Next Tasks"</span>
                                                                  <span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span style="color: #CC9393;">""</span>
                                                                    <span style="color: #CC9393;">" (including WAITING and SCHEDULED tasks)"</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-projects-and-habits-and-single-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels t<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-sorting-strategy
                             '<span style="color: #48bfc6;">(</span>todo-state-down effort-up category-keep<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-CANCELLED/!"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Stuck Projects"</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-non-stuck-projects<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-sorting-strategy
                             '<span style="color: #48bfc6;">(</span>category-keep<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-HOLD-CANCELLED/!"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Projects"</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-non-projects<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels 'indented<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-sorting-strategy
                             '<span style="color: #48bfc6;">(</span>category-keep<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-REFILE-CANCELLED-WAITING-HOLD/!"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #48bfc6;">(</span>concat <span style="color: #CC9393;">"Project Subtasks"</span>
                                                                  <span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span style="color: #CC9393;">""</span>
                                                                    <span style="color: #CC9393;">" (including WAITING and SCHEDULED tasks)"</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-non-project-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-sorting-strategy
                             '<span style="color: #48bfc6;">(</span>category-keep<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags-todo <span style="color: #CC9393;">"-REFILE-CANCELLED-WAITING-HOLD/!"</span>
                           <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #48bfc6;">(</span>concat <span style="color: #CC9393;">"Standalone Tasks"</span>
                                                                  <span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/hide-scheduled-and-waiting-next-tasks
                                                                      <span style="color: #CC9393;">""</span>
                                                                    <span style="color: #CC9393;">" (including WAITING and SCHEDULED tasks)"</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-project-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-scheduled bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-deadlines bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-todo-ignore-with-date bh/hide-scheduled-and-waiting-next-tasks<span style="color: #72ce72;">)</span>
                            <span style="color: #72ce72;">(</span>org-agenda-sorting-strategy
                             '<span style="color: #48bfc6;">(</span>category-keep<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>

                <span style="color: #87bdff;">(</span>tags <span style="color: #CC9393;">"-REFILE/"</span>
                      <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Tasks to Archive"</span><span style="color: #72ce72;">)</span>
                       <span style="color: #72ce72;">(</span>org-agenda-skip-function 'bh/skip-non-archivable-tasks<span style="color: #72ce72;">)</span>
                       <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels nil<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                <span style="color: #87bdff;">(</span>tags <span style="color: #CC9393;">"REFILE"</span>
                      <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>org-agenda-overriding-header <span style="color: #CC9393;">"Tasks to Refile"</span><span style="color: #72ce72;">)</span>
                       <span style="color: #72ce72;">(</span>org-tags-match-list-sublevels nil<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/org-auto-exclude-function</span> <span style="color: #b2f7b2;">(</span>tag<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Automatic task exclusion in the agenda with / RET"</span>
  <span style="color: #b2f7b2;">(</span>and <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>string= tag <span style="color: #CC9393;">"hold"</span><span style="color: #87dc87;">)</span>
         t<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>string= tag <span style="color: #CC9393;">"farm"</span><span style="color: #87dc87;">)</span>
         t<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>concat <span style="color: #CC9393;">"-"</span> tag<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-agenda-auto-exclude-function 'bh/org-auto-exclude-function<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Resume clocking task when emacs is restarted
</span><span style="color: #e8e8bf;">(</span>org-clock-persistence-insinuate<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Show lot of clocking history so it's easy to pick items off the C-F11 list
</span><span style="color: #e8e8bf;">(</span>setq org-clock-history-length 23<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Resume clocking task on clock-in if the clock is open
</span><span style="color: #e8e8bf;">(</span>setq org-clock-in-resume t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Change tasks to NEXT when clocking in
</span><span style="color: #e8e8bf;">(</span>setq org-clock-in-switch-to-state 'bh/clock-in-to-next<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Separate drawers for clocking and logs
</span><span style="color: #e8e8bf;">(</span>setq org-drawers <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"PROPERTIES"</span> <span style="color: #CC9393;">"LOGBOOK"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Save clock data and state changes and notes in the LOGBOOK drawer
</span><span style="color: #e8e8bf;">(</span>setq org-clock-into-drawer t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Sometimes I change tasks I'm clocking quickly - this removes clocked tasks with 0:00 duration
</span><span style="color: #e8e8bf;">(</span>setq org-clock-out-remove-zero-time-clocks t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Clock out when moving task to a done state
</span><span style="color: #e8e8bf;">(</span>setq org-clock-out-when-done t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Save the running clock and all clock history when exiting Emacs, load it on startup
</span><span style="color: #e8e8bf;">(</span>setq org-clock-persist t<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Do not prompt to resume an active clock
</span><span style="color: #e8e8bf;">(</span>setq org-clock-persist-query-resume nil<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Enable auto clock resolution for finding open clocks
</span><span style="color: #e8e8bf;">(</span>setq org-clock-auto-clock-resolution <span style="color: #b2f7b2;">(</span>quote when-no-clock-is-running<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Include current clocking task in clock reports
</span><span style="color: #e8e8bf;">(</span>setq org-clock-report-include-clocking-task t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq bh/keep-clock-running nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-to-next</span> <span style="color: #b2f7b2;">(</span>kw<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Switch a task from TODO to NEXT when clocking in.
Skips capture tasks, projects, and subprojects.
Switch projects and subprojects from NEXT back to TODO"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #e7ca77;">(</span>not <span style="color: #7ef2f7;">(</span>and <span style="color: #87dc87;">(</span>boundp 'org-capture-mode<span style="color: #87dc87;">)</span> org-capture-mode<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>and <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>org-get-todo-state<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>list <span style="color: #CC9393;">"TODO"</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span>bh/is-task-p<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
      <span style="color: #CC9393;">"NEXT"</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>and <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>org-get-todo-state<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>list <span style="color: #CC9393;">"NEXT"</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
      <span style="color: #CC9393;">"TODO"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/find-project-task</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Move point to the parent (project) task if any"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>parent-task <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-back-to-heading 'invisible-ok<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>point<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87dc87;">(</span>org-up-heading-safe<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>nth 2 <span style="color: #72ce72;">(</span>org-heading-components<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> org-todo-keywords-1<span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>setq parent-task <span style="color: #f3d88b;">(</span>point<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>goto-char parent-task<span style="color: #7ef2f7;">)</span>
      parent-task<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/punch-in</span> <span style="color: #b2f7b2;">(</span>arg<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Start continuous clocking and set the default task to the
selected task.  If no task is selected set the Organization task
as the default task."</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"p"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq bh/keep-clock-running t<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
      <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span>      <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">We're in the agenda
</span>      <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span>      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>marker <span style="color: #87bdff;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
             <span style="color: #87dc87;">(</span>tags <span style="color: #87bdff;">(</span>org-with-point-at marker <span style="color: #f3d88b;">(</span>org-get-tags-at<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>and <span style="color: #87bdff;">(</span>eq arg 4<span style="color: #87bdff;">)</span> tags<span style="color: #87dc87;">)</span>
            <span style="color: #87dc87;">(</span>org-agenda-clock-in '<span style="color: #87bdff;">(</span>16<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>bh/clock-in-organization-task-as-default<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span>    <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">We are not in the agenda
</span>    <span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span>    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
      <span style="color: #7ef2f7;">(</span>widen<span style="color: #7ef2f7;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Find the tags on the current task
</span>      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>and <span style="color: #87bdff;">(</span>equal major-mode 'org-mode<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>not <span style="color: #f3d88b;">(</span>org-before-first-heading-p<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>eq arg 4<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>org-clock-in '<span style="color: #87bdff;">(</span>16<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>bh/clock-in-organization-task-as-default<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/punch-out</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq bh/keep-clock-running nil<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #e7ca77;">(</span>org-clock-is-active<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-clock-out<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-agenda-remove-restriction-lock<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-default-task</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>org-with-point-at org-clock-default-task
      <span style="color: #7ef2f7;">(</span>org-clock-in<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-parent-task</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Move point to the parent (project) task if any and clock in"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>parent-task<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
        <span style="color: #87dc87;">(</span>widen<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>not parent-task<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>org-up-heading-safe<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>nth 2 <span style="color: #48bfc6;">(</span>org-heading-components<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span> org-todo-keywords-1<span style="color: #f3d88b;">)</span>
            <span style="color: #f3d88b;">(</span>setq parent-task <span style="color: #72ce72;">(</span>point<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> parent-task
            <span style="color: #87bdff;">(</span>org-with-point-at parent-task
              <span style="color: #f3d88b;">(</span>org-clock-in<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> bh/keep-clock-running
            <span style="color: #f3d88b;">(</span>bh/clock-in-default-task<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/organization-task-id</span> <span style="color: #CC9393;">"eb155a82-92b2-4f25-a3c6-0304591af2f9"</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">BUG</span><span style="color: #7F9F7F;">: british english, change to a simpler id. 
</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-organization-task-as-default</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-with-point-at <span style="color: #e7ca77;">(</span>org-id-find bh/organization-task-id 'marker<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-clock-in '<span style="color: #7ef2f7;">(</span>16<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-out-maybe</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #e7ca77;">(</span>and bh/keep-clock-running
             <span style="color: #7ef2f7;">(</span>not org-clock-clocking-in<span style="color: #7ef2f7;">)</span>
             <span style="color: #7ef2f7;">(</span>marker-buffer org-clock-default-task<span style="color: #7ef2f7;">)</span>
             <span style="color: #7ef2f7;">(</span>not org-clock-resolving-clocks-due-to-idleness<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/clock-in-parent-task<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-clock-out-hook 'bh/clock-out-maybe 'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-id</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-task-by-id</span> <span style="color: #b2f7b2;">(</span>id<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Clock in a task by id"</span>
  <span style="color: #b2f7b2;">(</span>org-with-point-at <span style="color: #e7ca77;">(</span>org-id-find id 'marker<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-clock-in nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/clock-in-last-task</span> <span style="color: #b2f7b2;">(</span>arg<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Clock in the interrupted task if there is one
Skip the default task and get the next one.
A prefix arg forces clock in of the default task."</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"p"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>clock-in-to-task
         <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
          <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>eq arg 4<span style="color: #f3d88b;">)</span> org-clock-default-task<span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>and <span style="color: #72ce72;">(</span>org-clock-is-active<span style="color: #72ce72;">)</span>
                <span style="color: #72ce72;">(</span>equal org-clock-default-task <span style="color: #48bfc6;">(</span>cadr org-clock-history<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
           <span style="color: #f3d88b;">(</span>caddr org-clock-history<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>org-clock-is-active<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>cadr org-clock-history<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>equal org-clock-default-task <span style="color: #72ce72;">(</span>car org-clock-history<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>cadr org-clock-history<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>t <span style="color: #f3d88b;">(</span>car org-clock-history<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-with-point-at clock-in-to-task
      <span style="color: #7ef2f7;">(</span>org-clock-in nil<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-time-stamp-rounding-minutes <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span>1 1<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Y: default is 5
</span>
<span style="color: #e8e8bf;">(</span>setq org-agenda-clock-consistency-checks
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:max-duration</span> <span style="color: #CC9393;">"4:00"</span>
                            <span style="color: #DCDCCC; font-weight: bold;">:min-duration</span> 0
                            <span style="color: #DCDCCC; font-weight: bold;">:max-gap</span> 0
                            <span style="color: #DCDCCC; font-weight: bold;">:gap-ok-around</span> <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"4:00"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Sometimes I change tasks I'm clocking quickly - this removes clocked tasks with 0:00 duration
</span><span style="color: #e8e8bf;">(</span>setq org-clock-out-remove-zero-time-clocks t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Agenda clock report parameters
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-clockreport-parameter-plist
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #DCDCCC; font-weight: bold;">:link</span> t <span style="color: #DCDCCC; font-weight: bold;">:maxlevel</span> 5 <span style="color: #DCDCCC; font-weight: bold;">:fileskip0</span> t <span style="color: #DCDCCC; font-weight: bold;">:compact</span> t <span style="color: #DCDCCC; font-weight: bold;">:narrow</span> 80<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Set default column view headings: Task Effort Clock_Summary
</span><span style="color: #e8e8bf;">(</span>setq org-columns-default-format <span style="color: #CC9393;">"%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-columns-default-format "%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM %20Mood")
</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">global Effort estimate values
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">global STYLE property values for completion
</span><span style="color: #e8e8bf;">(</span>setq org-global-properties <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"Effort_ALL"</span> . <span style="color: #CC9393;">"0:15 0:30 0:45 1:00 2:00 3:00 4:00 5:00 6:00 0:00"</span><span style="color: #7ef2f7;">)</span>
                                    <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"STYLE_ALL"</span> . <span style="color: #CC9393;">"habit"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Agenda log mode items to display (closed and state changes by default)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-agenda-log-mode-items (quote (closed state)))
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-log-mode-items <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span>clock state<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Tags with fast selection keys
</span><span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: have @home, @office, @library, @coffe, @cinema 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: have @running, @struech, 
</span><span style="color: #e8e8bf;">(</span>setq org-tag-alist <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #DCDCCC; font-weight: bold;">:startgroup</span><span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"@library"</span> . ?L<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"@office"</span> . ?O<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"@home"</span> . ?H<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"@coffeeshop"</span> . ?C<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #DCDCCC; font-weight: bold;">:endgroup</span><span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"WAITING"</span> . ?w<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"HOLD"</span> . ?h<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"PERSONAL"</span> . ?P<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"WORK"</span> . ?W<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"FARM"</span> . ?F<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"NOTE"</span> . ?n<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"CANCELLED"</span> . ?c<span style="color: #7ef2f7;">)</span>
                            <span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Allow setting single tags without the menu
</span><span style="color: #e8e8bf;">(</span>setq org-fast-tag-selection-single-key <span style="color: #b2f7b2;">(</span>quote expert<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">For tag searches ignore tasks with scheduled and deadline dates
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-tags-todo-honor-ignore-options t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(require 'bbdb)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(require 'bbdb-com)
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; p"</span><span style="color: #b2f7b2;">)</span> 'bh/phone-call<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Phone capture template handling with BBDB lookup
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Adapted from code by Gregory J. Grubbs
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/phone-call</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Return name and company info for caller from bbdb lookup"</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #e7ca77;">(</span>name rec caller<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>setq name <span style="color: #7ef2f7;">(</span>completing-read <span style="color: #CC9393;">"Who is calling? "</span>
                                <span style="color: #87dc87;">(</span>bbdb-hashtable<span style="color: #87dc87;">)</span>
                                'bbdb-completion-predicate
                                'confirm<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #7ef2f7;">(</span>&gt; <span style="color: #87dc87;">(</span>length name<span style="color: #87dc87;">)</span> 0<span style="color: #7ef2f7;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Something was supplied - look it up in bbdb
</span>      <span style="color: #7ef2f7;">(</span>setq rec
            <span style="color: #87dc87;">(</span>or <span style="color: #87bdff;">(</span>first
                 <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>bbdb-search <span style="color: #48bfc6;">(</span>bbdb-records<span style="color: #48bfc6;">)</span> name nil nil<span style="color: #72ce72;">)</span>
                     <span style="color: #72ce72;">(</span>bbdb-search <span style="color: #48bfc6;">(</span>bbdb-records<span style="color: #48bfc6;">)</span> nil name nil<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                name<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Build the bbdb link if we have a bbdb record, otherwise just return the name
</span>    <span style="color: #e7ca77;">(</span>setq caller <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and rec <span style="color: #f3d88b;">(</span>vectorp rec<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                        <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>name <span style="color: #48bfc6;">(</span>bbdb-record-name rec<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                              <span style="color: #72ce72;">(</span>company <span style="color: #48bfc6;">(</span>bbdb-record-company rec<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                          <span style="color: #f3d88b;">(</span>concat <span style="color: #CC9393;">"[[bbdb:"</span>
                                  name <span style="color: #CC9393;">"]["</span>
                                  name <span style="color: #CC9393;">"]]"</span>
                                  <span style="color: #72ce72;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> company
                                    <span style="color: #48bfc6;">(</span>concat <span style="color: #CC9393;">" - "</span> company<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
                       <span style="color: #87dc87;">(</span>rec<span style="color: #87dc87;">)</span>
                       <span style="color: #87dc87;">(</span>t <span style="color: #CC9393;">"NameOfCaller"</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>insert caller<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-agenda-span 'day<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-stuck-projects <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">""</span> nil nil <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-project-p</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Any task with a todo keyword subtask"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>has-subtask<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>is-a-task <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>nth 2 <span style="color: #72ce72;">(</span>org-heading-components<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> org-todo-keywords-1<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
        <span style="color: #87dc87;">(</span>forward-line 1<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>not has-subtask<span style="color: #f3d88b;">)</span>
                    <span style="color: #f3d88b;">(</span>&lt; <span style="color: #72ce72;">(</span>point<span style="color: #72ce72;">)</span> subtree-end<span style="color: #f3d88b;">)</span>
                    <span style="color: #f3d88b;">(</span>re-search-forward <span style="color: #CC9393;">"^\*+ "</span> subtree-end t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>org-get-todo-state<span style="color: #72ce72;">)</span> org-todo-keywords-1<span style="color: #f3d88b;">)</span>
            <span style="color: #f3d88b;">(</span>setq has-subtask t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>and is-a-task has-subtask<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-project-subtree-p</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Any task with a todo keyword that is in a project subtree.
Callers of this function already widen the buffer view."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>task <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #87bdff;">(</span>org-back-to-heading 'invisible-ok<span style="color: #87bdff;">)</span>
                              <span style="color: #87bdff;">(</span>point<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
      <span style="color: #7ef2f7;">(</span>bh/find-project-task<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>equal <span style="color: #87bdff;">(</span>point<span style="color: #87bdff;">)</span> task<span style="color: #87dc87;">)</span>
          nil
        t<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-task-p</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Any task with a todo keyword and no subtask"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>has-subtask<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>is-a-task <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>nth 2 <span style="color: #72ce72;">(</span>org-heading-components<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> org-todo-keywords-1<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
        <span style="color: #87dc87;">(</span>forward-line 1<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>not has-subtask<span style="color: #f3d88b;">)</span>
                    <span style="color: #f3d88b;">(</span>&lt; <span style="color: #72ce72;">(</span>point<span style="color: #72ce72;">)</span> subtree-end<span style="color: #f3d88b;">)</span>
                    <span style="color: #f3d88b;">(</span>re-search-forward <span style="color: #CC9393;">"^\*+ "</span> subtree-end t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>org-get-todo-state<span style="color: #72ce72;">)</span> org-todo-keywords-1<span style="color: #f3d88b;">)</span>
            <span style="color: #f3d88b;">(</span>setq has-subtask t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>and is-a-task <span style="color: #87dc87;">(</span>not has-subtask<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-subproject-p</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Any task which is a subtask of another project"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>is-subproject<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>is-a-task <span style="color: #87dc87;">(</span>member <span style="color: #87bdff;">(</span>nth 2 <span style="color: #f3d88b;">(</span>org-heading-components<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span> org-todo-keywords-1<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87dc87;">(</span>and <span style="color: #87bdff;">(</span>not is-subproject<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>org-up-heading-safe<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>nth 2 <span style="color: #72ce72;">(</span>org-heading-components<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> org-todo-keywords-1<span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>setq is-subproject t<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>and is-a-task is-subproject<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/list-sublevels-for-projects-indented</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Set org-tags-match-list-sublevels so when restricted to a subtree we list all subtasks.
  This is normally used by skipping functions where this variable is already local to the agenda."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>marker-buffer org-agenda-restrict-begin<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>setq org-tags-match-list-sublevels 'indented<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>setq org-tags-match-list-sublevels nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/list-sublevels-for-projects</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Set org-tags-match-list-sublevels so when restricted to a subtree we list all subtasks.
  This is normally used by skipping functions where this variable is already local to the agenda."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>marker-buffer org-agenda-restrict-begin<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>setq org-tags-match-list-sublevels t<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>setq org-tags-match-list-sublevels nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/hide-scheduled-and-waiting-next-tasks</span> t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/toggle-next-task-display</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq bh/hide-scheduled-and-waiting-next-tasks <span style="color: #e7ca77;">(</span>not bh/hide-scheduled-and-waiting-next-tasks<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span>  <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-agenda-redo<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>message <span style="color: #CC9393;">"%s WAITING and SCHEDULED NEXT Tasks"</span> <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/hide-scheduled-and-waiting-next-tasks <span style="color: #CC9393;">"Hide"</span> <span style="color: #CC9393;">"Show"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-stuck-projects</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are not stuck projects"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>bh/is-project-p<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>subtree-end <span style="color: #72ce72;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #48bfc6;">(</span>org-end-of-subtree t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                 <span style="color: #f3d88b;">(</span>has-next <span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
            <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
              <span style="color: #f3d88b;">(</span>forward-line 1<span style="color: #f3d88b;">)</span>
              <span style="color: #f3d88b;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #72ce72;">(</span>and <span style="color: #48bfc6;">(</span>not has-next<span style="color: #48bfc6;">)</span> <span style="color: #48bfc6;">(</span>&lt; <span style="color: #e8e8bf;">(</span>point<span style="color: #e8e8bf;">)</span> subtree-end<span style="color: #48bfc6;">)</span> <span style="color: #48bfc6;">(</span>re-search-forward <span style="color: #CC9393;">"^\\*+ NEXT "</span> subtree-end t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                <span style="color: #72ce72;">(</span><span style="color: #F0DFAF; font-weight: bold;">unless</span> <span style="color: #48bfc6;">(</span>member <span style="color: #CC9393;">"WAITING"</span> <span style="color: #e8e8bf;">(</span>org-get-tags-at<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span>
                  <span style="color: #48bfc6;">(</span>setq has-next t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
            <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> has-next
                nil
              next-headline<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">a stuck project, has subtasks but no next task
</span>        nil<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-non-stuck-projects</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are not stuck projects"</span>
  <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(bh/list-sublevels-for-projects-indented)
</span>  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>bh/is-project-p<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>subtree-end <span style="color: #72ce72;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #48bfc6;">(</span>org-end-of-subtree t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                 <span style="color: #f3d88b;">(</span>has-next <span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
            <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
              <span style="color: #f3d88b;">(</span>forward-line 1<span style="color: #f3d88b;">)</span>
              <span style="color: #f3d88b;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #72ce72;">(</span>and <span style="color: #48bfc6;">(</span>not has-next<span style="color: #48bfc6;">)</span> <span style="color: #48bfc6;">(</span>&lt; <span style="color: #e8e8bf;">(</span>point<span style="color: #e8e8bf;">)</span> subtree-end<span style="color: #48bfc6;">)</span> <span style="color: #48bfc6;">(</span>re-search-forward <span style="color: #CC9393;">"^\\*+ NEXT "</span> subtree-end t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                <span style="color: #72ce72;">(</span><span style="color: #F0DFAF; font-weight: bold;">unless</span> <span style="color: #48bfc6;">(</span>member <span style="color: #CC9393;">"WAITING"</span> <span style="color: #e8e8bf;">(</span>org-get-tags-at<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span>
                  <span style="color: #48bfc6;">(</span>setq has-next t<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
            <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> has-next
                next-headline
              nil<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">a stuck project, has subtasks but no next task
</span>        next-headline<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-non-projects</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are not projects"</span>
  <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(bh/list-sublevels-for-projects-indented)
</span>  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #7ef2f7;">(</span>bh/skip-non-stuck-projects<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
        <span style="color: #7ef2f7;">(</span>widen<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>subtree-end <span style="color: #f3d88b;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #72ce72;">(</span>org-end-of-subtree t<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
           <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>bh/is-project-p<span style="color: #f3d88b;">)</span>
            nil<span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>and <span style="color: #72ce72;">(</span>bh/is-project-subtree-p<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>not <span style="color: #48bfc6;">(</span>bh/is-task-p<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
            nil<span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span>t
            subtree-end<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #7ef2f7;">(</span>org-end-of-subtree t<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-project-trees-and-habits</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are projects"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-projects-and-habits-and-single-tasks</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are projects, tasks that are habits, single non-project tasks"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and bh/hide-scheduled-and-waiting-next-tasks
             <span style="color: #f3d88b;">(</span>member <span style="color: #CC9393;">"WAITING"</span> <span style="color: #72ce72;">(</span>org-get-tags-at<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>bh/is-task-p<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>not <span style="color: #72ce72;">(</span>bh/is-project-subtree-p<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-project-tasks-maybe</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Show tasks related to the current restriction.
When restricted to a project, skip project and sub project tasks, habits, NEXT tasks, and loose tasks.
When not restricted, skip project and sub-project tasks, habits, and project related tasks."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>limit-to-project <span style="color: #87bdff;">(</span>marker-buffer org-agenda-restrict-begin<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>not limit-to-project<span style="color: #f3d88b;">)</span>
             <span style="color: #f3d88b;">(</span>bh/is-project-subtree-p<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and limit-to-project
             <span style="color: #f3d88b;">(</span>bh/is-project-subtree-p<span style="color: #f3d88b;">)</span>
             <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>org-get-todo-state<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>list <span style="color: #CC9393;">"NEXT"</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-project-tasks</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Show non-project tasks.
Skip project and sub-project tasks, habits, and project related tasks."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-subtree-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-non-project-tasks</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Show project tasks.
Skip project and sub-project tasks, habits, and loose non-project tasks."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        next-headline<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>bh/is-project-subtree-p<span style="color: #f3d88b;">)</span>
             <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>org-get-todo-state<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>list <span style="color: #CC9393;">"NEXT"</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>not <span style="color: #f3d88b;">(</span>bh/is-project-subtree-p<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-projects-and-habits</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are projects and tasks that are habits"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>bh/is-project-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>org-is-habit-p<span style="color: #87bdff;">)</span>
        subtree-end<span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>t
        nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-non-subprojects</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are not projects"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>next-headline <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #87bdff;">(</span>outline-next-heading<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #7ef2f7;">(</span>bh/is-subproject-p<span style="color: #7ef2f7;">)</span>
        nil
      next-headline<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-archive-mark-done nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-archive-location <span style="color: #CC9393;">"%s_archive::* Archived Tasks"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/skip-non-archivable-tasks</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Skip trees that are not available for archiving"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Consider only tasks with done todo headings as archivable candidates
</span>    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>next-headline <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>outline-next-heading<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>subtree-end <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span> <span style="color: #f3d88b;">(</span>org-end-of-subtree t<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>member <span style="color: #87bdff;">(</span>org-get-todo-state<span style="color: #87bdff;">)</span> org-todo-keywords-1<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87bdff;">(</span>member <span style="color: #f3d88b;">(</span>org-get-todo-state<span style="color: #f3d88b;">)</span> org-done-keywords<span style="color: #87bdff;">)</span>
              <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #f3d88b;">(</span><span style="color: #72ce72;">(</span>daynr <span style="color: #48bfc6;">(</span>string-to-int <span style="color: #e8e8bf;">(</span>format-time-string <span style="color: #CC9393;">"%d"</span> <span style="color: #b2f7b2;">(</span>current-time<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                     <span style="color: #72ce72;">(</span>a-month-ago <span style="color: #48bfc6;">(</span>* 60 60 24 7 <span style="color: #e8e8bf;">(</span>+ daynr 1<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                     <span style="color: #72ce72;">(</span>last-month <span style="color: #48bfc6;">(</span>format-time-string <span style="color: #CC9393;">"%Y-%m-"</span> <span style="color: #e8e8bf;">(</span>time-subtract <span style="color: #b2f7b2;">(</span>current-time<span style="color: #b2f7b2;">)</span> <span style="color: #b2f7b2;">(</span>seconds-to-time a-month-ago<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                     <span style="color: #72ce72;">(</span>this-month <span style="color: #48bfc6;">(</span>format-time-string <span style="color: #CC9393;">"%Y-%m-"</span> <span style="color: #e8e8bf;">(</span>current-time<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                     <span style="color: #72ce72;">(</span>subtree-is-current <span style="color: #48bfc6;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
                                           <span style="color: #e8e8bf;">(</span>forward-line 1<span style="color: #e8e8bf;">)</span>
                                           <span style="color: #e8e8bf;">(</span>and <span style="color: #b2f7b2;">(</span>&lt; <span style="color: #e7ca77;">(</span>point<span style="color: #e7ca77;">)</span> subtree-end<span style="color: #b2f7b2;">)</span>
                                                <span style="color: #b2f7b2;">(</span>re-search-forward <span style="color: #e7ca77;">(</span>concat last-month <span style="color: #CC9393;">"</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">"</span> this-month<span style="color: #e7ca77;">)</span> subtree-end t<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                <span style="color: #f3d88b;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> subtree-is-current
                    subtree-end <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Has a date in this month or last month, skip it
</span>                  nil<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>  <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">available to archive
</span>            <span style="color: #87bdff;">(</span>or subtree-end <span style="color: #f3d88b;">(</span>point-max<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        next-headline<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-alphabetical-lists t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Explicitly load required exporters
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">ox-html</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">ox-latex</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">ox-ascii</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">ox-md</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-ditaa-jar-path "~/git/org-mode/contrib/scripts/ditaa.jar") ;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: remove this, don't use 
</span><span style="color: #e8e8bf;">(</span>setq org-plantuml-jar-path <span style="color: #CC9393;">"~/java/plantuml.jar"</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: change the location.. 
</span>
<span style="color: #e8e8bf;">(</span>add-hook 'org-babel-after-execute-hook 'bh/display-inline-images 'append<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Make babel results blocks lowercase
</span><span style="color: #e8e8bf;">(</span>setq org-babel-results-keyword <span style="color: #CC9393;">"results"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/display-inline-images</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">condition-case</span> nil
      <span style="color: #e7ca77;">(</span>org-display-inline-images<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #D0BF8F; font-weight: bold;">error</span> nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>org-babel-do-load-languages
 <span style="color: #b2f7b2;">(</span>quote org-babel-load-languages<span style="color: #b2f7b2;">)</span>
 <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>emacs-lisp . t<span style="color: #7ef2f7;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: simplifiy this list 
</span>         <span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">(dot . t)
</span>         <span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">(ditaa . t)
</span>         <span style="color: #7ef2f7;">(</span>R . t<span style="color: #7ef2f7;">)</span>
         <span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(python . t)
</span>         <span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(ruby . t)
</span>         <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(gnuplot . t)
</span>         <span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">(clojure . t)
</span>         <span style="color: #7ef2f7;">(</span>sh . t<span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>ledger . t<span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>org . t<span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>plantuml . t<span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>latex . t<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Do not prompt to confirm evaluation
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">This may be dangerous - make sure you understand the consequences
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">of setting this -- see the docstring for details
</span><span style="color: #e8e8bf;">(</span>setq org-confirm-babel-evaluate nil<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Use fundamental mode when editing plantuml blocks with C-c '
</span><span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">TODO</span><span style="color: #7F9F7F;">: what is fundamental mode?? 
</span><span style="color: #e8e8bf;">(</span>add-to-list 'org-src-lang-modes <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"plantuml"</span> . fundamental<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Don't enable this because it breaks access to emacs from my Android phone
</span><span style="color: #e8e8bf;">(</span>setq org-startup-with-inline-images nil<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">experimenting with docbook exports - not finished
</span><span style="color: #e8e8bf;">(</span>setq org-export-docbook-xsl-fo-proc-command <span style="color: #CC9393;">"fop %s %s"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-export-docbook-xslt-proc-command <span style="color: #CC9393;">"xsltproc --output %s /usr/share/xml/docbook/stylesheet/nwalsh/fo/docbook.xsl %s"</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Inline images in HTML instead of producting links to the image
</span><span style="color: #e8e8bf;">(</span>setq org-html-inline-images t<span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Do not use sub or superscripts - I currently don't need this functionality in my documents
</span><span style="color: #e8e8bf;">(</span>setq org-export-with-sub-superscripts nil<span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Use org.css from the norang website for export document stylesheets
</span><span style="color: #e8e8bf;">(</span>setq org-html-head-extra <span style="color: #CC9393;">"&lt;link rel=\"stylesheet\" href=\"http://uce.uniovi.es/tips/Emacs/docs/mystyle.css\" type=\"text/css\" /&gt;"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-html-head-include-default-style nil<span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Do not generate internal css formatting for HTML exports
</span><span style="color: #e8e8bf;">(</span>setq org-export-htmlize-output-type <span style="color: #b2f7b2;">(</span>quote css<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Export with LaTeX fragments
</span><span style="color: #e8e8bf;">(</span>setq org-export-with-LaTeX-fragments t<span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Increase default number of headings to export
</span><span style="color: #e8e8bf;">(</span>setq org-export-headline-levels 6<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; List of projects
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; norang       - http://www.norang.ca/
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; doc          - http://doc.norang.ca/
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; org-mode-doc - http://doc.norang.ca/org-mode.html and associated files
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">; org          - miscellaneous todo lists for publishing
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-publish-project-alist
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">;
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">; http://www.norang.ca/  (norang website)
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">; norang-org are the org-files that generate the content
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">; norang-extra are images and css files that need to be included
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">; norang is the top-level project that gets published
</span><span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">(quote (("norang-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/www.norang.ca"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/www.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-html-publish-to-html
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"norang.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("norang-extra"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/www.norang.ca/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/www.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "css\\|pdf\\|png\\|jpg\\|gif"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-publish-attachment
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("norang"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:components ("norang-org" "norang-extra"))
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">;
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; http://doc.norang.ca/  (norang website)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; doc-org are the org-files that generate the content
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; doc-extra are images and css files that need to be included
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; doc is the top-level project that gets published
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/doc.norang.ca/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function (org-html-publish-to-html org-org-publish-to-org)
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"/org.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc-extra"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/doc.norang.ca/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "css\\|pdf\\|png\\|jpg\\|gif"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-publish-attachment
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:components ("doc-org" "doc-extra"))
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc-private-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/doc.norang.ca/private"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs/private"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function (org-html-publish-to-html org-org-publish-to-org)
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"/org.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:auto-sitemap t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-filename "index.html"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-title "Norang Private Documents"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-style "tree"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc-private-extra"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/doc.norang.ca/private"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs/private"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "css\\|pdf\\|png\\|jpg\\|gif"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-publish-attachment
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("doc-private"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:components ("doc-private-org" "doc-private-extra"))
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">;
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; Miscellaneous pages for other websites
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org are the org-files that generate the content
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("org-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/org/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-html-publish-to-html
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"/org.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">;
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; http://doc.norang.ca/  (norang website)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc-org this document
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc-extra are images and css files that need to be included
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc is the top-level project that gets published
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; This uses the same target directory as the 'doc' project
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("org-mode-doc-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/org-mode-doc/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function (org-html-publish-to-html)
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:plain-source t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:htmlized-source t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"/org.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("org-mode-doc-extra"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "~/git/org-mode-doc/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/doc.norang.ca/htdocs"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "css\\|pdf\\|png\\|jpg\\|gif\\|org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-publish-attachment
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("org-mode-doc"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:components ("org-mode-doc-org" "org-mode-doc-extra"))
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">;
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; http://doc.norang.ca/  (norang website)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc-org this document
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc-extra are images and css files that need to be included
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; org-mode-doc is the top-level project that gets published
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">; This uses the same target directory as the 'doc' project
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("tmp-org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "/tmp/publish/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/www.norang.ca/htdocs/tmp"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:section-numbers nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:table-of-contents nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "org"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function (org-html-publish-to-html org-org-publish-to-org)
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:html-head "&lt;link rel=\"stylesheet\" href=\"http://doc.norang.ca/org.css\" type=\"text/css\" /&gt;"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:plain-source t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:htmlized-source t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:style-include-default nil
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:auto-sitemap t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-filename "index.html"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-title "Test Publishing Area"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:sitemap-style "tree"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author-info t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:creator-info t)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("tmp-extra"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-directory "/tmp/publish/"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-directory "/ssh:www-data@www:~/www.norang.ca/htdocs/tmp"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:base-extension "css\\|pdf\\|png\\|jpg\\|gif"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:publishing-function org-publish-attachment
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:recursive t
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:author nil)
</span><span style="color: #5F7F5F;">;;               </span><span style="color: #7F9F7F;">("tmp"
</span><span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">:components ("tmp-org" "tmp-extra")))))
</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">I'm lazy and don't want to remember the name of the project to publish when I modify
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">a file that is part of a project.  So this function saves the file, and publishes
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">the project that includes this file
</span>                                        <span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">
</span>                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">It's bound to C-S-F12 so I just edit and hit C-S-F12 when I'm done and move on to the next thing
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/save-then-publish</span> <span style="color: #b2f7b2;">(</span><span style="color: #7CB8BB;">&amp;optional</span> force<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"P"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>save-buffer<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-save-all-org-buffers<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>org-html-head-extra<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>org-html-validation-link <span style="color: #CC9393;">"&lt;a href=\"http://validator.w3.org/check?uri=referer\"&gt;Validate XHTML 1.0&lt;/a&gt;"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-publish-current-project force<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-s-&lt;f12&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/save-then-publish<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-latex-listings t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-html-xml-declaration <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"html"</span> . <span style="color: #CC9393;">""</span><span style="color: #7ef2f7;">)</span>
                                       <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"was-html"</span> . <span style="color: #CC9393;">"&lt;?xml version=\"1.0\" encoding=\"%s\"?&gt;"</span><span style="color: #7ef2f7;">)</span>
                                       <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"php"</span> . <span style="color: #CC9393;">"&lt;?php echo \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"%s\\\" ?&gt;\"; ?&gt;"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-export-allow-BIND t<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Erase all reminders and rebuilt reminders for today from the agenda
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/org-agenda-to-appt</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq appt-time-msg-list nil<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq appt-display-format 'window<span style="color: #b2f7b2;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">YT</span><span style="color: #7F9F7F;">: show notification in separate window
</span>  <span style="color: #b2f7b2;">(</span>org-agenda-to-appt<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Rebuild the reminders everytime the agenda is displayed
</span><span style="color: #e8e8bf;">(</span>add-hook 'org-finalize-agenda-hook 'bh/org-agenda-to-appt 'append<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">This is at the end of my .emacs - so appointments are set up when Emacs starts
</span><span style="color: #e8e8bf;">(</span>bh/org-agenda-to-appt<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Activate appointments so we get notifications
</span><span style="color: #e8e8bf;">(</span>appt-activate t<span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">If we leave Emacs running overnight - reset the appointments one minute after midnight
</span><span style="color: #e8e8bf;">(</span>run-at-time <span style="color: #CC9393;">"24:01"</span> nil 'bh/org-agenda-to-appt<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Enable abbrev-mode
</span><span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>abbrev-mode 1<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Skeletons
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">sblk - Generic block #+begin_FOO .. #+end_FOO
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block</span>
  <span style="color: #9FC59F;">"Insert an org block, querying for type."</span>
  <span style="color: #CC9393;">"Type: "</span>
  <span style="color: #CC9393;">"#+begin_"</span> str <span style="color: #CC9393;">"\n"</span>
  _ - \n
  <span style="color: #CC9393;">"#+end_"</span> str <span style="color: #CC9393;">"\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sblk"</span> <span style="color: #CC9393;">""</span> 'skel-org-block<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">splantuml - PlantUML Source block
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-plantuml</span>
  <span style="color: #9FC59F;">"Insert a org plantuml block, querying for filename."</span>
  <span style="color: #CC9393;">"File (no extension): "</span>
  <span style="color: #CC9393;">"#+begin_src plantuml :file "</span> str <span style="color: #CC9393;">".png :cache yes\n"</span>
  _ - \n
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"splantuml"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-plantuml<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-plantuml-activity</span>
  <span style="color: #9FC59F;">"Insert a org plantuml block, querying for filename."</span>
  <span style="color: #CC9393;">"File (no extension): "</span>
  <span style="color: #CC9393;">"#+begin_src plantuml :file "</span> str <span style="color: #CC9393;">"-act.png :cache yes :tangle "</span> str <span style="color: #CC9393;">"-act.txt\n"</span>
  <span style="color: #b2f7b2;">(</span>bh/plantuml-reset-counters<span style="color: #b2f7b2;">)</span>
  <span style="color: #CC9393;">"@startuml\n"</span>
  <span style="color: #CC9393;">"skinparam activity {\n"</span>
  <span style="color: #CC9393;">"BackgroundColor&lt;&lt;New&gt;&gt; Cyan\n"</span>
  <span style="color: #CC9393;">"}\n\n"</span>
  <span style="color: #CC9393;">"title "</span> str <span style="color: #CC9393;">" - \n"</span>
  <span style="color: #CC9393;">"note left: "</span> str <span style="color: #CC9393;">"\n"</span>
  <span style="color: #CC9393;">"(*) --&gt; \""</span> str <span style="color: #CC9393;">"\"\n"</span>
  <span style="color: #CC9393;">"--&gt; (*)\n"</span>
  _ - \n
  <span style="color: #CC9393;">"@enduml\n"</span>
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/plantuml-if-count</span> 0<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/plantuml-if</span> <span style="color: #b2f7b2;">()</span> 
  <span style="color: #b2f7b2;">(</span>incf bh/plantuml-if-count<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>number-to-string bh/plantuml-if-count<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/plantuml-loop-count</span> 0<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/plantuml-loop</span> <span style="color: #b2f7b2;">()</span> 
  <span style="color: #b2f7b2;">(</span>incf bh/plantuml-loop-count<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>number-to-string bh/plantuml-loop-count<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/plantuml-reset-counters</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>setq bh/plantuml-if-count 0
        bh/plantuml-loop-count 0<span style="color: #b2f7b2;">)</span>
  <span style="color: #CC9393;">""</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sact"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-plantuml-activity<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-plantuml-activity-if</span>
  <span style="color: #9FC59F;">"Insert a org plantuml block activity if statement"</span>
  <span style="color: #CC9393;">""</span> 
  <span style="color: #CC9393;">"if \"\" then\n"</span>
  <span style="color: #CC9393;">"  -&gt; [condition] ==IF"</span> <span style="color: #b2f7b2;">(</span>setq ifn <span style="color: #e7ca77;">(</span>bh/plantuml-if<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span> <span style="color: #CC9393;">"==\n"</span>
  <span style="color: #CC9393;">"  --&gt; ==IF"</span> ifn <span style="color: #CC9393;">"M1==\n"</span>
  <span style="color: #CC9393;">"  -left-&gt; ==IF"</span> ifn <span style="color: #CC9393;">"M2==\n"</span>
  <span style="color: #CC9393;">"else\n"</span>
  <span style="color: #CC9393;">"end if\n"</span>
  <span style="color: #CC9393;">"--&gt; ==IF"</span> ifn <span style="color: #CC9393;">"M2=="</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sif"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-plantuml-activity-if<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-plantuml-activity-for</span>
  <span style="color: #9FC59F;">"Insert a org plantuml block activity for statement"</span>
  <span style="color: #CC9393;">"Loop for each: "</span> 
  <span style="color: #CC9393;">"--&gt; ==LOOP"</span> <span style="color: #b2f7b2;">(</span>setq loopn <span style="color: #e7ca77;">(</span>bh/plantuml-loop<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span> <span style="color: #CC9393;">"==\n"</span>
  <span style="color: #CC9393;">"note left: Loop"</span> loopn <span style="color: #CC9393;">": For each "</span> str <span style="color: #CC9393;">"\n"</span>
  <span style="color: #CC9393;">"--&gt; ==ENDLOOP"</span> loopn <span style="color: #CC9393;">"==\n"</span>
  <span style="color: #CC9393;">"note left: Loop"</span> loopn <span style="color: #CC9393;">": End for each "</span> str <span style="color: #CC9393;">"\n"</span> <span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sfor"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-plantuml-activity-for<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-plantuml-sequence</span>
  <span style="color: #9FC59F;">"Insert a org plantuml activity diagram block, querying for filename."</span>
  <span style="color: #CC9393;">"File appends (no extension): "</span>
  <span style="color: #CC9393;">"#+begin_src plantuml :file "</span> str <span style="color: #CC9393;">"-seq.png :cache yes :tangle "</span> str <span style="color: #CC9393;">"-seq.txt\n"</span>
  <span style="color: #CC9393;">"@startuml\n"</span>
  <span style="color: #CC9393;">"title "</span> str <span style="color: #CC9393;">" - \n"</span>
  <span style="color: #CC9393;">"actor CSR as \"Customer Service Representative\"\n"</span>
  <span style="color: #CC9393;">"participant CSMO as \"CSM Online\"\n"</span>
  <span style="color: #CC9393;">"participant CSMU as \"CSM Unix\"\n"</span>
  <span style="color: #CC9393;">"participant NRIS\n"</span>
  <span style="color: #CC9393;">"actor Customer"</span>
  _ - \n
  <span style="color: #CC9393;">"@enduml\n"</span>
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sseq"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-plantuml-sequence<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">sdot - Graphviz DOT block
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-dot</span>
  <span style="color: #9FC59F;">"Insert a org graphviz dot block, querying for filename."</span>
  <span style="color: #CC9393;">"File (no extension): "</span>
  <span style="color: #CC9393;">"#+begin_src dot :file "</span> str <span style="color: #CC9393;">".png :cache yes :cmdline -Kdot -Tpng\n"</span>
  <span style="color: #CC9393;">"graph G {\n"</span>
  _ - \n
  <span style="color: #CC9393;">"}\n"</span>
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sdot"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-dot<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">sditaa - Ditaa source block
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-ditaa</span>
  <span style="color: #9FC59F;">"Insert a org ditaa block, querying for filename."</span>
  <span style="color: #CC9393;">"File (no extension): "</span>
  <span style="color: #CC9393;">"#+begin_src ditaa :file "</span> str <span style="color: #CC9393;">".png :cache yes\n"</span>
  _ - \n
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"sditaa"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-ditaa<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">selisp - Emacs Lisp source block
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">define-skeleton</span> <span style="color: #93E0E3;">skel-org-block-elisp</span>
  <span style="color: #9FC59F;">"Insert a org emacs-lisp block"</span>
  <span style="color: #CC9393;">""</span>
  <span style="color: #CC9393;">"#+begin_src emacs-lisp\n"</span>
  _ - \n
  <span style="color: #CC9393;">"#+end_src\n"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>define-abbrev org-mode-abbrev-table <span style="color: #CC9393;">"selisp"</span> <span style="color: #CC9393;">""</span> 'skel-org-block-elisp<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f5&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/org-todo<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/org-todo</span> <span style="color: #b2f7b2;">(</span>arg<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"p"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal arg 4<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
        <span style="color: #7ef2f7;">(</span>bh/narrow-to-org-subtree<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>org-show-todo-tree nil<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-to-org-subtree<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-show-todo-tree nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;S-f5&gt;"</span><span style="color: #b2f7b2;">)</span> 'bh/widen<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/widen</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>org-agenda-remove-restriction-lock<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> org-agenda-sticky
          <span style="color: #87dc87;">(</span>org-agenda-redo<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"W"</span> <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #87dc87;">()</span> <span style="color: #87dc87;">(</span>interactive<span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span>setq bh/hide-scheduled-and-waiting-next-tasks t<span style="color: #87dc87;">)</span> <span style="color: #87dc87;">(</span>bh/widen<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/restrict-to-file-or-follow</span> <span style="color: #b2f7b2;">(</span>arg<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Set agenda restriction to 'file or with argument invoke follow mode.
I don't use follow mode very often but I restrict to file all the time
so change the default 'F' binding in the agenda to allow both"</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"p"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal arg 4<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>org-agenda-follow-mode<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>widen<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/set-agenda-restriction-lock 4<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>org-agenda-redo<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>beginning-of-buffer<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"F"</span> 'bh/restrict-to-file-or-follow<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-to-org-subtree</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>widen<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-narrow-to-subtree<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
    <span style="color: #e7ca77;">(</span>org-agenda-set-restriction-lock<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-to-subtree</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>org-with-point-at <span style="color: #87dc87;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>bh/narrow-to-org-subtree<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> org-agenda-sticky
          <span style="color: #87dc87;">(</span>org-agenda-redo<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-to-org-subtree<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"N"</span> 'bh/narrow-to-subtree<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-up-one-org-level</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>widen<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>outline-up-heading 1 'invisible-ok<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-to-org-subtree<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/get-pom-from-agenda-restriction-or-point</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>or <span style="color: #e7ca77;">(</span>and <span style="color: #7ef2f7;">(</span>marker-position org-agenda-restrict-begin<span style="color: #7ef2f7;">)</span> org-agenda-restrict-begin<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>and <span style="color: #7ef2f7;">(</span>equal major-mode 'org-mode<span style="color: #7ef2f7;">)</span> <span style="color: #7ef2f7;">(</span>point<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
      org-clock-marker<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-up-one-level</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>org-with-point-at <span style="color: #87dc87;">(</span>bh/get-pom-from-agenda-restriction-or-point<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>bh/narrow-up-one-org-level<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>org-agenda-redo<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-up-one-org-level<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"U"</span> 'bh/narrow-up-one-level<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-to-org-project</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>widen<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>bh/find-project-task<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-to-org-subtree<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/narrow-to-project</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>equal major-mode 'org-agenda-mode<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>org-with-point-at <span style="color: #87dc87;">(</span>bh/get-pom-from-agenda-restriction-or-point<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>bh/narrow-to-org-project<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
            <span style="color: #87bdff;">(</span>bh/find-project-task<span style="color: #87bdff;">)</span>
            <span style="color: #87bdff;">(</span>org-agenda-set-restriction-lock<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>org-agenda-redo<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>beginning-of-buffer<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>bh/narrow-to-org-project<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
      <span style="color: #7ef2f7;">(</span>org-agenda-set-restriction-lock<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"P"</span> 'bh/narrow-to-project<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/project-list</span> nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/view-next-project</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span>num-project-left current-project<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">unless</span> <span style="color: #7ef2f7;">(</span>marker-position org-agenda-restrict-begin<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>goto-char <span style="color: #87dc87;">(</span>point-min<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Clear all of the existing markers on the list
</span>      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> bh/project-list
        <span style="color: #87dc87;">(</span>set-marker <span style="color: #87bdff;">(</span>pop bh/project-list<span style="color: #87bdff;">)</span> nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>re-search-forward <span style="color: #CC9393;">"Tasks to Refile"</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>forward-visible-line 1<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Build a new project marker list
</span>    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">unless</span> bh/project-list
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87dc87;">(</span>&lt; <span style="color: #87bdff;">(</span>point<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>point-max<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>&lt; <span style="color: #72ce72;">(</span>point<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>point-max<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                    <span style="color: #f3d88b;">(</span>or <span style="color: #72ce72;">(</span>not <span style="color: #48bfc6;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                        <span style="color: #72ce72;">(</span>org-with-point-at <span style="color: #48bfc6;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #48bfc6;">)</span>
                          <span style="color: #48bfc6;">(</span>or <span style="color: #e8e8bf;">(</span>not <span style="color: #b2f7b2;">(</span>bh/is-project-p<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
                              <span style="color: #e8e8bf;">(</span>bh/is-project-subtree-p<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>forward-visible-line 1<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #87bdff;">(</span>&lt; <span style="color: #f3d88b;">(</span>point<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>point-max<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>add-to-list 'bh/project-list <span style="color: #f3d88b;">(</span>copy-marker <span style="color: #72ce72;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span> 'append<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>forward-visible-line 1<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Pop off the first marker on the list and display
</span>    <span style="color: #e7ca77;">(</span>setq current-project <span style="color: #7ef2f7;">(</span>pop bh/project-list<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> current-project
      <span style="color: #7ef2f7;">(</span>org-with-point-at current-project
        <span style="color: #87dc87;">(</span>setq bh/hide-scheduled-and-waiting-next-tasks nil<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>bh/narrow-to-project<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Remove the marker
</span>      <span style="color: #7ef2f7;">(</span>setq current-project nil<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>org-agenda-redo<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>beginning-of-buffer<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>setq num-projects-left <span style="color: #87dc87;">(</span>length bh/project-list<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>&gt; num-projects-left 0<span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>message <span style="color: #CC9393;">"%s projects left to view"</span> num-projects-left<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>beginning-of-buffer<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>setq bh/hide-scheduled-and-waiting-next-tasks t<span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #D0BF8F; font-weight: bold;">error</span> <span style="color: #CC9393;">"All projects viewed."</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"V"</span> 'bh/view-next-project<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-show-entry-below <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>default<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>org-defkey org-agenda-mode-map <span style="color: #CC9393;">"\C-c\C-x&lt;"</span> 'bh/set-agenda-restriction-lock<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/set-agenda-restriction-lock</span> <span style="color: #b2f7b2;">(</span>arg<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Set restriction lock to current task subtree or file if prefix is specified"</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"p"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>pom <span style="color: #87dc87;">(</span>bh/get-pom-from-agenda-restriction-or-point<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
         <span style="color: #7ef2f7;">(</span>tags <span style="color: #87dc87;">(</span>org-with-point-at pom <span style="color: #87bdff;">(</span>org-get-tags-at<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>restriction-type <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #f3d88b;">(</span>equal arg 4<span style="color: #f3d88b;">)</span> 'file 'subtree<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
         <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>and <span style="color: #72ce72;">(</span>equal major-mode 'org-agenda-mode<span style="color: #72ce72;">)</span> pom<span style="color: #f3d88b;">)</span>
          <span style="color: #f3d88b;">(</span>org-with-point-at pom
            <span style="color: #72ce72;">(</span>org-agenda-set-restriction-lock restriction-type<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
          <span style="color: #f3d88b;">(</span>org-agenda-redo<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
         <span style="color: #87bdff;">(</span><span style="color: #f3d88b;">(</span>and <span style="color: #72ce72;">(</span>equal major-mode 'org-mode<span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>org-before-first-heading-p<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
          <span style="color: #f3d88b;">(</span>org-agenda-set-restriction-lock 'file<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
         <span style="color: #87bdff;">(</span>pom
          <span style="color: #f3d88b;">(</span>org-with-point-at pom
            <span style="color: #72ce72;">(</span>org-agenda-set-restriction-lock restriction-type<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Limit restriction lock highlighting to the headline only
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-restriction-lock-highlight-subtree nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Always hilight the current agenda line
</span><span style="color: #e8e8bf;">(</span>add-hook 'org-agenda-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>hl-line-mode 1<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Keep tasks with dates on the global todo lists
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-todo-ignore-with-date nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Keep tasks with deadlines on the global todo lists
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-todo-ignore-deadlines nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Keep tasks with scheduled dates on the global todo lists
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-todo-ignore-scheduled nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Keep tasks with timestamps on the global todo lists
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-todo-ignore-timestamp nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Remove completed deadline tasks from the agenda view
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-skip-deadline-if-done t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Remove completed scheduled tasks from the agenda view
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-skip-scheduled-if-done t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Remove completed items from search results
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-skip-timestamp-if-done t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-agenda-include-diary nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-agenda-diary-file <span style="color: #CC9393;">"~/git/org/diary.org"</span><span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span>setq org-agenda-insert-diary-extract-time t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Include agenda archive files when searching for things
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-text-search-extra-files <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span>agenda-archives<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Show all future entries for repeating tasks
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-repeating-timestamp-show-all t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Show all agenda dates - even if they are empty
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-show-all-dates t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Sorting order for tasks on the agenda
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-sorting-strategy
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>agenda habit-down time-up user-defined-up effort-up category-keep<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span>todo category-up effort-up<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span>tags category-up effort-up<span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span>search category-up<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Start the weekly agenda on Monday
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-start-on-weekday 1<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Enable display of the time grid so we can see the marker for the current time
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-time-grid <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>daily today remove-match<span style="color: #7ef2f7;">)</span>
                                   #<span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"----------------"</span> 0 16 <span style="color: #87dc87;">(</span>org-heading t<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
                                   <span style="color: #7ef2f7;">(</span>0700 0800 0900 1000 1100 1200 1200 1300 1400 1500 1600 1700<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Display tags farther right
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(setq org-agenda-tags-column -102)
</span>
<span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Agenda sorting functions
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-cmp-user-defined 'bh/agenda-sort<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/agenda-sort</span> <span style="color: #b2f7b2;">(</span>a b<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Sorting strategy for agenda items.
Late deadlines first, then scheduled, then non-late deadlines"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span>result num-a num-b<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">time specific items are already sorted first by org-agenda-sorting-strategy
</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">non-deadline and non-scheduled items next
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test 'bh/is-not-scheduled-or-deadline a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">deadlines for today next
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test 'bh/is-due-deadline a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">late deadlines next
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test-num 'bh/is-late-deadline '&gt; a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">scheduled items for today next
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test 'bh/is-scheduled-today a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">late scheduled items next
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test-num 'bh/is-scheduled-late '&gt; a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">pending deadlines last
</span>     <span style="color: #7ef2f7;">(</span><span style="color: #87dc87;">(</span>bh/agenda-sort-test-num 'bh/is-pending-deadline '&lt; a b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">finally default to unsorted
</span>     <span style="color: #7ef2f7;">(</span>t <span style="color: #87dc87;">(</span>setq result nil<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    result<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defmacro</span> <span style="color: #93E0E3;">bh/agenda-sort-test</span> <span style="color: #b2f7b2;">(</span>fn a b<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Test for agenda sort"</span>
  `<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">if both match leave them unsorted
</span>    <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>and <span style="color: #87dc87;">(</span>apply ,fn <span style="color: #87bdff;">(</span>list ,a<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>apply ,fn <span style="color: #87bdff;">(</span>list ,b<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span>setq result nil<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">if a matches put a first
</span>    <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>apply ,fn <span style="color: #87dc87;">(</span>list ,a<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span>setq result -1<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">otherwise if b matches put b first
</span>    <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>apply ,fn <span style="color: #87dc87;">(</span>list ,b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span>setq result 1<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">if none match leave them unsorted
</span>    <span style="color: #e7ca77;">(</span>t nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defmacro</span> <span style="color: #93E0E3;">bh/agenda-sort-test-num</span> <span style="color: #b2f7b2;">(</span>fn compfn a b<span style="color: #b2f7b2;">)</span>
  `<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
    <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>apply ,fn <span style="color: #87dc87;">(</span>list ,a<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span>setq num-a <span style="color: #87dc87;">(</span>string-to-number <span style="color: #87bdff;">(</span>match-string 1 ,a<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>apply ,fn <span style="color: #87bdff;">(</span>list ,b<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
         <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
           <span style="color: #87bdff;">(</span>setq num-b <span style="color: #f3d88b;">(</span>string-to-number <span style="color: #72ce72;">(</span>match-string 1 ,b<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
           <span style="color: #87bdff;">(</span>setq result <span style="color: #f3d88b;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #72ce72;">(</span>apply ,compfn <span style="color: #48bfc6;">(</span>list num-a num-b<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span>
                            -1
                          1<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
       <span style="color: #87dc87;">(</span>setq result -1<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>apply ,fn <span style="color: #87dc87;">(</span>list ,b<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
     <span style="color: #7ef2f7;">(</span>setq result 1<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>t nil<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-not-scheduled-or-deadline</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>and <span style="color: #e7ca77;">(</span>not <span style="color: #7ef2f7;">(</span>bh/is-deadline date-str<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>not <span style="color: #7ef2f7;">(</span>bh/is-scheduled date-str<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-due-deadline</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>string-match <span style="color: #CC9393;">"Deadline:"</span> date-str<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-late-deadline</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>string-match <span style="color: #CC9393;">"</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">[0-9]*</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;"> d\. ago:"</span> date-str<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-pending-deadline</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>string-match <span style="color: #CC9393;">"In </span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">[</span><span style="color: #F0DFAF; font-weight: bold;">^</span><span style="color: #CC9393;">-]*</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;">d\.:"</span> date-str<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-deadline</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>or <span style="color: #e7ca77;">(</span>bh/is-due-deadline date-str<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>bh/is-late-deadline date-str<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>bh/is-pending-deadline date-str<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-scheduled</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>or <span style="color: #e7ca77;">(</span>bh/is-scheduled-today date-str<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>bh/is-scheduled-late date-str<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-scheduled-today</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>string-match <span style="color: #CC9393;">"Scheduled:"</span> date-str<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/is-scheduled-late</span> <span style="color: #b2f7b2;">(</span>date-str<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>string-match <span style="color: #CC9393;">"Sched\.</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">.*</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;">x:"</span> date-str<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Use sticky agenda's so they persist
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-sticky t<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">The following setting is different from the document so that you
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">can override the document path by setting your path in the variable
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">org-mode-user-contrib-lisp-path
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #b2f7b2;">(</span>boundp 'org-mode-user-contrib-lisp-path<span style="color: #b2f7b2;">)</span>
    <span style="color: #b2f7b2;">(</span>add-to-list 'load-path org-mode-user-contrib-lisp-path<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>add-to-list 'load-path <span style="color: #e7ca77;">(</span>expand-file-name <span style="color: #CC9393;">"~/git/org-mode/contrib/lisp"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-checklist</span><span style="color: #e8e8bf;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #D0BF8F; font-weight: bold;">BUG</span><span style="color: #7F9F7F;">: need org-contrib
</span>
<span style="color: #e8e8bf;">(</span>setq org-enforce-todo-dependencies t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-hide-leading-stars nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-startup-indented t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-cycle-separator-lines 0<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-blank-before-new-entry <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>heading<span style="color: #7ef2f7;">)</span>
                                         <span style="color: #7ef2f7;">(</span>plain-list-item . auto<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-insert-heading-respect-content nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-reverse-note-order nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-show-following-heading t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-show-hierarchy-above t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-show-siblings <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>default<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-special-ctrl-a/e t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-special-ctrl-k t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-yank-adjusted-subtrees t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-id-method <span style="color: #b2f7b2;">(</span>quote uuidgen<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-deadline-warning-days 30<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-table-export-default-format <span style="color: #CC9393;">"orgtbl-to-csv"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-link-frame-setup <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>vm . vm-visit-folder<span style="color: #7ef2f7;">)</span>
                                   <span style="color: #7ef2f7;">(</span>gnus . org-gnus-no-new-news<span style="color: #7ef2f7;">)</span>
                                   <span style="color: #7ef2f7;">(</span>file . find-file<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Use the current window for C-c ' source editing
</span><span style="color: #e8e8bf;">(</span>setq org-src-window-setup 'current-window<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-log-done <span style="color: #b2f7b2;">(</span>quote time<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-log-into-drawer t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-log-state-notes-insert-after-drawers nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-clock-sound <span style="color: #CC9393;">"/usr/local/lib/tngchime.wav"</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Enable habit tracking (and a bunch of other modules)
</span><span style="color: #e8e8bf;">(</span>setq org-modules <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span>org-bbdb
                          org-bibtex
                          org-crypt
                          org-gnus
                          org-id
                          org-info
                          org-jsinfo
                          org-habit
                          org-inlinetask
                          org-irc
                          org-mew
                          org-mhe
                          org-protocol
                          org-rmail
                          org-vm
                          org-wl
                          org-w3m<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">position the habit graph on the agenda to the right of the default
</span><span style="color: #e8e8bf;">(</span>setq org-habit-graph-column 50<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>run-at-time <span style="color: #CC9393;">"06:00"</span> 86400 '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>setq org-habit-show-habits t<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>global-auto-revert-mode t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-crypt</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Encrypt all entries before saving
</span><span style="color: #e8e8bf;">(</span>org-crypt-use-before-save-magic<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-tags-exclude-from-inheritance <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"crypt"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">GPG key to use for encryption
</span><span style="color: #e8e8bf;">(</span>setq org-crypt-key <span style="color: #CC9393;">"F0B66B40"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-crypt-disable-auto-save nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-use-speed-commands t<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-speed-commands-user <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"0"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"1"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"2"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"3"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"4"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"5"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"6"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"7"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"8"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"9"</span> . ignore<span style="color: #7ef2f7;">)</span>

                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"a"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"d"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"h"</span> . bh/hide-other<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"i"</span> progn
                                       <span style="color: #87dc87;">(</span>forward-char 1<span style="color: #87dc87;">)</span>
                                       <span style="color: #87dc87;">(</span>call-interactively 'org-insert-heading-respect-content<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"k"</span> . org-kill-note-or-show-branches<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"l"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"m"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"q"</span> . bh/show-org-agenda<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"r"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"s"</span> . org-save-all-org-buffers<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"w"</span> . org-refile<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"x"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"y"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"z"</span> . org-add-note<span style="color: #7ef2f7;">)</span>

                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"A"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"B"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"E"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"F"</span> . bh/restrict-to-file-or-follow<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"G"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"H"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"J"</span> . org-clock-goto<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"K"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"L"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"M"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"N"</span> . bh/narrow-to-org-subtree<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"P"</span> . bh/narrow-to-org-project<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"Q"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"R"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"S"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"T"</span> . bh/org-todo<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"U"</span> . bh/narrow-up-one-org-level<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"V"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"W"</span> . bh/widen<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"X"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"Y"</span> . ignore<span style="color: #7ef2f7;">)</span>
                                      <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"Z"</span> . ignore<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/show-org-agenda</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> org-agenda-sticky
      <span style="color: #e7ca77;">(</span>switch-to-buffer <span style="color: #CC9393;">"*Org Agenda( )*"</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span>switch-to-buffer <span style="color: #CC9393;">"*Org Agenda*"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>delete-other-windows<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">org-protocol</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq require-final-newline t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">bh/insert-inactive-timestamp</span> t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/toggle-insert-inactive-timestamp</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq bh/insert-inactive-timestamp <span style="color: #e7ca77;">(</span>not bh/insert-inactive-timestamp<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>message <span style="color: #CC9393;">"Heading timestamps are %s"</span> <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> bh/insert-inactive-timestamp <span style="color: #CC9393;">"ON"</span> <span style="color: #CC9393;">"OFF"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/insert-inactive-timestamp</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-insert-time-stamp nil t t nil nil nil<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/insert-heading-inactive-timestamp</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> bh/insert-inactive-timestamp
      <span style="color: #7ef2f7;">(</span>org-return<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>org-cycle<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>bh/insert-inactive-timestamp<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-insert-heading-hook 'bh/insert-heading-inactive-timestamp 'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-export-with-timestamps nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-return-follows-link t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>custom-set-faces
 <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">custom-set-faces was added by Custom.
</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">If you edit it by hand, you could mess it up, so be careful.
</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Your init file should contain only one such instance.
</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">If there is more than one, they won't work right.
</span> '<span style="color: #b2f7b2;">(</span>org-mode-line-clock <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>t <span style="color: #87dc87;">(</span><span style="color: #DCDCCC; font-weight: bold;">:foreground</span> <span style="color: #CC9393;">"red"</span> <span style="color: #DCDCCC; font-weight: bold;">:box</span> <span style="color: #87bdff;">(</span><span style="color: #DCDCCC; font-weight: bold;">:line-width</span> -1 <span style="color: #DCDCCC; font-weight: bold;">:style</span> released-button<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span> t<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/prepare-meeting-notes</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Prepare meeting notes for email
   Take selected region and convert tabs to spaces, mark TODOs with leading &gt;&gt;&gt;, and copy to kill ring for pasting"</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span>prefix<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-restriction</span>
        <span style="color: #87dc87;">(</span>narrow-to-region <span style="color: #87bdff;">(</span>region-beginning<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>region-end<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>untabify <span style="color: #87bdff;">(</span>point-min<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>point-max<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>goto-char <span style="color: #87bdff;">(</span>point-min<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>re-search-forward <span style="color: #CC9393;">"^</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;"> *-\</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;"> </span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">TODO</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">DONE</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;">: "</span> <span style="color: #f3d88b;">(</span>point-max<span style="color: #f3d88b;">)</span> t<span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>replace-match <span style="color: #f3d88b;">(</span>concat <span style="color: #72ce72;">(</span>make-string <span style="color: #48bfc6;">(</span>length <span style="color: #e8e8bf;">(</span>match-string 1<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span> ?&gt;<span style="color: #72ce72;">)</span> <span style="color: #CC9393;">" "</span> <span style="color: #72ce72;">(</span>match-string 2<span style="color: #72ce72;">)</span> <span style="color: #CC9393;">": "</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>goto-char <span style="color: #87bdff;">(</span>point-min<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
        <span style="color: #87dc87;">(</span>kill-ring-save <span style="color: #87bdff;">(</span>point-min<span style="color: #87bdff;">)</span> <span style="color: #87bdff;">(</span>point-max<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-remove-highlights-with-change t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-to-list 'Info-default-directory-list <span style="color: #CC9393;">"~/git/org-mode/doc"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-read-date-prefer-future 'time<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-list-demote-modify-bullet <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"+"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"*"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"1."</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"1)"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"A)"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"B)"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"a)"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"b)"</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"A."</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"B."</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"a."</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span>
                                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"b."</span> . <span style="color: #CC9393;">"-"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-tags-match-list-sublevels t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-agenda-persistent-filter t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-link-mailto-program <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span>compose-mail <span style="color: #CC9393;">"%a"</span> <span style="color: #CC9393;">"%s"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">smex for ido 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(add-to-list 'load-path (expand-file-name "~/.emacs.d"))
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(require 'smex)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(smex-initialize)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "M-x") 'smex)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "C-x x") 'smex)
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(global-set-key (kbd "M-X") 'smex-major-mode-commands)
</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Bookmark handling
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;C-f6&gt;"</span><span style="color: #b2f7b2;">)</span> '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>interactive<span style="color: #e7ca77;">)</span> <span style="color: #e7ca77;">(</span>bookmark-set <span style="color: #CC9393;">"SAVED"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f6&gt;"</span><span style="color: #b2f7b2;">)</span> '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>interactive<span style="color: #e7ca77;">)</span> <span style="color: #e7ca77;">(</span>bookmark-jump <span style="color: #CC9393;">"SAVED"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span>setq org-agenda-skip-additional-timestamps-same-entry t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-table-use-standard-references <span style="color: #b2f7b2;">(</span>quote from<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-file-apps <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>auto-mode . emacs<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"\\.mm\\'"</span> . system<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"\\.x?html?\\'"</span> . system<span style="color: #7ef2f7;">)</span>
                            <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"\\.pdf\\'"</span> . system<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

                                        <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">Overwrite the current window with the agenda
</span><span style="color: #e8e8bf;">(</span>setq org-agenda-window-setup 'current-window<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-clone-delete-id t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-cycle-include-plain-lists t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-src-fontify-natively t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-structure-template-alist
      <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"s"</span> <span style="color: #CC9393;">"#+begin_src ?\n\n#+end_src"</span> <span style="color: #CC9393;">"&lt;src lang=\"?\"&gt;\n\n&lt;/src&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"R"</span> <span style="color: #CC9393;">"#+begin_src R\n?\n#+end_src"</span> <span style="color: #CC9393;">"&lt;src lang=R\"?\"&gt;\n\n&lt;/src&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"e"</span> <span style="color: #CC9393;">"#+begin_example\n?\n#+end_example"</span> <span style="color: #CC9393;">"&lt;example&gt;\n?\n&lt;/example&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"q"</span> <span style="color: #CC9393;">"#+begin_quote\n?\n#+end_quote"</span> <span style="color: #CC9393;">"&lt;quote&gt;\n?\n&lt;/quote&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"v"</span> <span style="color: #CC9393;">"#+begin_verse\n?\n#+end_verse"</span> <span style="color: #CC9393;">"&lt;verse&gt;\n?\n&lt;/verse&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"c"</span> <span style="color: #CC9393;">"#+begin_center\n?\n#+end_center"</span> <span style="color: #CC9393;">"&lt;center&gt;\n?\n&lt;/center&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"l"</span> <span style="color: #CC9393;">"#+begin_latex\n?\n#+end_latex"</span> <span style="color: #CC9393;">"&lt;literal style=\"latex\"&gt;\n?\n&lt;/literal&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"L"</span> <span style="color: #CC9393;">"#+latex: "</span> <span style="color: #CC9393;">"&lt;literal style=\"latex\"&gt;?&lt;/literal&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"h"</span> <span style="color: #CC9393;">"#+begin_html\n?\n#+end_html"</span> <span style="color: #CC9393;">"&lt;literal style=\"html\"&gt;\n?\n&lt;/literal&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"H"</span> <span style="color: #CC9393;">"#+html: "</span> <span style="color: #CC9393;">"&lt;literal style=\"html\"&gt;?&lt;/literal&gt;"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"a"</span> <span style="color: #CC9393;">"#+begin_ascii\n?\n#+end_ascii"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"A"</span> <span style="color: #CC9393;">"#+ascii: "</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"i"</span> <span style="color: #CC9393;">"#+index: ?"</span> <span style="color: #CC9393;">"#+index: ?"</span><span style="color: #7ef2f7;">)</span>
              <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"I"</span> <span style="color: #CC9393;">"#+include %file ?"</span> <span style="color: #CC9393;">"&lt;include file=%file markup=\"?\"&gt;"</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/mark-next-parent-tasks-todo</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Visit each parent task and change NEXT states to TODO"</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>mystate <span style="color: #87dc87;">(</span>or <span style="color: #87bdff;">(</span>and <span style="color: #f3d88b;">(</span>fboundp 'org-state<span style="color: #f3d88b;">)</span>
                          state<span style="color: #87bdff;">)</span>
                     <span style="color: #87bdff;">(</span>nth 2 <span style="color: #f3d88b;">(</span>org-heading-components<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> mystate
      <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
        <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">while</span> <span style="color: #87bdff;">(</span>org-up-heading-safe<span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">when</span> <span style="color: #f3d88b;">(</span>member <span style="color: #72ce72;">(</span>nth 2 <span style="color: #48bfc6;">(</span>org-heading-components<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span> <span style="color: #72ce72;">(</span>list <span style="color: #CC9393;">"NEXT"</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
            <span style="color: #f3d88b;">(</span>org-todo <span style="color: #CC9393;">"TODO"</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-after-todo-state-change-hook 'bh/mark-next-parent-tasks-todo 'append<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'org-clock-in-hook 'bh/mark-next-parent-tasks-todo 'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-startup-folded t<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook 'orgstruct++-mode 'append<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook 'turn-on-auto-fill 'append<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(add-hook 'message-mode-hook 'bbdb-define-all-aliases 'append)
</span><span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook 'orgtbl-mode 'append<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook 'turn-on-flyspell 'append<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-hook 'message-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span> <span style="color: #e7ca77;">(</span>setq fill-column 72<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">flyspell mode for spell checking everywhere
</span><span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook 'turn-on-flyspell 'append<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Disable keys in org-mode
</span><span style="color: #5F7F5F;">;;    </span><span style="color: #7F9F7F;">C-c [ 
</span><span style="color: #5F7F5F;">;;    </span><span style="color: #7F9F7F;">C-c ]
</span><span style="color: #5F7F5F;">;;    </span><span style="color: #7F9F7F;">C-c ;
</span><span style="color: #5F7F5F;">;;    </span><span style="color: #7F9F7F;">C-c C-x C-q  cancelling the clock (we never want this)
</span><span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook
          '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
             <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Undefine C-c [ and C-c ] since this breaks my
</span>             <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">org-agenda files when directories are include It
</span>             <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">expands the files in the directories individually
</span>             <span style="color: #e7ca77;">(</span>org-defkey org-mode-map <span style="color: #CC9393;">"\C-c["</span> 'undefined<span style="color: #e7ca77;">)</span>
             <span style="color: #e7ca77;">(</span>org-defkey org-mode-map <span style="color: #CC9393;">"\C-c]"</span> 'undefined<span style="color: #e7ca77;">)</span>
             <span style="color: #e7ca77;">(</span>org-defkey org-mode-map <span style="color: #CC9393;">"\C-c;"</span> 'undefined<span style="color: #e7ca77;">)</span>
             <span style="color: #e7ca77;">(</span>org-defkey org-mode-map <span style="color: #CC9393;">"\C-c\C-x\C-q"</span> 'undefined<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'org-mode-hook
          <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
            <span style="color: #e7ca77;">(</span>local-set-key <span style="color: #7ef2f7;">(</span>kbd <span style="color: #CC9393;">"C-c M-o"</span><span style="color: #7ef2f7;">)</span> 'bh/mail-subtree<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
          'append<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">bh/mail-subtree</span> <span style="color: #b2f7b2;">()</span>
<span style="color: #5F7F5F;">;;  </span><span style="color: #7F9F7F;">(interactive) 
</span>  <span style="color: #b2f7b2;">(</span>org-mark-subtree<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-mime-subtree<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-src-preserve-indentation nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-edit-src-content-indentation 0<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-catch-invisible-edits 'error<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-export-coding-system 'utf-8<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>prefer-coding-system 'utf-8<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>set-charset-priority 'unicode<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq default-process-coding-system '<span style="color: #b2f7b2;">(</span>utf-8-unix . utf-8-unix<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-time-clocksum-format
      '<span style="color: #b2f7b2;">(</span><span style="color: #DCDCCC; font-weight: bold;">:hours</span> <span style="color: #CC9393;">"%d"</span> <span style="color: #DCDCCC; font-weight: bold;">:require-hours</span> t <span style="color: #DCDCCC; font-weight: bold;">:minutes</span> <span style="color: #CC9393;">":%02d"</span> <span style="color: #DCDCCC; font-weight: bold;">:require-minutes</span> t<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-id-link-to-org-use-id 'create-if-interactive-and-no-custom-id<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-emphasis-alist <span style="color: #b2f7b2;">(</span>quote <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"*"</span> bold <span style="color: #CC9393;">"&lt;b&gt;"</span> <span style="color: #CC9393;">"&lt;/b&gt;"</span><span style="color: #7ef2f7;">)</span>
                                 <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"/"</span> italic <span style="color: #CC9393;">"&lt;i&gt;"</span> <span style="color: #CC9393;">"&lt;/i&gt;"</span><span style="color: #7ef2f7;">)</span>
                                 <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"_"</span> underline <span style="color: #CC9393;">"&lt;span style=\"text-decoration:underline;\"&gt;"</span> <span style="color: #CC9393;">"&lt;/span&gt;"</span><span style="color: #7ef2f7;">)</span>
                                 <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"="</span> org-code <span style="color: #CC9393;">"&lt;code&gt;"</span> <span style="color: #CC9393;">"&lt;/code&gt;"</span> verbatim<span style="color: #7ef2f7;">)</span>
                                 <span style="color: #7ef2f7;">(</span><span style="color: #CC9393;">"~"</span> org-verbatim <span style="color: #CC9393;">"&lt;code&gt;"</span> <span style="color: #CC9393;">"&lt;/code&gt;"</span> verbatim<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-use-sub-superscripts nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-odd-levels-only nil<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>run-at-time <span style="color: #CC9393;">"00:59"</span> 3600 'org-save-all-org-buffers<span style="color: #e8e8bf;">)</span>



<span style="color: #5F7F5F;">;;;;;; </span><span style="color: #7F9F7F;">my config 
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">remove C-TAB
</span><span style="color: #e8e8bf;">(</span>define-key org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-&lt;right&gt;"</span><span style="color: #b2f7b2;">)</span> 'mc/mark-next-like-this<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>org-defkey org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-S-&lt;left&gt;"</span><span style="color: #b2f7b2;">)</span> 'mc/mark-previous-like-this<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>org-defkey org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c ["</span><span style="color: #b2f7b2;">)</span> nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>org-defkey org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c ]"</span><span style="color: #b2f7b2;">)</span> nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>org-defkey org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-TAB"</span><span style="color: #b2f7b2;">)</span> nil<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>org-defkey org-mode-map <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f8&gt;"</span><span style="color: #b2f7b2;">)</span> nil<span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">use helm iwth org
</span><span style="color: #e8e8bf;">(</span>setq org-completion-handler 'helm<span style="color: #e8e8bf;">)</span>



<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">http://stackoverflow.com/questions/6156286/emacs-lisp-call-function-with-prefix-argument-programmatically
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/org-clock-in-select</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq current-prefix-arg '<span style="color: #e7ca77;">(</span>4<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-u, 
</span>  <span style="color: #b2f7b2;">(</span>call-interactively 'org-clock-in<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"S-&lt;f11&gt;"</span><span style="color: #b2f7b2;">)</span> 'yt/org-clock-in-select<span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">add the following 
</span><span style="color: #e8e8bf;">(</span>setq org-capture-bookmark nil<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">http://sachachua.com/blog/2014/03/emacs-tweaks-export-org-checkboxes-using-utf-8-symbols/
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">sacha/org-html-checkbox</span> <span style="color: #b2f7b2;">(</span>checkbox<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Format CHECKBOX into HTML."</span>
  <span style="color: #b2f7b2;">(</span>case checkbox <span style="color: #e7ca77;">(</span>on <span style="color: #CC9393;">"&lt;span class=\"check\"&gt;&amp;#x2611;&lt;/span&gt;"</span><span style="color: #e7ca77;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">checkbox (checked)
</span>        <span style="color: #e7ca77;">(</span>off <span style="color: #CC9393;">"&lt;span class=\"checkbox\"&gt;&amp;#x2610;&lt;/span&gt;"</span><span style="color: #e7ca77;">)</span>
        <span style="color: #e7ca77;">(</span>trans <span style="color: #CC9393;">"&lt;code&gt;[-]&lt;/code&gt;"</span><span style="color: #e7ca77;">)</span>
        <span style="color: #e7ca77;">(</span>t <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defadvice</span> <span style="color: #93E0E3;">org-html-checkbox</span> <span style="color: #b2f7b2;">(</span>around sacha activate<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>setq ad-return-value <span style="color: #e7ca77;">(</span>sacha/org-html-checkbox <span style="color: #7ef2f7;">(</span>ad-get-arg 0<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">sacha/yank-more</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>insert <span style="color: #CC9393;">"[["</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>yank<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>insert <span style="color: #CC9393;">"][more]]"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f6&gt;"</span><span style="color: #b2f7b2;">)</span> 'sacha/yank-more<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-time-stamp-custom-formats '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"&lt;%A %d %B %Y&gt;"</span> . <span style="color: #CC9393;">"&lt;%A %d %B %Y %H:%M&gt;"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/open-diary</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"~/git/org/diary.org"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/open-tmp-R</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"~/git/org/tmp.R"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/open-tmp-el</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"~/git/org/tmp.el"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/open-tmp-org</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"~/git/org/tmp.org"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; f r"</span><span style="color: #b2f7b2;">)</span> 'yt/open-tmp-R<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; f e"</span><span style="color: #b2f7b2;">)</span> 'yt/open-tmp-el<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; f d"</span><span style="color: #b2f7b2;">)</span> 'yt/open-diary<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; f o"</span><span style="color: #b2f7b2;">)</span> 'yt/open-tmp-org<span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; e"</span><span style="color: #b2f7b2;">)</span> 'mu4e<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"&lt;f9&gt; g"</span><span style="color: #b2f7b2;">)</span> 'magit-status<span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq org-agenda-tags-column 120<span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/timeline-for-subtree</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"make a timeline view in agenda for current tree"</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-copy-subtree<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>find-file <span style="color: #CC9393;">"~/tmp/agenda_tmp.org"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>beginning-of-buffer<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>beg <span style="color: #87dc87;">(</span>point<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span> <span style="color: #e7ca77;">(</span>end-of-buffer<span style="color: #e7ca77;">)</span> <span style="color: #e7ca77;">(</span>delete-region beg <span style="color: #7ef2f7;">(</span>point<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-paste-subtree<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>save-buffer<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-timeline<span style="color: #b2f7b2;">)</span>
  <span style="color: #e8e8bf;">)</span>


<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">require</span> '<span style="color: #BFEBBF;">htmlize</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defadvice</span> <span style="color: #93E0E3;">htmlize-buffer-1</span> <span style="color: #b2f7b2;">(</span>around ome-htmlize-buffer-1 disable<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>rainbow-delimiters-mode -1<span style="color: #b2f7b2;">)</span>
  ad-do-it
  <span style="color: #b2f7b2;">(</span>rainbow-delimiters-mode t<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">ome-htmlize-setup</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>el-get-read-package-status 'rainbow-delimiters<span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
        <span style="color: #7ef2f7;">(</span>ad-enable-advice 'htmlize-buffer-1 'around 'ome-htmlize-buffer-1<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>ad-activate 'htmlize-buffer-1<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>




<span style="color: #e8e8bf;">(</span>eval-after-load 'htmlize
  '<span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
     <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">make htmlize to handle face name strings as well
</span>     <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">defadvice</span> <span style="color: #93E0E3;">htmlize-attrlist-to-fstruct</span> <span style="color: #7ef2f7;">(</span>around my-make-it-accept-string activate<span style="color: #7ef2f7;">)</span>
       <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #87dc87;">(</span>stringp <span style="color: #87bdff;">(</span>ad-get-arg 0<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span><span style="color: #F0DFAF; font-weight: bold;">progn</span>
             <span style="color: #87bdff;">(</span>setq ad-return-value <span style="color: #f3d88b;">(</span>htmlize-face-to-fstruct <span style="color: #72ce72;">(</span>intern <span style="color: #48bfc6;">(</span>ad-get-arg 0<span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
         ad-do-it<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">my-htmlize-off-modes</span> nil
  <span style="color: #9FC59F;">"list of minor modes to disable when using htmlize"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">my-htmlize-before-hook-default</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">dolist</span> <span style="color: #e7ca77;">(</span>mode my-htmlize-off-modes<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #7ef2f7;">(</span>fboundp mode<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>funcall mode 0<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>

  <span style="color: #b2f7b2;">(</span>font-lock-fontify-buffer<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>jit-lock-fontify-now<span style="color: #b2f7b2;">)</span>

  <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">copied from font-lock-default-function (make font-lock-face property act as alias for face property)
</span>  <span style="color: #b2f7b2;">(</span>set <span style="color: #e7ca77;">(</span>make-local-variable 'char-property-alias-alist<span style="color: #e7ca77;">)</span>
       <span style="color: #e7ca77;">(</span>copy-tree char-property-alias-alist<span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>elt <span style="color: #87dc87;">(</span>assq 'face char-property-alias-alist<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> elt
        <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">unless</span> <span style="color: #87dc87;">(</span>memq 'font-lock-face <span style="color: #87bdff;">(</span>cdr elt<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
          <span style="color: #87dc87;">(</span>setcdr elt <span style="color: #87bdff;">(</span>nconc <span style="color: #f3d88b;">(</span>cdr elt<span style="color: #f3d88b;">)</span> <span style="color: #f3d88b;">(</span>list 'font-lock-face<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>push <span style="color: #87dc87;">(</span>list 'face 'font-lock-face<span style="color: #87dc87;">)</span> char-property-alias-alist<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>add-hook 'htmlize-before-hook 'my-htmlize-before-hook-default<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(add-to-list 'my-htmlize-off-modes 'rainbow-delimiters-mode)
</span>
<span style="color: #e8e8bf;">(</span>setq org-columns-default-format <span style="color: #CC9393;">"%80ITEM(Task) %10Effort(Effort){:} %10CLOCKSUM %10Mindfullness"</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-image-actual-width '<span style="color: #b2f7b2;">(</span>400<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>


<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">add my babel libraries 
</span><span style="color: #e8e8bf;">(</span>org-babel-lob-ingest <span style="color: #CC9393;">"~/git/.emacs.d/yi.babel.org"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">http://stackoverflow.com/questions/23044588/org-mode-creation-time-range-from-effort-estimate/23067020#23067020
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">effort + schedule -&gt; schedule with duration 
</span><span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">yt/org-schedule-effort</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">save-excursion</span>
    <span style="color: #e7ca77;">(</span>org-back-to-heading t<span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #7ef2f7;">(</span>
           <span style="color: #87dc87;">(</span>element <span style="color: #87bdff;">(</span>org-element-at-point<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>effort <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:EFFORT</span> element<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>scheduled <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:scheduled</span> element<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>ts-year-start <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:year-start</span> scheduled<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>ts-month-start <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:month-start</span> scheduled<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>ts-day-start <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:day-start</span> scheduled<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>ts-hour-start <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:hour-start</span> scheduled<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
           <span style="color: #87dc87;">(</span>ts-minute-start <span style="color: #87bdff;">(</span>org-element-property <span style="color: #DCDCCC; font-weight: bold;">:minute-start</span> scheduled<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span> <span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>org-schedule nil <span style="color: #87dc87;">(</span>concat
                         <span style="color: #87bdff;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-year-start<span style="color: #87bdff;">)</span>
                         <span style="color: #CC9393;">"-"</span>
                         <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #f3d88b;">(</span>&lt; ts-month-start 10<span style="color: #f3d88b;">)</span>
                             <span style="color: #f3d88b;">(</span>concat <span style="color: #CC9393;">"0"</span> <span style="color: #72ce72;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-month-start<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                           <span style="color: #f3d88b;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-month-start<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                         <span style="color: #CC9393;">"-"</span>
                         <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #f3d88b;">(</span>&lt; ts-day-start 10<span style="color: #f3d88b;">)</span>
                             <span style="color: #f3d88b;">(</span>concat <span style="color: #CC9393;">"0"</span> <span style="color: #72ce72;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-day-start<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                           <span style="color: #f3d88b;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-day-start<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                         <span style="color: #CC9393;">" "</span>
                         <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #f3d88b;">(</span>&lt; ts-hour-start 10<span style="color: #f3d88b;">)</span>
                             <span style="color: #f3d88b;">(</span>concat <span style="color: #CC9393;">"0"</span> <span style="color: #72ce72;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-hour-start<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                           <span style="color: #f3d88b;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-hour-start<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                         <span style="color: #CC9393;">":"</span>
                         <span style="color: #87bdff;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #f3d88b;">(</span>&lt; ts-minute-start 10<span style="color: #f3d88b;">)</span>
                             <span style="color: #f3d88b;">(</span>concat <span style="color: #CC9393;">"0"</span> <span style="color: #72ce72;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-minute-start<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span>
                           <span style="color: #f3d88b;">(</span>format <span style="color: #CC9393;">"%s"</span> ts-minute-start<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                         <span style="color: #CC9393;">"+"</span>
                         effort<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span> <span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>setq bh/hide-scheduled-and-waiting-next-tasks nil<span style="color: #e8e8bf;">)</span>



                                                            <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">'djcb-org-article' for export org documents to the LaTex 'article', using
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">XeTeX and some fancy fonts; requires XeTeX (see org-latex-to-pdf-process)
</span><span style="color: #e8e8bf;">(</span>add-to-list 'org-latex-classes
                 '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"yt/org-article"</span>
                   <span style="color: #CC9393;">"\\documentclass[11pt,a4paper]{article}
\\usepackage{graphicx}    %% demo mode is a must when .img does not exists.
\\usepackage[T1]{fontenc}
\\usepackage{fontspec}
\\usepackage{hyperref}
\\usepackage{amstext}
\\usepackage{amssymb} %% checkbox
\\usepackage{minted}
\\defaultfontfeatures{Mapping=tex-text}
\\setromanfont{Gentium}
\\setromanfont [BoldFont={Gentium Basic Bold},
                ItalicFont={Gentium Basic Italic}]{Gentium Basic}
\\setsansfont{Charis SIL}
\\setmonofont[Scale=0.8]{DejaVu Sans Mono}
\\usepackage{geometry}
\\geometry{a4paper, textwidth=6.5in, textheight=10in,
            marginparsep=7pt, marginparwidth=.6in}
\\pagestyle{empty}

%% package from org-latex-default-packages-alist
\\usepackage{setspace}
\\onehalfspacing
\\usepackage{textcomp}
\\usepackage{marvosymb}
\\usepackage{wasysym}
\\usepackage{ulem}

\\renewcommand\\texttt[1]{{\\mint{cl}|#1|}} 

\\title{}
      [NO-DEFAULT-PACKAGES]
      [NO-PACKAGES]"</span>
                   <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"\\section{%s}"</span> . <span style="color: #CC9393;">"\\section*{%s}"</span><span style="color: #e7ca77;">)</span>
                   <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"\\subsection{%s}"</span> . <span style="color: #CC9393;">"\\subsection*{%s}"</span><span style="color: #e7ca77;">)</span>
                   <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"\\subsubsection{%s}"</span> . <span style="color: #CC9393;">"\\subsubsection*{%s}"</span><span style="color: #e7ca77;">)</span>
                   <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"\\paragraph{%s}"</span> . <span style="color: #CC9393;">"\\paragraph*{%s}"</span><span style="color: #e7ca77;">)</span>
                   <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"\\subparagraph{%s}"</span> . <span style="color: #CC9393;">"\\subparagraph*{%s}"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-latex-default-class <span style="color: #CC9393;">"yt/org-article"</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">code highlights using minted package 
</span><span style="color: #e8e8bf;">(</span>add-to-list 'org-latex-packages-alist '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">""</span> <span style="color: #CC9393;">"minted"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-latex-listings 'minted<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>setq org-latex-minted-options
      '<span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"frame"</span> <span style="color: #CC9393;">"lines"</span><span style="color: #e7ca77;">)</span>
        <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"fontsize"</span> <span style="color: #CC9393;">"\\scriptsize"</span><span style="color: #e7ca77;">)</span>
        <span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"linenos"</span> <span style="color: #CC9393;">""</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #5F7F5F;">;;;; </span><span style="color: #7F9F7F;">comple pdf 
</span><span style="color: #e8e8bf;">(</span>setq org-latex-pdf-process
      '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span style="color: #CC9393;">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span>
        <span style="color: #CC9393;">"xelatex -shell-escape -interaction=nonstopmode -output-directory %o %f"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">ispell region will skip the sorce code and org drawers.
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">http://emacs.stackexchange.com/questions/450/intelligent-spell-checking-in-org-mode
</span><span style="color: #e8e8bf;">(</span>add-to-list 'ispell-skip-region-alist '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">":</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">(</span><span style="color: #CC9393;">PROPERTIES</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">|</span><span style="color: #CC9393;">LOGBOOK</span><span style="color: #7F9F7F; font-weight: bold;">\\</span><span style="color: #F0DFAF; font-weight: bold;">)</span><span style="color: #CC9393;">:"</span> . <span style="color: #CC9393;">":END:"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>add-to-list 'ispell-skip-region-alist '<span style="color: #b2f7b2;">(</span><span style="color: #CC9393;">"#\\+BEGIN_SRC"</span> . <span style="color: #CC9393;">"#\\+END_SRC"</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> Org Jekyll</h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">ref: http://cute-jumper.github.io/emacs/2013/10/06/orgmode-to-github-pages-with-jekyll/
</span><span style="color: #e8e8bf;">(</span>setq org-publish-project-alist
      '<span style="color: #b2f7b2;">(</span><span style="color: #e7ca77;">(</span><span style="color: #CC9393;">"yi-tang-github-io"</span> <span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">settings for cute-jumper.github.io
</span>         <span style="color: #DCDCCC; font-weight: bold;">:base-directory</span> <span style="color: #CC9393;">"~/git/yi-tang.github.io/org"</span>
         <span style="color: #DCDCCC; font-weight: bold;">:base-extension</span> <span style="color: #CC9393;">"org"</span>
         <span style="color: #DCDCCC; font-weight: bold;">:publishing-directory</span> <span style="color: #CC9393;">"~/git/yi-tang.github.io"</span>
         <span style="color: #DCDCCC; font-weight: bold;">:recursive</span> t
         <span style="color: #DCDCCC; font-weight: bold;">:publishing-function</span> org-html-publish-to-html
         <span style="color: #DCDCCC; font-weight: bold;">:with-toc</span> nil
         <span style="color: #DCDCCC; font-weight: bold;">:headline-levels</span> 4
         <span style="color: #DCDCCC; font-weight: bold;">:section-numbers</span> nil
         <span style="color: #DCDCCC; font-weight: bold;">:auto-preamble</span> nil
         <span style="color: #DCDCCC; font-weight: bold;">:auto-sitemap</span> nil
         <span style="color: #DCDCCC; font-weight: bold;">:html-extension</span> <span style="color: #CC9393;">"html"</span>
         <span style="color: #DCDCCC; font-weight: bold;">:htmlized-source</span> t
         <span style="color: #DCDCCC; font-weight: bold;">:body-only</span> t
         <span style="color: #DCDCCC; font-weight: bold;">:with-toc</span> nil
         <span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">jekyll-directory</span> <span style="color: #b2f7b2;">(</span>expand-file-name <span style="color: #CC9393;">"~/git/yi-tang.github.io/org/"</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Path to Jekyll blog."</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">jekyll-drafts-dir</span> <span style="color: #CC9393;">"_drafts/"</span>
  <span style="color: #9FC59F;">"Relative path to drafts directory."</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">jekyll-posts-dir</span> <span style="color: #CC9393;">"_posts/"</span>
  <span style="color: #9FC59F;">"Relative path to posts directory."</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">jekyll-post-ext</span> <span style="color: #CC9393;">".org"</span>
  <span style="color: #9FC59F;">"File extension of Jekyll posts."</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defvar</span> <span style="color: #DFAF8F;">jekyll-post-template</span>
  <span style="color: #CC9393;">" #+BEGIN_HTML
---
layout: post
title: %s
excerpt: 
categories:
  -  
tags:
  -
comments: true 
---
#+END_HTML

#+call: GetLastUpdatedDate[:exports none]()[:results org]

#+TOC: headlines 4
"</span>
    <span style="color: #9FC59F;">"Default template for Jekyll posts. %s will be replace by the post title."</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">jekyll-make-slug</span> <span style="color: #b2f7b2;">(</span>s<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Turn a string into a slug."</span>
  <span style="color: #b2f7b2;">(</span>replace-regexp-in-string
   <span style="color: #CC9393;">" "</span> <span style="color: #CC9393;">"-"</span> <span style="color: #e7ca77;">(</span>downcase
            <span style="color: #7ef2f7;">(</span>replace-regexp-in-string
             <span style="color: #CC9393;">"[</span><span style="color: #F0DFAF; font-weight: bold;">^</span><span style="color: #CC9393;">A-Za-z0-9 ]"</span> <span style="color: #CC9393;">""</span> s<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">jekyll-yaml-escape</span> <span style="color: #b2f7b2;">(</span>s<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Escape a string for YAML."</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #e7ca77;">(</span>or <span style="color: #7ef2f7;">(</span>string-match <span style="color: #CC9393;">":"</span> s<span style="color: #7ef2f7;">)</span>
          <span style="color: #7ef2f7;">(</span>string-match <span style="color: #CC9393;">"\""</span> s<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
      <span style="color: #e7ca77;">(</span>concat <span style="color: #CC9393;">"\""</span> <span style="color: #7ef2f7;">(</span>replace-regexp-in-string <span style="color: #CC9393;">"\""</span> <span style="color: #CC9393;">"\\\\\""</span> s<span style="color: #7ef2f7;">)</span> <span style="color: #CC9393;">"\""</span><span style="color: #e7ca77;">)</span>
    s<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">blog-draft-post</span> <span style="color: #b2f7b2;">(</span>title<span style="color: #b2f7b2;">)</span>
  <span style="color: #9FC59F;">"Create a new Jekyll blog post."</span>
  <span style="color: #b2f7b2;">(</span>interactive <span style="color: #CC9393;">"sPost Title: "</span><span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>draft-file <span style="color: #87dc87;">(</span>concat jekyll-directory jekyll-drafts-dir
                            <span style="color: #87bdff;">(</span>jekyll-make-slug title<span style="color: #87bdff;">)</span>
                            jekyll-post-ext<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
    <span style="color: #e7ca77;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #7ef2f7;">(</span>file-exists-p draft-file<span style="color: #7ef2f7;">)</span>
        <span style="color: #7ef2f7;">(</span>find-file draft-file<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>find-file draft-file<span style="color: #7ef2f7;">)</span>
      <span style="color: #7ef2f7;">(</span>insert <span style="color: #87dc87;">(</span>format jekyll-post-template <span style="color: #87bdff;">(</span>jekyll-yaml-escape title<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">blog-publish-post</span> <span style="color: #b2f7b2;">()</span>
  <span style="color: #9FC59F;">"Move a draft post to the posts directory, and rename it so that it
 contains the date."</span>
  <span style="color: #b2f7b2;">(</span>interactive<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
   <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>not <span style="color: #87dc87;">(</span>equal
          <span style="color: #87bdff;">(</span>file-name-directory <span style="color: #f3d88b;">(</span>buffer-file-name <span style="color: #72ce72;">(</span>current-buffer<span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>concat jekyll-directory jekyll-drafts-dir<span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"This is not a draft post."</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>buffer-modified-p<span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>message <span style="color: #CC9393;">"Can't publish post; buffer has modifications."</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span>
   <span style="color: #e7ca77;">(</span>t
    <span style="color: #7ef2f7;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #87dc87;">(</span><span style="color: #87bdff;">(</span>filename
           <span style="color: #f3d88b;">(</span>concat jekyll-directory jekyll-posts-dir
                   <span style="color: #72ce72;">(</span>format-time-string <span style="color: #CC9393;">"%Y-%m-%d-"</span><span style="color: #72ce72;">)</span>
                   <span style="color: #72ce72;">(</span>file-name-nondirectory
                    <span style="color: #48bfc6;">(</span>buffer-file-name <span style="color: #e8e8bf;">(</span>current-buffer<span style="color: #e8e8bf;">)</span><span style="color: #48bfc6;">)</span><span style="color: #72ce72;">)</span><span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
          <span style="color: #87bdff;">(</span>old-point <span style="color: #f3d88b;">(</span>point<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span><span style="color: #87dc87;">)</span>
      <span style="color: #87dc87;">(</span>rename-file <span style="color: #87bdff;">(</span>buffer-file-name <span style="color: #f3d88b;">(</span>current-buffer<span style="color: #f3d88b;">)</span><span style="color: #87bdff;">)</span>
                   filename<span style="color: #87dc87;">)</span>
      <span style="color: #87dc87;">(</span>kill-buffer nil<span style="color: #87dc87;">)</span>
      <span style="color: #87dc87;">(</span>find-file filename<span style="color: #87dc87;">)</span>
      <span style="color: #87dc87;">(</span>set-window-point <span style="color: #87bdff;">(</span>selected-window<span style="color: #87bdff;">)</span> old-point<span style="color: #87dc87;">)</span><span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">org-jekyll-post-link-follow</span> <span style="color: #b2f7b2;">(</span>path<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span>org-open-file-with-emacs path<span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span><span style="color: #F0DFAF; font-weight: bold;">defun</span> <span style="color: #93E0E3;">org-jekyll-post-link-export</span> <span style="color: #b2f7b2;">(</span>path desc format<span style="color: #b2f7b2;">)</span>
  <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span>
   <span style="color: #e7ca77;">(</span><span style="color: #7ef2f7;">(</span>eq format 'html<span style="color: #7ef2f7;">)</span>
    <span style="color: #7ef2f7;">(</span>format <span style="color: #CC9393;">"&lt;a href=\"{%% post_url %s %%}\"&gt;%s&lt;/a&gt;"</span> path desc<span style="color: #7ef2f7;">)</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>

<span style="color: #e8e8bf;">(</span>org-add-link-type <span style="color: #CC9393;">"jekyll-post"</span> 'org-jekyll-post-link-follow 'org-jekyll-post-link-export<span style="color: #e8e8bf;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Improve our blogging experience with Org-Jekyll. This code sets four
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">functions with corresponding key bindings:
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-c j n - Create new draft
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-c j P - Post current draft
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-c j d - Show all drafts
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">C-c j p - Show all posts
</span><span style="color: #5F7F5F;">;;</span><span style="color: #7F9F7F;">
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">Once a draft has been posted (i.e., moved from the _drafts
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">directory to _post with the required date prefix in the filename), we
</span><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">then need to html-export it to the jekyll rootdir (with org-publish).
</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c j n"</span><span style="color: #b2f7b2;">)</span> 'blog-draft-post<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c j P"</span><span style="color: #b2f7b2;">)</span> 'blog-publish-post<span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c j p"</span><span style="color: #b2f7b2;">)</span> <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
                                  <span style="color: #e7ca77;">(</span>interactive<span style="color: #e7ca77;">)</span>
                                  <span style="color: #e7ca77;">(</span>find-file <span style="color: #CC9393;">"~/git/yi-tang.github.io/org/_posts/"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
<span style="color: #e8e8bf;">(</span>global-set-key <span style="color: #b2f7b2;">(</span>kbd <span style="color: #CC9393;">"C-c j d"</span><span style="color: #b2f7b2;">)</span> <span style="color: #b2f7b2;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #e7ca77;">()</span>
                                  <span style="color: #e7ca77;">(</span>interactive<span style="color: #e7ca77;">)</span>
                                  <span style="color: #e7ca77;">(</span>find-file <span style="color: #CC9393;">"~/git/yi-tang.github.io/org/_drafts/"</span><span style="color: #e7ca77;">)</span><span style="color: #b2f7b2;">)</span><span style="color: #e8e8bf;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> End here</h2>
<div class="outline-text-2" id="text-2">
<p>

</p>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Test</h3>
<div class="outline-text-3" id="text-2-1">
<p>

</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Yi Tang</p>
<p class="date">Created: 2015-01-19 Mon 12:20</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
